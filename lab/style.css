/* =========================================================
   Singapore Primary Science Lab — Shared Stylesheet
   Cornell Notes Layout + Theme System + Simulation Styles
   ========================================================= */

:root {
  /* Theme colours */
  --diversity:    #10b981;
  --cycles:       #3b82f6;
  --systems:      #8b5cf6;
  --interactions: #f97316;
  --energy:       #f59e0b;

  /* Base palette */
  --bg:           #0f172a;
  --surface:      #1e293b;
  --card:         #243347;
  --border:       #334155;
  --text:         #e2e8f0;
  --muted:        #94a3b8;
  --accent:       #38bdf8;

  /* Cornell Notes */
  --cue-width:    260px;
  --summary-bg:   #162032;
}

* { box-sizing: border-box; margin: 0; padding: 0; }

body {
  font-family: 'Inter', system-ui, -apple-system, sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  line-height: 1.6;
}

/* ── Typography ── */
h1, h2, h3, h4 { font-weight: 700; line-height: 1.25; }
h1 { font-size: 2rem; }
h2 { font-size: 1.5rem; }
h3 { font-size: 1.15rem; }
p  { color: var(--muted); }
.label { font-size: 0.7rem; text-transform: uppercase; letter-spacing: .08em; font-weight: 600; }

/* ── Cards ── */
.card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 1.25rem;
  transition: transform .2s, box-shadow .2s;
}
.card:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(0,0,0,.35); }

/* ── Buttons ── */
.btn {
  display: inline-flex; align-items: center; gap: .4rem;
  padding: .55rem 1.2rem;
  border-radius: 9px;
  font-weight: 600;
  font-size: .875rem;
  cursor: pointer;
  border: none;
  transition: all .18s;
}
.btn-primary   { background: var(--accent); color: #0f172a; }
.btn-primary:hover { background: #7dd3fc; }
.btn-ghost     { background: transparent; color: var(--muted); border: 1px solid var(--border); }
.btn-ghost:hover { background: var(--border); color: var(--text); }
.btn-success   { background: var(--diversity); color: #fff; }
.btn-danger    { background: #ef4444; color: #fff; }
.btn:disabled  { opacity: .45; cursor: not-allowed; }

/* ── Badge ── */
.badge {
  display: inline-flex; align-items: center;
  padding: .15rem .55rem;
  border-radius: 99px;
  font-size: .7rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: .06em;
}
.badge-diversity    { background: #0634271a; color: var(--diversity); border: 1px solid var(--diversity); }
.badge-cycles       { background: #1a2a4a; color: var(--cycles); border: 1px solid var(--cycles); }
.badge-systems      { background: #1e183a; color: var(--systems); border: 1px solid var(--systems); }
.badge-interactions { background: #3a1e0d; color: var(--interactions); border: 1px solid var(--interactions); }
.badge-energy       { background: #2e2105; color: var(--energy); border: 1px solid var(--energy); }
.badge-p3  { background: #164e3a33; color: #6ee7b7; border: 1px solid #6ee7b766; }
.badge-p4  { background: #1e3a5f33; color: #93c5fd; border: 1px solid #93c5fd66; }
.badge-p5  { background: #3a1e5f33; color: #c4b5fd; border: 1px solid #c4b5fd66; }
.badge-p6  { background: #3a200033; color: #fcd34d; border: 1px solid #fcd34d66; }

/* ── Cornell Notes Layout ── */
.cornell-wrapper {
  display: grid;
  grid-template-columns: var(--cue-width) 1fr;
  grid-template-rows: 1fr auto;
  gap: 0;
  border: 1px solid var(--border);
  border-radius: 14px;
  overflow: hidden;
  min-height: 520px;
}
.cornell-cue {
  background: var(--surface);
  border-right: 2px solid var(--border);
  padding: 1.25rem;
  overflow-y: auto;
  grid-row: 1 / 2;
}
.cornell-main {
  background: var(--card);
  padding: 1.5rem;
  overflow-y: auto;
  grid-row: 1 / 2;
}
.cornell-summary {
  background: var(--summary-bg);
  border-top: 2px solid var(--border);
  padding: 1.1rem 1.5rem;
  grid-column: 1 / -1;
  grid-row: 2 / 3;
}
.cornell-cue-label {
  font-size: .65rem;
  text-transform: uppercase;
  letter-spacing: .1em;
  color: var(--accent);
  font-weight: 700;
  margin-bottom: .75rem;
  padding-bottom: .4rem;
  border-bottom: 1px solid var(--border);
}

/* ── Glossary Terms ── */
.glossary-term {
  margin-bottom: .85rem;
  cursor: pointer;
}
.glossary-term .term-name {
  font-size: .82rem;
  font-weight: 600;
  color: var(--accent);
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.glossary-term .term-def {
  font-size: .78rem;
  color: var(--muted);
  margin-top: .25rem;
  line-height: 1.4;
  display: none;
}
.glossary-term.open .term-def { display: block; }
.glossary-term .term-name::after { content: '▸'; font-size: .7rem; transition: transform .2s; }
.glossary-term.open .term-name::after { transform: rotate(90deg); }

/* ── Tabs ── */
.tabs { display: flex; gap: .4rem; flex-wrap: wrap; margin-bottom: 1.25rem; }
.tab-btn {
  padding: .5rem 1rem;
  border-radius: 8px;
  border: 1px solid var(--border);
  background: transparent;
  color: var(--muted);
  font-size: .85rem;
  font-weight: 600;
  cursor: pointer;
  transition: all .18s;
}
.tab-btn.active {
  background: var(--accent);
  color: #0f172a;
  border-color: var(--accent);
}
.tab-pane { display: none; }
.tab-pane.active { display: block; }

/* ── Progress Bar ── */
.progress-bar-wrap {
  background: var(--border);
  border-radius: 99px;
  height: 6px;
  overflow: hidden;
}
.progress-bar-fill {
  height: 100%;
  border-radius: 99px;
  transition: width .5s ease;
}

/* ── Quiz Styles ── */
.quiz-option {
  padding: .75rem 1rem;
  border-radius: 9px;
  border: 1.5px solid var(--border);
  background: var(--surface);
  cursor: pointer;
  transition: all .15s;
  font-size: .9rem;
  text-align: left;
  width: 100%;
  color: var(--text);
}
.quiz-option:hover:not(:disabled) { border-color: var(--accent); background: #1a2a3a; }
.quiz-option.correct  { border-color: var(--diversity); background: #063b27; color: #6ee7b7; }
.quiz-option.wrong    { border-color: #ef4444; background: #3b0f0f; color: #fca5a5; }
.quiz-option:disabled { cursor: default; }
.feedback-box {
  margin-top: .75rem;
  padding: .85rem 1rem;
  border-radius: 9px;
  font-size: .88rem;
  line-height: 1.5;
  display: none;
}
.feedback-box.show { display: block; }
.feedback-correct { background: #063b27; border: 1px solid var(--diversity); color: #6ee7b7; }
.feedback-wrong   { background: #3b0f0f; border: 1px solid #ef4444; color: #fca5a5; }

/* ── Simulation Canvas ── */
.sim-canvas-wrap {
  border: 1.5px solid var(--border);
  border-radius: 10px;
  overflow: hidden;
  background: #111827;
  display: flex;
  align-items: center;
  justify-content: center;
}
canvas { display: block; }

/* ── Simulation Controls ── */
.sim-controls {
  display: flex;
  flex-wrap: wrap;
  gap: .75rem;
  margin-top: 1rem;
  align-items: center;
}
.sim-control-group {
  display: flex;
  flex-direction: column;
  gap: .25rem;
}
.sim-control-group label {
  font-size: .75rem;
  color: var(--muted);
  font-weight: 600;
}
input[type=range] {
  -webkit-appearance: none;
  width: 140px;
  height: 4px;
  background: var(--border);
  border-radius: 99px;
  outline: none;
}
input[type=range]::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 14px;
  height: 14px;
  border-radius: 50%;
  background: var(--accent);
  cursor: pointer;
}

/* ── Mind Map ── */
#mindmap-container {
  border: 1.5px solid var(--border);
  border-radius: 10px;
  background: #0d1a2e;
  height: 480px;
}

/* ── Drag and Drop ── */
.drag-item {
  padding: .5rem .85rem;
  border-radius: 8px;
  border: 1.5px solid var(--border);
  background: var(--surface);
  cursor: grab;
  font-size: .82rem;
  font-weight: 600;
  transition: all .15s;
  user-select: none;
}
.drag-item:active { cursor: grabbing; }
.drag-item.dragging { opacity: .45; }
.drop-zone {
  min-height: 56px;
  border: 2px dashed var(--border);
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: .8rem;
  color: var(--muted);
  transition: all .15s;
}
.drop-zone.drag-over { border-color: var(--accent); background: #1a2a3a; }
.drop-zone.correct   { border-color: var(--diversity); background: #063b27; }
.drop-zone.wrong     { border-color: #ef4444; background: #3b0f0f; }

/* ── Notification Toast ── */
.toast {
  position: fixed; bottom: 1.5rem; right: 1.5rem;
  background: var(--card); border: 1px solid var(--border);
  padding: .8rem 1.2rem; border-radius: 10px;
  font-size: .88rem; color: var(--text);
  box-shadow: 0 8px 24px rgba(0,0,0,.4);
  transform: translateY(120%);
  transition: transform .3s ease;
  z-index: 999;
  max-width: 320px;
}
.toast.show { transform: translateY(0); }

/* ── Science notes text styling ── */
.note-section { margin-bottom: 1.25rem; }
.note-section h4 { color: var(--accent); font-size: .9rem; margin-bottom: .5rem; }
.note-section p, .note-section li { font-size: .88rem; color: var(--muted); }
.note-section ul { padding-left: 1.2rem; }
.note-section li { margin-bottom: .3rem; }
.highlight { background: #1a3a2a; border-left: 3px solid var(--diversity); padding: .6rem .9rem; border-radius: 0 8px 8px 0; font-size: .88rem; color: #a7f3d0; margin: .75rem 0; }
.equation { background: #16213e; border: 1px solid #3b82f660; padding: .6rem 1rem; border-radius: 8px; font-family: 'Courier New', monospace; font-size: .9rem; color: #93c5fd; text-align: center; margin: .75rem 0; }

/* ── Scrollbars ── */
::-webkit-scrollbar { width: 5px; height: 5px; }
::-webkit-scrollbar-track { background: var(--surface); }
::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

/* ── AI Quiz Toggle Bar ── */
.quiz-mode-bar {
  display: flex;
  gap: .4rem;
  margin-bottom: 1rem;
  padding-bottom: .75rem;
  border-bottom: 1px solid var(--border);
}
.quiz-mode-btn {
  padding: .4rem 1rem;
  border-radius: 8px;
  border: 1.5px solid var(--border);
  background: transparent;
  color: var(--muted);
  font-size: .82rem;
  font-weight: 600;
  cursor: pointer;
  transition: all .18s;
}
.quiz-mode-btn.active {
  background: var(--accent);
  color: #0f172a;
  border-color: var(--accent);
}
.quiz-mode-btn:hover:not(.active) { border-color: var(--accent); color: var(--accent); }
.ai-setup-hint { font-weight: 400; font-size: .75rem; opacity: .75; }

/* AI label badge */
.ai-badge {
  font-size: .72rem;
  background: #1a2a3a;
  color: var(--accent);
  padding: .2rem .6rem;
  border-radius: 99px;
  border: 1px solid var(--accent);
  font-weight: 600;
}

/* ── AI Setup Overlay ── */
.ai-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.8);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  padding: 1rem;
  overflow-y: auto;
}

/* AI modal */
.ai-modal {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 18px;
  max-width: 540px;
  width: 100%;
  box-shadow: 0 40px 100px rgba(0,0,0,.75);
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

/* Modal header */
.ai-modal-header {
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 1.2rem 1.5rem;
  background: var(--surface);
  border-bottom: 1px solid var(--border);
}
.ai-modal-icon { font-size: 1.8rem; flex-shrink: 0; line-height: 1; }
.ai-modal-title-block { flex: 1; min-width: 0; }
.ai-modal-title-block h3 { color: var(--text); font-size: 1rem; margin: 0 0 .1rem; }
.ai-modal-title-block p  { font-size: .75rem; color: var(--muted); margin: 0; }
.ai-modal-close {
  background: none;
  border: none;
  color: var(--muted);
  font-size: 1.1rem;
  cursor: pointer;
  padding: .3rem .5rem;
  border-radius: 6px;
  transition: all .15s;
  flex-shrink: 0;
}
.ai-modal-close:hover { background: var(--border); color: var(--text); }

/* Step-by-step guide */
.ai-guide-box {
  background: #0d1a2e;
  border-bottom: 1px solid var(--border);
  padding: 1.1rem 1.5rem;
}
.ai-guide-title {
  font-size: .75rem;
  font-weight: 700;
  color: var(--accent);
  text-transform: uppercase;
  letter-spacing: .07em;
  margin-bottom: .65rem;
}
.ai-guide-steps {
  padding-left: 1.3rem;
  margin: 0;
}
.ai-guide-steps li {
  font-size: .83rem;
  color: var(--muted);
  margin-bottom: .45rem;
  line-height: 1.55;
}
.ai-guide-steps li:last-child { margin-bottom: 0; }
.ai-guide-steps strong { color: var(--text); }
.ai-guide-steps em { color: var(--muted); }
.ai-guide-steps code {
  background: var(--surface);
  border: 1px solid var(--border);
  padding: .1rem .38rem;
  border-radius: 4px;
  font-size: .78rem;
  color: var(--accent);
  font-family: 'Courier New', monospace;
}
.ai-link { color: var(--accent); text-decoration: none; font-weight: 600; }
.ai-link:hover { text-decoration: underline; }
.ai-guide-note {
  font-size: .75rem;
  color: var(--muted);
  margin: .65rem 0 0;
  padding: .55rem .75rem;
  background: rgba(56,189,248,.07);
  border-radius: 6px;
  border: 1px solid rgba(56,189,248,.15);
}

/* Key input row */
.ai-key-field-wrap {
  padding: 1.25rem 1.5rem .25rem;
}
.ai-key-label {
  display: block;
  font-size: .73rem;
  font-weight: 700;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: .07em;
  margin-bottom: .5rem;
}
.ai-key-row {
  display: flex;
  gap: .5rem;
  align-items: stretch;
}
.ai-key-input {
  flex: 1;
  background: var(--surface);
  border: 1.5px solid var(--border);
  color: var(--text);
  border-radius: 9px;
  padding: .65rem .9rem;
  font-size: .88rem;
  outline: none;
  transition: border-color .15s;
  font-family: 'Courier New', monospace;
  min-width: 0;
}
.ai-key-input:focus { border-color: var(--accent); }
.ai-toggle-btn { padding: .5rem .8rem; flex-shrink: 0; }

/* Status */
.ai-key-status {
  min-height: 1.8rem;
  padding: .35rem 1.5rem 0;
  font-size: .82rem;
  line-height: 1.45;
}
.ai-status-ok    { color: #34d399; }
.ai-status-error { color: #f87171; }
.ai-status-info  { color: var(--muted); }

/* Actions */
.ai-modal-actions {
  display: flex;
  gap: .75rem;
  padding: 1rem 1.5rem;
  flex-wrap: wrap;
}

/* Privacy note */
.ai-privacy-note {
  font-size: .72rem;
  color: var(--muted);
  padding: 0 1.5rem 1.2rem;
  margin: 0;
  opacity: .8;
}

/* ── Phrase Bank (Open-ended questions) — checklist style ── */
.phrase-bank {
  display: flex;
  flex-direction: column;
  gap: .35rem;
  margin: .75rem 0;
  padding: .75rem;
  background: var(--surface);
  border: 1.5px solid var(--border);
  border-radius: 10px;
  max-height: 340px;
  overflow-y: auto;
}
.phrase-bank-label {
  font-size: .7rem;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: .08em;
  font-weight: 700;
  padding: .2rem .3rem .5rem;
  border-bottom: 1px solid var(--border);
  margin-bottom: .25rem;
}
.phrase-chip {
  display: flex;
  align-items: center;
  gap: .75rem;
  width: 100%;
  padding: .6rem .9rem;
  border-radius: 8px;
  border: 1.5px solid var(--border);
  background: var(--card);
  color: var(--text);
  font-size: .85rem;
  font-weight: 500;
  cursor: pointer;
  transition: all .15s;
  user-select: none;
  text-align: left;
}
.phrase-chip::before {
  content: '';
  display: inline-block;
  width: 16px;
  height: 16px;
  min-width: 16px;
  border-radius: 4px;
  border: 2px solid var(--border);
  background: transparent;
  transition: all .15s;
}
.phrase-chip:hover:not(.locked) {
  border-color: var(--accent);
  color: var(--accent);
}
.phrase-chip:hover:not(.locked)::before { border-color: var(--accent); }
.phrase-chip.selected {
  background: #1a2a3a;
  border-color: var(--accent);
  color: var(--accent);
}
.phrase-chip.selected::before {
  background: var(--accent);
  border-color: var(--accent);
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12'%3E%3Cpath fill='%230f172a' d='M2 6l3 3 5-5' stroke='%230f172a' stroke-width='2' stroke-linecap='round' fill='none'/%3E%3C/svg%3E");
  background-size: 12px;
  background-repeat: no-repeat;
  background-position: center;
}
.phrase-chip.correct-chip {
  background: #063b27;
  border-color: var(--diversity);
  color: #6ee7b7;
}
.phrase-chip.correct-chip::before {
  background: var(--diversity);
  border-color: var(--diversity);
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12'%3E%3Cpath fill='none' stroke='%23fff' stroke-width='2' stroke-linecap='round' d='M2 6l3 3 5-5'/%3E%3C/svg%3E");
  background-size: 12px;
  background-repeat: no-repeat;
  background-position: center;
}
.phrase-chip.wrong-chip {
  background: #3b0f0f;
  border-color: #ef4444;
  color: #fca5a5;
}
.phrase-chip.wrong-chip::before {
  background: #ef4444;
  border-color: #ef4444;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12'%3E%3Cpath fill='none' stroke='%23fff' stroke-width='2' stroke-linecap='round' d='M3 3l6 6M9 3l-6 6'/%3E%3C/svg%3E");
  background-size: 10px;
  background-repeat: no-repeat;
  background-position: center;
}
.phrase-chip.locked { cursor: default; }

/* ── Synoptic Assessment ── */
.assess-header {
  background: var(--surface);
  border-bottom: 1px solid var(--border);
  padding: .9rem 1.5rem;
  display: flex;
  align-items: center;
  gap: 1rem;
  flex-wrap: wrap;
}
.topic-selector { margin: .75rem 0; }

/* Theme grouping */
.topic-theme-group { margin-bottom: 1rem; }
.topic-theme-group:last-child { margin-bottom: 0; }
.topic-theme-label {
  font-size: .7rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: .09em;
  display: flex;
  align-items: center;
  gap: .5rem;
  margin-bottom: .5rem;
}
.topic-theme-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  flex-shrink: 0;
}
.topic-theme-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: .45rem;
}

.topic-check-item {
  display: flex;
  align-items: center;
  gap: .6rem;
  padding: .55rem .85rem;
  border-radius: 8px;
  border: 1.5px solid var(--border);
  background: var(--surface);
  cursor: pointer;
  transition: all .15s;
  font-size: .85rem;
}
.topic-check-item:hover { border-color: var(--accent); }
.topic-check-item.selected { border-color: var(--accent); background: #1a2a3a; }
.topic-check-item input[type=checkbox] { accent-color: var(--accent); width: 15px; height: 15px; }
.topic-check-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }

.assess-q-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: .6rem;
}
.q-type-badge {
  font-size: .7rem;
  padding: .15rem .55rem;
  border-radius: 99px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: .06em;
}
.q-type-mcq        { background: #1e3a2a; color: var(--diversity); border: 1px solid var(--diversity); }
.q-type-open       { background: #1e183a; color: var(--systems); border: 1px solid var(--systems); }
.q-type-synoptic   { background: #2e2105; color: var(--energy); border: 1px solid var(--energy); }

.assess-nav {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 1.25rem;
  padding-top: .75rem;
  border-top: 1px solid var(--border);
}

.score-ring-wrap { display: flex; align-items: center; gap: 1rem; flex-wrap: wrap; }

/* ── Responsive ── */
@media (max-width: 768px) {
  :root { --cue-width: 100%; }
  .cornell-wrapper { grid-template-columns: 1fr; }
  .cornell-cue { border-right: none; border-bottom: 2px solid var(--border); }
  .quiz-mode-bar { flex-direction: column; }
  .topic-theme-grid { grid-template-columns: 1fr; }
}
