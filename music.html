<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Grade 5 Theory â€” Maestro Mode</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;0,900;1,400&family=Crimson+Text:ital,wght@0,400;0,600;1,400&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0d1117;
    --bg2: #161b22;
    --bg3: #21262d;
    --gold: #e6b84a;
    --gold2: #f0d080;
    --gold3: #c9932a;
    --cream: #f0ead6;
    --muted: #8b949e;
    --red: #e05c5c;
    --green: #56d364;
    --blue: #79c0ff;
    --purple: #bc8cff;
    --orange: #ffa657;
    --pink: #ff7fc6;
    --teal: #4fc3a1;
    --border: rgba(230,184,74,0.2);
    --card-bg: rgba(22,27,34,0.95);
    --shadow: 0 8px 32px rgba(0,0,0,0.5);
    --radius: 12px;
    --r2: 8px;
  }
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  html { font-size: 16px; }
  body {
    font-family: 'Crimson Text', Georgia, serif;
    background: var(--bg);
    color: var(--cream);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* â”€â”€â”€ Scrollbar â”€â”€â”€ */
  ::-webkit-scrollbar { width: 6px; }
  ::-webkit-scrollbar-track { background: var(--bg); }
  ::-webkit-scrollbar-thumb { background: var(--gold3); border-radius: 3px; }

  /* â”€â”€â”€ Staff Lines â”€â”€â”€ */
  .staff-header {
    position: relative;
    height: 80px;
    overflow: hidden;
    background: linear-gradient(to right, #0d1117, #161b22, #0d1117);
  }
  .staff-header::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background: repeating-linear-gradient(
      to bottom,
      transparent 0px, transparent 14px,
      rgba(230,184,74,0.25) 14px, rgba(230,184,74,0.25) 15.5px
    );
  }
  .staff-header-clef {
    position: absolute;
    left: 24px; top: 4px;
    font-size: 72px;
    color: var(--gold);
    opacity: 0.9;
    line-height: 1;
    text-shadow: 0 0 20px rgba(230,184,74,0.4);
  }
  .staff-header-title {
    position: absolute;
    left: 90px; top: 50%;
    transform: translateY(-50%);
    font-family: 'Playfair Display', serif;
    font-size: 1.5rem;
    font-weight: 900;
    letter-spacing: 0.05em;
    color: var(--gold2);
    text-shadow: 0 2px 12px rgba(0,0,0,0.8);
  }
  .staff-header-right {
    position: absolute;
    right: 24px; top: 50%;
    transform: translateY(-50%);
    display: flex; gap: 16px; align-items: center;
  }

  /* â”€â”€â”€ Screens â”€â”€â”€ */
  .screen { display: none; min-height: calc(100vh - 80px); animation: fadeIn 0.3s ease; }
  .screen.active { display: block; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

  /* â”€â”€â”€ XP Bar â”€â”€â”€ */
  .xp-pill {
    display: flex; align-items: center; gap: 10px;
    background: var(--bg3); border: 1px solid var(--border);
    border-radius: 24px; padding: 6px 14px;
    font-size: 0.8rem;
  }
  .xp-label { color: var(--gold); font-family: 'Playfair Display'; font-weight: 700; }
  .xp-bar-wrap { width: 100px; height: 6px; background: var(--bg); border-radius: 3px; overflow: hidden; }
  .xp-bar-fill { height: 100%; background: linear-gradient(90deg, var(--gold3), var(--gold2)); border-radius: 3px; transition: width 0.6s ease; }
  .streak-badge {
    background: linear-gradient(135deg, #c9932a, #e6b84a);
    border-radius: 20px; padding: 4px 12px;
    font-size: 0.8rem; font-weight: 700;
    color: #0d1117;
  }

  /* â”€â”€â”€ Dashboard â”€â”€â”€ */
  .dash-container {
    max-width: 960px; margin: 0 auto; padding: 32px 24px;
  }
  .dash-hero {
    text-align: center; margin-bottom: 40px;
  }
  .dash-hero h1 {
    font-family: 'Playfair Display', serif;
    font-size: 2.8rem; font-weight: 900;
    background: linear-gradient(135deg, var(--gold2), var(--gold3));
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    margin-bottom: 8px;
  }
  .dash-hero p { color: var(--muted); font-size: 1.1rem; }
  .dash-stats {
    display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px;
    margin-bottom: 36px;
  }
  .stat-card {
    background: var(--card-bg); border: 1px solid var(--border);
    border-radius: var(--radius); padding: 20px;
    text-align: center; transition: transform 0.2s, border-color 0.2s;
  }
  .stat-card:hover { transform: translateY(-2px); border-color: var(--gold3); }
  .stat-card .num {
    font-family: 'Playfair Display'; font-size: 2.2rem; font-weight: 900;
    color: var(--gold);
  }
  .stat-card .lbl { font-size: 0.85rem; color: var(--muted); margin-top: 4px; }

  /* â”€â”€â”€ Topic Grid â”€â”€â”€ */
  .section-title {
    font-family: 'Playfair Display'; font-size: 1.3rem; font-weight: 700;
    color: var(--gold2); margin-bottom: 16px;
    border-bottom: 1px solid var(--border); padding-bottom: 8px;
  }
  .topic-grid {
    display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
    gap: 16px; margin-bottom: 36px;
  }
  .topic-card {
    background: var(--card-bg); border: 1px solid var(--border);
    border-radius: var(--radius); padding: 20px;
    cursor: pointer; transition: all 0.25s ease; position: relative;
    overflow: hidden;
  }
  .topic-card::before {
    content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px;
    background: var(--accent); opacity: 0.8;
  }
  .topic-card:hover { transform: translateY(-3px); border-color: var(--accent); box-shadow: 0 8px 24px rgba(0,0,0,0.4); }
  .topic-icon { font-size: 2rem; margin-bottom: 8px; }
  .topic-name { font-family: 'Playfair Display'; font-size: 1rem; font-weight: 700; margin-bottom: 4px; }
  .topic-sub { font-size: 0.82rem; color: var(--muted); margin-bottom: 12px; }
  .topic-stars { color: var(--gold); font-size: 1rem; letter-spacing: 2px; margin-bottom: 8px; }
  .topic-prog-bar { height: 4px; background: var(--bg3); border-radius: 2px; overflow: hidden; }
  .topic-prog-fill { height: 100%; background: var(--accent); border-radius: 2px; transition: width 0.5s ease; }

  .btn {
    display: inline-flex; align-items: center; justify-content: center; gap: 8px;
    padding: 12px 24px; border-radius: var(--r2);
    font-family: 'Playfair Display'; font-weight: 700; font-size: 1rem;
    cursor: pointer; border: none; transition: all 0.2s ease; text-decoration: none;
  }
  .btn-primary {
    background: linear-gradient(135deg, var(--gold3), var(--gold));
    color: #0d1117;
    box-shadow: 0 4px 16px rgba(201,147,42,0.35);
  }
  .btn-primary:hover { transform: translateY(-1px); box-shadow: 0 6px 20px rgba(201,147,42,0.5); }
  .btn-secondary {
    background: var(--bg3); color: var(--cream);
    border: 1px solid var(--border);
  }
  .btn-secondary:hover { border-color: var(--gold3); background: var(--bg2); }
  .btn-sm { padding: 8px 16px; font-size: 0.85rem; }
  .btn-danger { background: rgba(224,92,92,0.15); color: var(--red); border: 1px solid rgba(224,92,92,0.3); }

  /* â”€â”€â”€ Quiz Engine â”€â”€â”€ */
  .quiz-container {
    max-width: 720px; margin: 0 auto; padding: 32px 24px;
  }
  .quiz-header {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 24px;
  }
  .quiz-progress-wrap { flex: 1; margin: 0 20px; }
  .quiz-progress-bar { height: 8px; background: var(--bg3); border-radius: 4px; overflow: hidden; }
  .quiz-progress-fill { height: 100%; background: linear-gradient(90deg, var(--gold3), var(--gold2)); border-radius: 4px; transition: width 0.4s ease; }
  .quiz-q-num { font-family: 'Playfair Display'; color: var(--muted); font-size: 0.9rem; }

  .question-card {
    background: var(--card-bg); border: 1px solid var(--border);
    border-radius: var(--radius); padding: 32px;
    margin-bottom: 20px; box-shadow: var(--shadow);
  }
  .question-topic-badge {
    display: inline-block; padding: 3px 12px; border-radius: 12px;
    font-size: 0.75rem; font-weight: 700; letter-spacing: 0.08em;
    margin-bottom: 16px; background: rgba(230,184,74,0.12);
    border: 1px solid rgba(230,184,74,0.3); color: var(--gold2);
    text-transform: uppercase;
  }
  .question-text {
    font-size: 1.25rem; line-height: 1.6; margin-bottom: 8px;
    font-style: italic; color: var(--cream);
  }
  .question-hint {
    font-size: 0.85rem; color: var(--muted); margin-bottom: 24px;
    font-style: normal;
  }

  /* Musical notation boxes */
  .music-box {
    background: #fafaf5; border: 1px solid #ccc; border-radius: 6px;
    padding: 12px 20px; margin: 16px 0;
    font-family: 'JetBrains Mono', monospace;
    color: #222; font-size: 0.9rem; line-height: 1.8;
    white-space: pre;
  }
  .staff-line {
    font-family: 'JetBrains Mono'; color: #333;
    letter-spacing: 0.05em; font-size: 1.1rem;
  }

  .options-grid { display: grid; gap: 10px; }
  .option-btn {
    background: var(--bg3); border: 1px solid var(--border);
    border-radius: var(--r2); padding: 14px 20px;
    text-align: left; cursor: pointer; transition: all 0.2s ease;
    color: var(--cream); font-family: 'Crimson Text'; font-size: 1rem;
    display: flex; align-items: center; gap: 12px;
  }
  .option-btn:hover:not(:disabled) { border-color: var(--gold3); background: rgba(201,147,42,0.08); }
  .option-btn.correct { background: rgba(86,211,100,0.12) !important; border-color: var(--green) !important; color: var(--green); }
  .option-btn.wrong { background: rgba(224,92,92,0.12) !important; border-color: var(--red) !important; color: var(--red); }
  .option-btn.reveal { background: rgba(86,211,100,0.06); border-color: rgba(86,211,100,0.4); }
  .option-btn:disabled { cursor: default; }
  .option-letter {
    width: 26px; height: 26px; border-radius: 50%;
    background: var(--bg); border: 1px solid var(--border);
    display: flex; align-items: center; justify-content: center;
    font-family: 'Playfair Display'; font-weight: 700; font-size: 0.8rem;
    flex-shrink: 0;
  }

  /* â”€â”€â”€ Feedback Banner â”€â”€â”€ */
  .feedback-banner {
    border-radius: var(--r2); padding: 16px 20px; margin-top: 16px;
    display: none; animation: slideUp 0.3s ease;
  }
  .feedback-banner.correct { background: rgba(86,211,100,0.1); border: 1px solid rgba(86,211,100,0.3); }
  .feedback-banner.wrong { background: rgba(224,92,92,0.1); border: 1px solid rgba(224,92,92,0.3); }
  .feedback-banner h4 { font-family: 'Playfair Display'; font-size: 1rem; margin-bottom: 4px; }
  .feedback-banner.correct h4 { color: var(--green); }
  .feedback-banner.wrong h4 { color: var(--red); }
  .feedback-banner p { font-size: 0.95rem; color: var(--cream); line-height: 1.5; }
  @keyframes slideUp { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }

  /* XP Pop */
  .xp-pop {
    position: fixed; pointer-events: none; z-index: 999;
    font-family: 'Playfair Display'; font-weight: 900;
    color: var(--gold2); font-size: 1.4rem;
    text-shadow: 0 2px 8px rgba(0,0,0,0.8);
    animation: xpFly 1.2s ease forwards;
  }
  @keyframes xpFly {
    0% { opacity: 1; transform: translateY(0) scale(1); }
    60% { opacity: 1; transform: translateY(-40px) scale(1.2); }
    100% { opacity: 0; transform: translateY(-80px) scale(0.8); }
  }

  /* â”€â”€â”€ Lesson Screen â”€â”€â”€ */
  .lesson-container { max-width: 760px; margin: 0 auto; padding: 32px 24px; }
  .lesson-header {
    display: flex; align-items: center; gap: 16px; margin-bottom: 28px;
  }
  .lesson-icon { font-size: 3rem; }
  .lesson-title { font-family: 'Playfair Display'; font-size: 2rem; font-weight: 900; }
  .lesson-subtitle { color: var(--muted); font-size: 1rem; }

  .lesson-section {
    background: var(--card-bg); border: 1px solid var(--border);
    border-radius: var(--radius); padding: 24px; margin-bottom: 20px;
  }
  .lesson-section h3 {
    font-family: 'Playfair Display'; font-size: 1.2rem; color: var(--gold2);
    margin-bottom: 14px; display: flex; align-items: center; gap: 8px;
  }
  .lesson-section p { line-height: 1.8; font-size: 1.05rem; color: var(--cream); margin-bottom: 10px; }
  .lesson-section ul { padding-left: 20px; line-height: 1.9; font-size: 1.05rem; }
  .lesson-section li { margin-bottom: 4px; }

  .key-point {
    background: rgba(230,184,74,0.08); border-left: 3px solid var(--gold3);
    padding: 12px 16px; border-radius: 0 var(--r2) var(--r2) 0;
    margin: 12px 0; font-size: 1rem; line-height: 1.7;
  }
  .warning-point {
    background: rgba(224,92,92,0.08); border-left: 3px solid var(--red);
    padding: 12px 16px; border-radius: 0 var(--r2) var(--r2) 0;
    margin: 12px 0; font-size: 1rem;
  }

  .table-wrap { overflow-x: auto; margin: 14px 0; }
  table { width: 100%; border-collapse: collapse; font-size: 0.95rem; }
  th { background: var(--bg3); color: var(--gold2); padding: 10px 14px; text-align: left; font-family: 'Playfair Display'; font-weight: 700; }
  td { padding: 9px 14px; border-bottom: 1px solid var(--border); color: var(--cream); }
  tr:hover td { background: rgba(230,184,74,0.04); }

  /* â”€â”€â”€ Results Screen â”€â”€â”€ */
  .results-container { max-width: 680px; margin: 0 auto; padding: 40px 24px; text-align: center; }
  .results-score {
    font-family: 'Playfair Display'; font-size: 5rem; font-weight: 900;
    background: linear-gradient(135deg, var(--gold2), var(--gold3));
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    margin: 20px 0 8px;
  }
  .results-label { color: var(--muted); font-size: 1.1rem; margin-bottom: 28px; }
  .results-breakdown {
    background: var(--card-bg); border: 1px solid var(--border);
    border-radius: var(--radius); padding: 24px; margin-bottom: 28px;
    text-align: left;
  }
  .breakdown-row {
    display: flex; justify-content: space-between; align-items: center;
    padding: 10px 0; border-bottom: 1px solid var(--border);
  }
  .breakdown-row:last-child { border-bottom: none; }
  .breakdown-topic { display: flex; align-items: center; gap: 10px; }
  .breakdown-score-badge { font-family: 'Playfair Display'; font-weight: 700; font-size: 0.9rem; }
  .score-high { color: var(--green); }
  .score-mid { color: var(--orange); }
  .score-low { color: var(--red); }

  /* â”€â”€â”€ Quick Ref â”€â”€â”€ */
  .ref-container { max-width: 960px; margin: 0 auto; padding: 32px 24px; }
  .ref-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
  .ref-card {
    background: var(--card-bg); border: 1px solid var(--border);
    border-radius: var(--radius); padding: 20px;
  }
  .ref-card h3 { font-family: 'Playfair Display'; color: var(--gold2); margin-bottom: 14px; font-size: 1.1rem; }
  .ref-table { width: 100%; font-size: 0.88rem; }
  .ref-table td { padding: 5px 8px; border-bottom: 1px solid rgba(255,255,255,0.05); vertical-align: top; }
  .ref-table td:first-child { color: var(--gold); font-weight: 600; width: 35%; }

  /* â”€â”€â”€ Achievement Toast â”€â”€â”€ */
  .achievement-toast {
    position: fixed; bottom: 24px; right: 24px;
    background: linear-gradient(135deg, var(--bg3), var(--bg2));
    border: 1px solid var(--gold3);
    border-radius: var(--radius); padding: 16px 20px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.6), 0 0 0 1px rgba(230,184,74,0.2);
    z-index: 1000; display: none; animation: toastIn 0.4s ease;
    min-width: 260px;
  }
  @keyframes toastIn { from { opacity: 0; transform: translateX(40px); } to { opacity: 1; transform: translateX(0); } }
  .achievement-toast .ach-icon { font-size: 2rem; margin-bottom: 4px; }
  .achievement-toast .ach-title { font-family: 'Playfair Display'; color: var(--gold); font-weight: 700; }
  .achievement-toast .ach-desc { font-size: 0.85rem; color: var(--muted); }

  /* â”€â”€â”€ Modal â”€â”€â”€ */
  .modal-overlay {
    position: fixed; inset: 0; background: rgba(0,0,0,0.75);
    display: none; align-items: center; justify-content: center; z-index: 999;
  }
  .modal-overlay.open { display: flex; }
  .modal-box {
    background: var(--bg2); border: 1px solid var(--border);
    border-radius: var(--radius); padding: 32px; max-width: 520px; width: 90%;
    box-shadow: var(--shadow); animation: fadeIn 0.3s ease;
  }
  .modal-box h2 { font-family: 'Playfair Display'; color: var(--gold2); margin-bottom: 12px; }
  .modal-box p { color: var(--cream); line-height: 1.7; margin-bottom: 20px; }
  .modal-actions { display: flex; gap: 12px; }

  /* Nav tabs at bottom of screen */
  .bottom-nav {
    position: fixed; bottom: 0; left: 0; right: 0;
    background: rgba(13,17,23,0.95); backdrop-filter: blur(12px);
    border-top: 1px solid var(--border);
    display: flex; justify-content: center; gap: 8px; padding: 12px 16px;
    z-index: 100;
  }
  .nav-btn {
    display: flex; flex-direction: column; align-items: center; gap: 3px;
    padding: 8px 20px; border-radius: var(--r2); cursor: pointer;
    border: none; background: transparent; color: var(--muted);
    font-family: 'Crimson Text'; font-size: 0.78rem; transition: all 0.2s;
  }
  .nav-btn .nav-icon { font-size: 1.3rem; }
  .nav-btn:hover, .nav-btn.active { color: var(--gold); background: rgba(230,184,74,0.1); }
  .main-content { padding-bottom: 80px; }

  /* Streak fire effect */
  .fire { display: inline-block; animation: flicker 0.8s infinite alternate; }
  @keyframes flicker { from { transform: scale(1); } to { transform: scale(1.1) rotate(3deg); } }

  /* Confetti particles */
  .confetti-particle {
    position: fixed; width: 8px; height: 8px; border-radius: 2px;
    pointer-events: none; z-index: 9999;
    animation: confettiFall var(--dur) ease forwards;
  }
  @keyframes confettiFall {
    0% { transform: translateY(-20px) rotate(0deg); opacity: 1; }
    100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
  }

  /* Responsive */
  @media (max-width: 600px) {
    .dash-stats { grid-template-columns: repeat(2, 1fr); }
    .ref-grid { grid-template-columns: 1fr; }
    .dash-hero h1 { font-size: 2rem; }
  }

  /* Level badge */
  .level-badge {
    display: inline-flex; align-items: center; gap: 6px;
    background: linear-gradient(135deg, rgba(201,147,42,0.2), rgba(230,184,74,0.1));
    border: 1px solid rgba(230,184,74,0.4); border-radius: 20px;
    padding: 4px 14px; font-family: 'Playfair Display'; font-size: 0.85rem;
    color: var(--gold2);
  }

  /* Tooltip */
  [title] { cursor: help; }

  /* Tag chips */
  .chip {
    display: inline-block; padding: 2px 10px; border-radius: 10px;
    font-size: 0.78rem; font-weight: 700; letter-spacing: 0.04em;
  }
  .chip-red { background: rgba(224,92,92,0.15); color: var(--red); border: 1px solid rgba(224,92,92,0.3); }
  .chip-green { background: rgba(86,211,100,0.15); color: var(--green); border: 1px solid rgba(86,211,100,0.3); }
  .chip-yellow { background: rgba(230,184,74,0.15); color: var(--gold); border: 1px solid rgba(230,184,74,0.3); }
  .chip-blue { background: rgba(121,192,255,0.15); color: var(--blue); border: 1px solid rgba(121,192,255,0.3); }

  .flex-row { display: flex; gap: 12px; align-items: center; flex-wrap: wrap; }
  .spacer { flex: 1; }

  .bold { font-weight: 700; }
  .italic { font-style: italic; }
  .gold { color: var(--gold); }

  /* Lesson nav */
  .lesson-nav { display: flex; gap: 8px; margin-bottom: 24px; flex-wrap: wrap; }
  .lesson-nav-btn {
    padding: 6px 14px; border-radius: 20px; cursor: pointer; border: none;
    background: var(--bg3); color: var(--muted); font-size: 0.83rem;
    border: 1px solid var(--border); transition: all 0.2s;
    font-family: 'Crimson Text';
  }
  .lesson-nav-btn:hover, .lesson-nav-btn.active {
    background: rgba(230,184,74,0.12); color: var(--gold); border-color: var(--gold3);
  }

  /* Diagnostic intro */
  .diag-intro {
    max-width: 600px; margin: 60px auto; padding: 24px;
    text-align: center;
  }
  .diag-intro h2 { font-family: 'Playfair Display'; font-size: 2rem; color: var(--gold2); margin-bottom: 12px; }
  .diag-intro p { color: var(--cream); line-height: 1.8; font-size: 1.1rem; margin-bottom: 24px; }

  /* Mastery indicators */
  .mastery-dot {
    width: 10px; height: 10px; border-radius: 50%; display: inline-block; margin-left: 4px;
  }
  .mastery-0 { background: var(--bg3); border: 1px solid var(--border); }
  .mastery-1 { background: var(--red); }
  .mastery-2 { background: var(--orange); }
  .mastery-3 { background: var(--gold); }
  .mastery-4 { background: var(--green); }

</style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HEADER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="staff-header">
  <div class="staff-header-clef">ğ„</div>
  <div class="staff-header-title">Maestro Mode â€” Grade 5 Theory</div>
  <div class="staff-header-right">
    <div class="xp-pill">
      <span class="xp-label" id="hdr-level">Lvl 1</span>
      <div class="xp-bar-wrap"><div class="xp-bar-fill" id="hdr-xpbar" style="width:0%"></div></div>
      <span id="hdr-xp" style="color:var(--gold);font-size:0.8rem">0 XP</span>
    </div>
    <div class="streak-badge"><span class="fire">ğŸ”¥</span> <span id="hdr-streak">0</span></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MAIN CONTENT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="main-content">

<!-- â”€â”€â”€ DASHBOARD â”€â”€â”€ -->
<div id="screen-dashboard" class="screen active">
  <div class="dash-container">
    <div class="dash-hero">
      <h1 id="dash-greeting">Ready to Conquer Grade 5?</h1>
      <p id="dash-sub">Your exam is in 2-3 days. Let's focus on what matters most.</p>
      <div style="margin-top:16px;display:flex;gap:12px;justify-content:center;flex-wrap:wrap">
        <button class="btn btn-primary" onclick="startDiagnostic()">ğŸ¯ Diagnostic Test</button>
        <button class="btn btn-secondary" onclick="goScreen('screen-reference')">ğŸ“– Quick Reference</button>
      </div>
    </div>

    <div class="dash-stats">
      <div class="stat-card">
        <div class="num" id="stat-xp">0</div>
        <div class="lbl">Total XP</div>
      </div>
      <div class="stat-card">
        <div class="num" id="stat-streak">0 ğŸ”¥</div>
        <div class="lbl">Best Streak</div>
      </div>
      <div class="stat-card">
        <div class="num" id="stat-correct">0%</div>
        <div class="lbl">Overall Accuracy</div>
      </div>
      <div class="stat-card">
        <div class="num" id="stat-topics">0/8</div>
        <div class="lbl">Topics Mastered</div>
      </div>
    </div>

    <p class="section-title">ğŸ“š Topic Modules</p>
    <div class="topic-grid" id="topic-grid"></div>

    <p class="section-title" style="margin-top:28px">ğŸ¯ Priority Focus Areas</p>
    <div id="priority-areas" style="color:var(--muted);font-style:italic;padding:16px">
      Complete the Diagnostic Test to see your weak areas here.
    </div>

    <div style="margin-top:32px;text-align:center">
      <button class="btn btn-danger btn-sm" onclick="confirmReset()">â†º Reset All Progress</button>
    </div>
  </div>
</div>

<!-- â”€â”€â”€ DIAGNOSTIC INTRO â”€â”€â”€ -->
<div id="screen-diag-intro" class="screen">
  <div class="diag-intro">
    <div style="font-size:4rem;margin-bottom:16px">ğŸ¯</div>
    <h2>Diagnostic Assessment</h2>
    <p>This 24-question test covers all 8 theory topics. It takes about <strong>10-15 minutes</strong> and will pinpoint your strongest and weakest areas so we can focus your revision where it counts most.</p>
    <div style="background:var(--card-bg);border:1px solid var(--border);border-radius:var(--radius);padding:20px;margin:20px 0;text-align:left">
      <p style="color:var(--gold2);font-family:'Playfair Display';font-weight:700;margin-bottom:8px">What's covered:</p>
      <ul style="padding-left:20px;line-height:2;color:var(--muted)">
        <li>Rhythm &amp; Time Signatures (3 Qs)</li>
        <li>Scales &amp; Key Signatures (3 Qs)</li>
        <li>Intervals (3 Qs)</li>
        <li>Chords &amp; Harmony (3 Qs)</li>
        <li>Clefs &amp; Transposition (3 Qs)</li>
        <li>Terms, Signs &amp; Ornaments (3 Qs)</li>
        <li>Instruments &amp; Voices (3 Qs)</li>
        <li>Minor Scales &amp; Modes (3 Qs)</li>
      </ul>
    </div>
    <button class="btn btn-primary" onclick="beginDiagnostic()" style="font-size:1.1rem;padding:14px 32px">
      Begin Diagnostic â–¶
    </button>
    <br><br>
    <button class="btn btn-secondary btn-sm" onclick="goScreen('screen-dashboard')">â† Back</button>
  </div>
</div>

<!-- â”€â”€â”€ QUIZ SCREEN â”€â”€â”€ -->
<div id="screen-quiz" class="screen">
  <div class="quiz-container">
    <div class="quiz-header">
      <button class="btn btn-secondary btn-sm" onclick="exitQuiz()">â† Exit</button>
      <div class="quiz-progress-wrap">
        <div class="quiz-progress-bar">
          <div class="quiz-progress-fill" id="quiz-progress-fill" style="width:0%"></div>
        </div>
      </div>
      <div class="quiz-q-num" id="quiz-q-num">Q 1/24</div>
    </div>

    <div class="question-card" id="question-card">
      <div class="question-topic-badge" id="q-topic-badge">TOPIC</div>
      <div class="question-text" id="q-text">Loading...</div>
      <div id="q-music-box" style="display:none"></div>
      <div class="question-hint" id="q-hint"></div>
      <div class="options-grid" id="q-options"></div>
      <div class="feedback-banner" id="q-feedback">
        <h4 id="fb-title"></h4>
        <p id="fb-body"></p>
      </div>
    </div>

    <div style="text-align:right">
      <button class="btn btn-primary" id="quiz-next-btn" style="display:none" onclick="nextQuestion()">
        Next Question â†’
      </button>
    </div>
  </div>
</div>

<!-- â”€â”€â”€ RESULTS SCREEN â”€â”€â”€ -->
<div id="screen-results" class="screen">
  <div class="results-container">
    <div style="font-size:4rem" id="results-emoji">ğŸ†</div>
    <div class="results-score" id="results-score">0/24</div>
    <div class="results-label" id="results-label">Loading...</div>
    <div style="margin-bottom:24px" id="results-rank-badge"></div>

    <div class="results-breakdown" id="results-breakdown"></div>

    <div style="display:flex;gap:12px;justify-content:center;flex-wrap:wrap;margin-bottom:16px">
      <button class="btn btn-primary" id="results-practice-btn" onclick="practiceWeak()">
        ğŸ¯ Practice Weak Areas
      </button>
      <button class="btn btn-secondary" onclick="goScreen('screen-dashboard')">â† Dashboard</button>
    </div>
    <p style="color:var(--muted);font-size:0.9rem" id="results-advice"></p>
  </div>
</div>

<!-- â”€â”€â”€ LESSONS SCREEN â”€â”€â”€ -->
<div id="screen-lesson" class="screen">
  <div class="lesson-container">
    <div style="margin-bottom:16px">
      <button class="btn btn-secondary btn-sm" onclick="goScreen('screen-dashboard')">â† Dashboard</button>
    </div>
    <div class="lesson-header">
      <div class="lesson-icon" id="lesson-icon">â™©</div>
      <div>
        <div class="lesson-title" id="lesson-title">Topic</div>
        <div class="lesson-subtitle" id="lesson-subtitle">Learn the concepts</div>
      </div>
    </div>
    <div class="lesson-nav" id="lesson-nav"></div>
    <div id="lesson-content"></div>
    <div style="margin-top:28px;display:flex;gap:12px;flex-wrap:wrap">
      <button class="btn btn-primary" id="lesson-practice-btn" onclick="startTopicPractice()">
        âœï¸ Practice This Topic
      </button>
    </div>
  </div>
</div>

<!-- â”€â”€â”€ QUICK REFERENCE â”€â”€â”€ -->
<div id="screen-reference" class="screen">
  <div class="ref-container">
    <div style="margin-bottom:24px;display:flex;align-items:center;gap:12px">
      <button class="btn btn-secondary btn-sm" onclick="goScreen('screen-dashboard')">â† Back</button>
      <span class="section-title" style="margin:0;border:none">ğŸ“– Quick Reference Sheets</span>
    </div>
    <div class="ref-grid">

      <div class="ref-card">
        <h3>ğŸ”‘ Key Signatures</h3>
        <table class="ref-table">
          <tr><td>C major / A minor</td><td>0 sharps/flats</td></tr>
          <tr><td>G major / E minor</td><td>Fâ™¯</td></tr>
          <tr><td>D major / B minor</td><td>Fâ™¯ Câ™¯</td></tr>
          <tr><td>A major / Fâ™¯ minor</td><td>Fâ™¯ Câ™¯ Gâ™¯</td></tr>
          <tr><td>E major / Câ™¯ minor</td><td>Fâ™¯ Câ™¯ Gâ™¯ Dâ™¯</td></tr>
          <tr><td>B major / Gâ™¯ minor</td><td>Fâ™¯ Câ™¯ Gâ™¯ Dâ™¯ Aâ™¯</td></tr>
          <tr><td>Fâ™¯ major / Dâ™¯ minor</td><td>Fâ™¯ Câ™¯ Gâ™¯ Dâ™¯ Aâ™¯ Eâ™¯</td></tr>
          <tr><td>F major / D minor</td><td>Bâ™­</td></tr>
          <tr><td>Bâ™­ major / G minor</td><td>Bâ™­ Eâ™­</td></tr>
          <tr><td>Eâ™­ major / C minor</td><td>Bâ™­ Eâ™­ Aâ™­</td></tr>
          <tr><td>Aâ™­ major / F minor</td><td>Bâ™­ Eâ™­ Aâ™­ Dâ™­</td></tr>
          <tr><td>Dâ™­ major / Bâ™­ minor</td><td>Bâ™­ Eâ™­ Aâ™­ Dâ™­ Gâ™­</td></tr>
          <tr><td>Gâ™­ major / Eâ™­ minor</td><td>Bâ™­ Eâ™­ Aâ™­ Dâ™­ Gâ™­ Câ™­</td></tr>
        </table>
      </div>

      <div class="ref-card">
        <h3>â†•ï¸ Intervals</h3>
        <table class="ref-table">
          <tr><td>Perfect Unison</td><td>0 semitones</td></tr>
          <tr><td>Minor 2nd</td><td>1 semitone</td></tr>
          <tr><td>Major 2nd</td><td>2 semitones</td></tr>
          <tr><td>Minor 3rd</td><td>3 semitones</td></tr>
          <tr><td>Major 3rd</td><td>4 semitones</td></tr>
          <tr><td>Perfect 4th</td><td>5 semitones</td></tr>
          <tr><td>Augmented 4th / Dim 5th</td><td>6 semitones</td></tr>
          <tr><td>Perfect 5th</td><td>7 semitones</td></tr>
          <tr><td>Minor 6th</td><td>8 semitones</td></tr>
          <tr><td>Major 6th</td><td>9 semitones</td></tr>
          <tr><td>Minor 7th</td><td>10 semitones</td></tr>
          <tr><td>Major 7th</td><td>11 semitones</td></tr>
          <tr><td>Perfect Octave</td><td>12 semitones</td></tr>
        </table>
        <p style="color:var(--muted);font-size:0.82rem;margin-top:8px">Compound: add 7 to simple name (e.g. 9th = 2nd + octave)</p>
      </div>

      <div class="ref-card">
        <h3>ğŸ­ Terms & Signs â€” Tempo</h3>
        <table class="ref-table">
          <tr><td>Grave</td><td>Very slow, solemn</td></tr>
          <tr><td>Largo</td><td>Very slow, broad</td></tr>
          <tr><td>Larghetto</td><td>Slightly faster than Largo</td></tr>
          <tr><td>Lento</td><td>Slow</td></tr>
          <tr><td>Adagio</td><td>Slow and stately</td></tr>
          <tr><td>Andante</td><td>Walking pace</td></tr>
          <tr><td>Andantino</td><td>Slightly faster than andante</td></tr>
          <tr><td>Moderato</td><td>At a moderate pace</td></tr>
          <tr><td>Allegretto</td><td>Moderately fast</td></tr>
          <tr><td>Allegro</td><td>Fast and lively</td></tr>
          <tr><td>Vivace</td><td>Lively, vivacious</td></tr>
          <tr><td>Presto</td><td>Very fast</td></tr>
          <tr><td>Prestissimo</td><td>As fast as possible</td></tr>
          <tr><td>accelerando (accel.)</td><td>Getting faster</td></tr>
          <tr><td>rallentando (rall.)</td><td>Getting slower</td></tr>
          <tr><td>ritenuto (rit./riten.)</td><td>Held back, slower</td></tr>
          <tr><td>ritardando (rit./ritard.)</td><td>Gradually getting slower</td></tr>
          <tr><td>a tempo</td><td>Return to original tempo</td></tr>
          <tr><td>rubato</td><td>Free, flexible tempo</td></tr>
        </table>
      </div>

      <div class="ref-card">
        <h3>ğŸ­ Terms & Signs â€” Expression</h3>
        <table class="ref-table">
          <tr><td>ppp</td><td>Pianississimo â€“ very very soft</td></tr>
          <tr><td>pp</td><td>Pianissimo â€“ very soft</td></tr>
          <tr><td>p</td><td>Piano â€“ soft</td></tr>
          <tr><td>mp</td><td>Mezzo-piano â€“ moderately soft</td></tr>
          <tr><td>mf</td><td>Mezzo-forte â€“ moderately loud</td></tr>
          <tr><td>f</td><td>Forte â€“ loud</td></tr>
          <tr><td>ff</td><td>Fortissimo â€“ very loud</td></tr>
          <tr><td>fff</td><td>Fortississimo â€“ very very loud</td></tr>
          <tr><td>sfz / sf</td><td>Sforzando â€“ forced accent</td></tr>
          <tr><td>fz</td><td>Forzando â€“ forced</td></tr>
          <tr><td>crescendo</td><td>Getting louder</td></tr>
          <tr><td>decrescendo / dim.</td><td>Getting softer</td></tr>
          <tr><td>agitato</td><td>Agitated</td></tr>
          <tr><td>amabile</td><td>Amiable, pleasant</td></tr>
          <tr><td>appassionato</td><td>Passionately</td></tr>
          <tr><td>cantabile</td><td>In a singing style</td></tr>
          <tr><td>con brio</td><td>With vigour</td></tr>
          <tr><td>con fuoco</td><td>With fire</td></tr>
          <tr><td>con moto</td><td>With movement</td></tr>
          <tr><td>dolce</td><td>Sweetly</td></tr>
          <tr><td>espressivo (espress.)</td><td>Expressively</td></tr>
          <tr><td>giocoso</td><td>Playfully, humorously</td></tr>
          <tr><td>grazioso</td><td>Gracefully</td></tr>
          <tr><td>leggiero</td><td>Lightly</td></tr>
          <tr><td>maestoso</td><td>Majestically</td></tr>
          <tr><td>marcato</td><td>Marked, stressed</td></tr>
          <tr><td>scherzando</td><td>Playfully, jokingly</td></tr>
          <tr><td>semplice</td><td>Simply</td></tr>
          <tr><td>sostenuto</td><td>Sustained</td></tr>
          <tr><td>tranquillo</td><td>Calmly, quietly</td></tr>
          <tr><td>brillante</td><td>Brilliantly</td></tr>
          <tr><td>comodo</td><td>Comfortable, leisurely</td></tr>
          <tr><td>forza</td><td>Force, power</td></tr>
          <tr><td>furioso</td><td>Furiously</td></tr>
          <tr><td>grandioso</td><td>Grandly</td></tr>
          <tr><td>lacrimoso</td><td>Tearfully</td></tr>
          <tr><td>marziale</td><td>In a military style</td></tr>
          <tr><td>mesto</td><td>Sadly</td></tr>
          <tr><td>nobilmente</td><td>Nobly</td></tr>
          <tr><td>pastorale</td><td>Peaceful, rural style</td></tr>
          <tr><td>risoluto</td><td>Boldly, resolutely</td></tr>
          <tr><td>teneramente</td><td>Tenderly</td></tr>
          <tr><td>vivo/vivace</td><td>Lively</td></tr>
        </table>
      </div>

      <div class="ref-card">
        <h3>ğŸ¶ Performance Directions</h3>
        <table class="ref-table">
          <tr><td>legato</td><td>Smoothly</td></tr>
          <tr><td>staccato</td><td>Detached</td></tr>
          <tr><td>staccatissimo</td><td>Very detached</td></tr>
          <tr><td>tenuto (ten.)</td><td>Held, sustained</td></tr>
          <tr><td>portato</td><td>Carried, semi-detached</td></tr>
          <tr><td>pizzicato (pizz.)</td><td>Plucked (strings)</td></tr>
          <tr><td>arco</td><td>With the bow (strings)</td></tr>
          <tr><td>col legno</td><td>With the wood of the bow</td></tr>
          <tr><td>sul ponticello</td><td>Bow near the bridge</td></tr>
          <tr><td>sul tasto</td><td>Bow over the fingerboard</td></tr>
          <tr><td>con sordino</td><td>With mute</td></tr>
          <tr><td>senza sordino</td><td>Without mute</td></tr>
          <tr><td>tremolo</td><td>Rapid repetition of a note</td></tr>
          <tr><td>vibrato</td><td>Slight wavering of pitch</td></tr>
          <tr><td>glissando (gliss.)</td><td>Slide between notes</td></tr>
          <tr><td>ossia</td><td>Alternatively</td></tr>
          <tr><td>tacet</td><td>Be silent</td></tr>
          <tr><td>Da Capo (D.C.)</td><td>From the beginning</td></tr>
          <tr><td>Dal Segno (D.S.)</td><td>From the sign (ğ„‹)</td></tr>
          <tr><td>al Fine</td><td>To the end</td></tr>
          <tr><td>al Coda</td><td>To the Coda (âŠ•)</td></tr>
          <tr><td>8va</td><td>Play an octave higher</td></tr>
          <tr><td>8vb</td><td>Play an octave lower</td></tr>
          <tr><td>loco</td><td>At normal pitch (after 8va)</td></tr>
          <tr><td>simile</td><td>Continue in the same way</td></tr>
          <tr><td>volta subito (v.s.)</td><td>Turn over quickly</td></tr>
        </table>
      </div>

      <div class="ref-card">
        <h3>ğŸ» Instruments & Clefs</h3>
        <table class="ref-table">
          <tr><td colspan="2" style="color:var(--gold2);font-weight:700;padding-top:8px">Strings</td></tr>
          <tr><td>Violin</td><td>Treble clef</td></tr>
          <tr><td>Viola</td><td>Alto clef (C, 3rd line)</td></tr>
          <tr><td>Cello</td><td>Bass; tenor for high notes</td></tr>
          <tr><td>Double Bass</td><td>Bass clef (sounds 8va lower)</td></tr>
          <tr><td colspan="2" style="color:var(--gold2);font-weight:700;padding-top:8px">Woodwind</td></tr>
          <tr><td>Flute, Oboe</td><td>Treble clef (C instruments)</td></tr>
          <tr><td>Clarinet in Bâ™­</td><td>Treble; sounds M2nd lower</td></tr>
          <tr><td>Clarinet in A</td><td>Treble; sounds m3rd lower</td></tr>
          <tr><td>Bassoon</td><td>Bass &amp; tenor clef</td></tr>
          <tr><td colspan="2" style="color:var(--gold2);font-weight:700;padding-top:8px">Brass</td></tr>
          <tr><td>Horn in F</td><td>Treble; sounds P5th lower</td></tr>
          <tr><td>Trumpet in Bâ™­</td><td>Treble; sounds M2nd lower</td></tr>
          <tr><td>Trombone, Tuba</td><td>Bass clef (C instruments)</td></tr>
          <tr><td colspan="2" style="color:var(--gold2);font-weight:700;padding-top:8px">Voice Types</td></tr>
          <tr><td>Soprano, Mezzo-S, Alto</td><td>Treble clef</td></tr>
          <tr><td>Tenor</td><td>Treble (sounds 8va lower) or tenor clef</td></tr>
          <tr><td>Baritone, Bass</td><td>Bass clef</td></tr>
        </table>
      </div>

      <div class="ref-card">
        <h3>ğŸµ Chord Inversions</h3>
        <table class="ref-table">
          <tr><td>Root position</td><td>Root at bottom â€” 5/3 â€” no figure or âµâ‚ƒ</td></tr>
          <tr><td>1st inversion</td><td>3rd at bottom â€” 6/3 â€” figure: â¶ or â¶â‚ƒ</td></tr>
          <tr><td>2nd inversion</td><td>5th at bottom â€” 6/4 â€” figure: â¶â‚„</td></tr>
        </table>
        <br>
        <table class="ref-table">
          <tr><td colspan="2" style="color:var(--gold2);font-weight:700">Triad Types</td></tr>
          <tr><td>Major</td><td>M3 + m3 (e.g. Câ€“Eâ€“G)</td></tr>
          <tr><td>Minor</td><td>m3 + M3 (e.g. Aâ€“Câ€“E)</td></tr>
          <tr><td>Augmented</td><td>M3 + M3 (e.g. Câ€“Eâ€“Gâ™¯)</td></tr>
          <tr><td>Diminished</td><td>m3 + m3 (e.g. Bâ€“Dâ€“F)</td></tr>
        </table>
        <br>
        <table class="ref-table">
          <tr><td colspan="2" style="color:var(--gold2);font-weight:700">Degrees of the Scale</td></tr>
          <tr><td>I</td><td>Tonic</td></tr>
          <tr><td>II</td><td>Supertonic</td></tr>
          <tr><td>III</td><td>Mediant</td></tr>
          <tr><td>IV</td><td>Subdominant</td></tr>
          <tr><td>V</td><td>Dominant</td></tr>
          <tr><td>VI</td><td>Submediant</td></tr>
          <tr><td>VII</td><td>Leading note</td></tr>
        </table>
      </div>

      <div class="ref-card">
        <h3>ğŸŒ€ Ornaments</h3>
        <table class="ref-table">
          <tr><td>Trill (tr or ~~~)</td><td>Rapid alternation between note and note above (major or minor 2nd). Starts on upper note in Baroque; on written note in Classical/Romantic (ABRSM accepts both for G5)</td></tr>
          <tr><td>Mordent (â™© with wavy line below)</td><td>Lower mordent: main note â†’ one below â†’ main note</td></tr>
          <tr><td>Upper mordent / Pralltriller</td><td>main note â†’ one above â†’ main note</td></tr>
          <tr><td>Turn (~)</td><td>Upper note â†’ main â†’ lower â†’ main (4 notes)</td></tr>
          <tr><td>Acciaccatura (grace note with slash)</td><td>"Crushed" note â€“ played as quickly as possible before the main note</td></tr>
          <tr><td>Appoggiatura (plain grace note)</td><td>"Leaning" note â€“ takes half (or two-thirds) the value of the main note; resolved on the beat</td></tr>
        </table>
      </div>

      <div class="ref-card">
        <h3>â±ï¸ Time Signatures</h3>
        <table class="ref-table">
          <tr><td colspan="2" style="color:var(--gold2);font-weight:700">Simple Time</td></tr>
          <tr><td>2/4</td><td>2 crotchet beats per bar</td></tr>
          <tr><td>3/4</td><td>3 crotchet beats per bar</td></tr>
          <tr><td>4/4 (C)</td><td>4 crotchet beats per bar</td></tr>
          <tr><td>2/2 (ğ„µ)</td><td>2 minim beats per bar (alla breve)</td></tr>
          <tr><td>3/2</td><td>3 minim beats per bar</td></tr>
          <tr><td>3/8</td><td>3 quaver beats per bar</td></tr>
          <tr><td colspan="2" style="color:var(--gold2);font-weight:700;padding-top:8px">Compound Time</td></tr>
          <tr><td>6/8</td><td>2 dotted crotchet beats</td></tr>
          <tr><td>9/8</td><td>3 dotted crotchet beats</td></tr>
          <tr><td>12/8</td><td>4 dotted crotchet beats</td></tr>
          <tr><td colspan="2" style="color:var(--gold2);font-weight:700;padding-top:8px">Irregular Time</td></tr>
          <tr><td>5/4</td><td>5 crotchet beats (usually 2+3 or 3+2)</td></tr>
          <tr><td>7/4</td><td>7 crotchet beats (usually 4+3 or 3+4)</td></tr>
          <tr><td>5/8</td><td>5 quaver beats</td></tr>
          <tr><td>7/8</td><td>7 quaver beats</td></tr>
        </table>
        <div class="key-point" style="margin-top:12px;font-size:0.85rem">
          <strong>Simple:</strong> top Ã· beats per bar, bottom = note value denominator<br>
          <strong>Compound:</strong> top Ã· 3 = beats, each beat = dotted note<br>
          <strong>Triplet:</strong> 3 notes in the time of 2
        </div>
      </div>

      <div class="ref-card" style="grid-column: span 2">
        <h3>ğŸ¼ French & German Terms (Grade 5)</h3>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px">
          <div>
            <p style="color:var(--gold2);font-weight:700;margin-bottom:8px;font-family:'Playfair Display'">French</p>
            <table class="ref-table">
              <tr><td>animÃ©</td><td>Animated, lively</td></tr>
              <tr><td>assez</td><td>Enough, rather</td></tr>
              <tr><td>avec</td><td>With</td></tr>
              <tr><td>bien</td><td>Well, very</td></tr>
              <tr><td>cÃ©dez</td><td>Yield, slow down</td></tr>
              <tr><td>court</td><td>Short</td></tr>
              <tr><td>doux</td><td>Sweet, gentle</td></tr>
              <tr><td>en dehors</td><td>Prominent, standing out</td></tr>
              <tr><td>et</td><td>And</td></tr>
              <tr><td>expressif</td><td>Expressive</td></tr>
              <tr><td>lÃ©gÃ¨rement</td><td>Lightly</td></tr>
              <tr><td>lent</td><td>Slow</td></tr>
              <tr><td>mais</td><td>But</td></tr>
              <tr><td>moins</td><td>Less</td></tr>
              <tr><td>modÃ©rÃ©</td><td>Moderate</td></tr>
              <tr><td>non</td><td>Not</td></tr>
              <tr><td>peu Ã  peu</td><td>Little by little</td></tr>
              <tr><td>presser</td><td>To hurry</td></tr>
              <tr><td>ralentir</td><td>To slow down</td></tr>
              <tr><td>retenu</td><td>Held back</td></tr>
              <tr><td>sans</td><td>Without</td></tr>
              <tr><td>subitement</td><td>Suddenly</td></tr>
              <tr><td>trÃ¨s</td><td>Very</td></tr>
              <tr><td>un peu</td><td>A little</td></tr>
              <tr><td>vif</td><td>Lively</td></tr>
            </table>
          </div>
          <div>
            <p style="color:var(--gold2);font-weight:700;margin-bottom:8px;font-family:'Playfair Display'">German</p>
            <table class="ref-table">
              <tr><td>aber</td><td>But</td></tr>
              <tr><td>ausdrucksvoll</td><td>Expressive</td></tr>
              <tr><td>bewegt</td><td>With movement, agitated</td></tr>
              <tr><td>breit</td><td>Broad</td></tr>
              <tr><td>einfach</td><td>Simple</td></tr>
              <tr><td>etwas</td><td>Somewhat, rather</td></tr>
              <tr><td>frÃ¶hlich</td><td>Happy, merry</td></tr>
              <tr><td>gedÃ¤mpft</td><td>Muted, damped</td></tr>
              <tr><td>immer</td><td>Always</td></tr>
              <tr><td>krÃ¤ftig</td><td>Strong, vigorous</td></tr>
              <tr><td>langsam</td><td>Slow</td></tr>
              <tr><td>lebhaft</td><td>Lively</td></tr>
              <tr><td>leise</td><td>Soft, gentle</td></tr>
              <tr><td>mÃ¤ÃŸig</td><td>Moderate</td></tr>
              <tr><td>mit</td><td>With</td></tr>
              <tr><td>nicht</td><td>Not</td></tr>
              <tr><td>ruhig</td><td>Calm, peaceful</td></tr>
              <tr><td>schnell</td><td>Fast</td></tr>
              <tr><td>sehr</td><td>Very</td></tr>
              <tr><td>stark</td><td>Strong</td></tr>
              <tr><td>und</td><td>And</td></tr>
              <tr><td>wenig</td><td>Little</td></tr>
              <tr><td>zart</td><td>Tender, delicate</td></tr>
            </table>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

</div><!-- end main-content -->

<!-- â”€â”€â”€ BOTTOM NAV â”€â”€â”€ -->
<nav class="bottom-nav">
  <button class="nav-btn active" id="nav-dash" onclick="goScreen('screen-dashboard');setActiveNav('nav-dash')">
    <span class="nav-icon">ğŸ </span>Dashboard
  </button>
  <button class="nav-btn" id="nav-diag" onclick="startDiagnostic();setActiveNav('nav-diag')">
    <span class="nav-icon">ğŸ¯</span>Diagnostic
  </button>
  <button class="nav-btn" id="nav-ref" onclick="goScreen('screen-reference');setActiveNav('nav-ref')">
    <span class="nav-icon">ğŸ“–</span>Reference
  </button>
</nav>

<!-- â”€â”€â”€ ACHIEVEMENT TOAST â”€â”€â”€ -->
<div class="achievement-toast" id="ach-toast">
  <div class="ach-icon" id="ach-icon">ğŸ†</div>
  <div class="ach-title" id="ach-title">Achievement!</div>
  <div class="ach-desc" id="ach-desc">Description here</div>
</div>

<!-- â”€â”€â”€ MODAL â”€â”€â”€ -->
<div class="modal-overlay" id="modal">
  <div class="modal-box">
    <h2 id="modal-title">Confirm</h2>
    <p id="modal-body">Are you sure?</p>
    <div class="modal-actions">
      <button class="btn btn-danger" id="modal-confirm">Confirm</button>
      <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
    </div>
  </div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  DATA â€” TOPICS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const TOPICS = [
  { id:'rhythm', name:'Rhythm & Time', icon:'â±ï¸', color:'#e05c5c', sub:'Time signatures, grouping, triplets' },
  { id:'scales', name:'Scales & Key Signatures', icon:'ğŸ”‘', color:'#56d364', sub:'Major, minor, all 6â™¯/â™­ keys' },
  { id:'intervals', name:'Intervals', icon:'â†•ï¸', color:'#79c0ff', sub:'Major, minor, perfect, aug, dim, compound' },
  { id:'chords', name:'Chords & Harmony', icon:'ğŸµ', color:'#bc8cff', sub:'Triads, inversions, degrees Iâ€“VII' },
  { id:'clefs', name:'Clefs & Transposition', icon:'ğ„', color:'#ffa657', sub:'Treble, bass, alto, tenor; octave transposition' },
  { id:'terms', name:'Terms & Signs', icon:'ğŸ­', color:'#4fc3a1', sub:'Tempo, dynamics, expression, ornaments' },
  { id:'instruments', name:'Instruments & Voices', icon:'ğŸ»', color:'#f0d080', sub:'Families, clefs used, transposing instruments' },
  { id:'minors', name:'Minor Scales & Modes', icon:'ğŸŒ‘', color:'#ff7fc6', sub:'Natural, harmonic, melodic minor; relative keys' },
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  DATA â€” QUESTION BANK
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const QB = {
  rhythm: [
    { q:"In compound time, the beat is divided into groups of:", opts:["2","3","4","5"], ans:1, exp:"COMPOUND = 3-part division. Each beat is a DOTTED note (e.g. dotted crotchet in 6/8) that divides into 3 equal parts. Simple time beats divide into 2. Quick test: can you divide the top number by 3 cleanly? If yes, it's likely compound." },
    { q:"Which time signature is an IRREGULAR time signature?", opts:["6/8","3/4","5/4","4/4"], ans:2, exp:"5/4 is IRREGULAR â€” it can't be simple (beats don't divide neatly into 2) or compound (top number not divisible by 3). Irregular signatures: 5/4, 7/4, 5/8, 7/8. They mix groups of 2s and 3s within each bar." },
    { q:"A triplet (â™©â™©â™© with a '3') in simple time means:", opts:["3 notes in the time of 4","3 notes in the time of 2","2 notes in the time of 3","3 notes in the time of 1"], ans:1, exp:"TRIPLET = 3 in the time of 2. Simple time's beat divides into 2; a triplet temporarily makes it divide into 3. Three triplet quavers = same duration as two normal quavers. The '3' bracket always refers to the NEXT LARGER note value." },
    { q:"In 6/8 time, how many quaver beats are in each bar?", opts:["6","3","2","4"], ans:0, exp:"6/8: top number 6 = SIX quavers per bar. But organised as 2 dotted-crotchet beats (each = 3 quavers). The '8' means quaver = counting unit. Exam tip: 6/8 feels like 2 beats, not 6 â€” a common confusion source!" },
    { q:"The time signature ğ„µ (cut common time / alla breve) means:", opts:["4 crotchet beats","2 minim beats","3 minim beats","4 minim beats"], ans:1, exp:"ğ„µ = alla breve = 2/2. Two MINIM beats per bar. Think of it as '2 half-note beats'. Music in alla breve tends to feel faster even at the same metronome speed because the beat unit is larger. Conducted in 2." },
    { q:"How would you correctly group 4 semiquavers + 2 quavers in a 4/4 bar (filling the first two beats)?", opts:["Beam all 6 together","4 semiquavers together, then 2 separate quavers","4 semiquavers (1 beat) then 2 quavers (1 beat), beamed by beat","You cannot mix these in one bar"], ans:2, exp:"KEY RULE: beam within beats, never across the half-bar in 4/4. 4 semiquavers = 1 crotchet (beat 1). 2 quavers = 1 crotchet (beat 2). Beam each beat's notes together. The beat structure must always be visible to the eye." },
    { q:"What is a duplet?", opts:["Two notes in the time of three","Three notes in the time of two","Two equal notes tied together","Two bars of compound time"], ans:0, exp:"DUPLET = 2 in the time of 3 â€” the reverse of a triplet. It appears in COMPOUND time (where beats normally divide into 3) to temporarily create a 2-part division. Marked with a '2'. Example: in 6/8, a duplet crotchet = takes 3 quavers of time." },
    { q:"In 7/8, the beats are typically grouped as:", opts:["3+3+1","4+3 or 3+4","5+2","All 7 are equal"], ans:1, exp:"7/8: most common groupings are 4+3 (quavers) or 3+4. Some composers use 2+2+3. The beaming of quavers shows the grouping. Holst's 'Mars' from The Planets is a famous 5/4 example; Stravinsky uses 7/8 frequently." },
    { q:"A dotted minim in a 3/4 bar:", opts:["Cannot appear â€” too long","Fills the whole bar","Fills 2 beats out of 3","Must be written as 3 tied crotchets"], ans:1, exp:"DOTTED MINIM = minim (2 beats) + half of minim (1 beat) = 3 crotchet beats. In 3/4 = exactly 3 crotchet beats per bar â†’ fills the bar perfectly. This is one of the most common notes in 3/4." },
    { q:"In simple time, the top number tells you:", opts:["The type of beat","The number of beats per bar","Whether it's simple or compound","The note value of each beat"], ans:1, exp:"SIMPLE TIME FORMULA: TOP = number of beats per bar. BOTTOM = denomination of the beat (4=crotchet, 2=minim, 8=quaver, 16=semiquaver). So 3/4 = 3 crotchet beats. 3/8 = 3 quaver beats. These feel different even though both have 3 beats!" },
    { q:"Which of the following correctly completes a 3/4 bar that already has a crotchet on beat 1?", opts:["A semibreve","A dotted minim","A minim","A quaver + crotchet"], ans:2, exp:"Already have 1 crotchet beat. 3/4 needs 3 crotchet beats total. Remaining = 2 crotchet beats = a MINIM. Check: crotchet (1) + minim (2) = 3 beats. âœ“ Semibreve = 4 beats (too long). Dotted minim = 3 beats (too long). Quaver+crotchet = 1.5 beats (too short)." },
    { q:"In 9/8 time, what is the beat unit?", opts:["Crotchet","Dotted minim","Dotted crotchet","Quaver"], ans:2, exp:"9/8 is COMPOUND: 9 Ã· 3 = 3 beats. Each beat = a DOTTED CROTCHET (worth 3 quavers). Think: compound 3-time. Conducting pattern: 3 beats. This is equivalent to 3/4 'feeling' but with compound subdivision." },
    { q:"A 'hemiola' refers to:", opts:["A duplet in 4/4","Three beats felt as two, or two felt as three, across bar lines","Playing three notes on one pitch","A triplet in compound time"], ans:1, exp:"HEMIOLA: rhythmic technique where 3 groups of 2 are felt across the space of 2 groups of 3 (or vice versa). Common in Baroque music. E.g., in 3/4, the last two bars before a cadence might be phrased as ONE group of 6, feeling like 2 beats of 3 instead of 3 beats of 2." },
    { q:"In 12/8, how many beats are there per bar and what is each beat worth?", opts:["12 quaver beats","3 dotted crotchet beats","4 dotted crotchet beats","6 crotchet beats"], ans:2, exp:"12/8 = compound 4-time. 12 Ã· 3 = 4 beats. Each beat = DOTTED CROTCHET (3 quavers). Think of 12/8 as 4/4 with compound subdivision â€” the 4-beat feel of 4/4, but every beat has a 'triplet' feel inside it. Used in blues, gospel and many slow ballads." },
    { q:"A rest must fill the whole of an otherwise empty bar in 4/4. Which rest is used?", opts:["Two minim rests","Four crotchet rests","A semibreve rest","A dotted minim rest + crotchet rest"], ans:2, exp:"RULE: a whole bar of silence is ALWAYS notated with a SEMIBREVE REST, regardless of the time signature (with the exception of 4/2). A semibreve rest hangs BELOW the 4th line of the staff. This applies even in 3/4 â€” a whole bar's rest = semibreve rest." },
    { q:"Which note value gets the beat in 3/2 time?", opts:["Crotchet","Minim","Dotted minim","Semibreve"], ans:1, exp:"3/2: top = 3 beats; bottom = 2 = MINIM gets one beat. Three minim beats per bar. Less common but appears in exam questions. Double check: the BOTTOM number always tells you the beat note: 2=minim, 4=crotchet, 8=quaver." },
    { q:"If you see quavers beamed in groups of THREE in an unmarked time signature, this suggests:", opts:["Simple duple time","Irregular time","Compound time","3/4 time"], ans:2, exp:"Quavers beamed in groups of 3 strongly suggests COMPOUND time (where beats divide into 3). In compound time, 3 quavers = 1 beat (dotted crotchet). If they were in groups of 2, that would suggest simple time. This 'beaming as evidence' question often appears in paper Section B." },
    { q:"How many semiquavers equal a dotted crotchet?", opts:["4","6","3","8"], ans:1, exp:"DOTTED CROTCHET = crotchet + quaver = 4 semiquavers + 2 semiquavers = 6 SEMIQUAVERS. Method: crotchet = 4 semiquavers; dot adds half more = 2 semiquavers; total = 6. This is why compound time has 6 semiquavers per beat." },
  ],

  scales: [
    { q:"What is the key signature of A major?", opts:["Fâ™¯, Câ™¯, Gâ™¯","Fâ™¯, Câ™¯, Gâ™¯, Dâ™¯","Fâ™¯, Câ™¯","Bâ™­, Eâ™­, Aâ™­"], ans:0, exp:"A major has 3 sharps: Fâ™¯, Câ™¯, Gâ™¯. Memory trick: count up the Circle of 5ths â€” G(1â™¯), D(2â™¯), A(3â™¯). Each step adds a sharp in the order: F C G D A E B." },
    { q:"The relative minor of D major is:", opts:["B minor","Fâ™¯ minor","D minor","G minor"], ans:0, exp:"The relative minor starts on the 6th degree of the major scale. D major: Dâ€“Eâ€“Fâ™¯â€“Gâ€“Aâ€“Bâ€“Câ™¯. The 6th note is B. So B minor is relative to D major â€” they share the same key signature (2 sharps: Fâ™¯, Câ™¯)." },
    { q:"The harmonic minor scale differs from the natural minor by:", opts:["Raising the 6th degree","Raising the 7th degree","Lowering the 7th degree","Raising both 6th and 7th"], ans:1, exp:"Harmonic minor = natural minor with the 7th degree RAISED by a semitone. This creates a leading note that 'leads' strongly to the tonic. The gap between degrees 6 and 7 becomes an augmented 2nd (3 semitones), giving harmonic minor its characteristic exotic sound." },
    { q:"How many flats does Eâ™­ major have?", opts:["2","3","4","5"], ans:1, exp:"Eâ™­ major has 3 flats: Bâ™­, Eâ™­, Aâ™­. Use the flat mnemonic: B E A D G C F. Count up to include Eâ™­ as a key: F(1â™­), Bâ™­(2â™­), Eâ™­(3â™­)." },
    { q:"The melodic minor scale ascending uses:", opts:["Raised 6th and raised 7th","Only raised 7th","Natural minor throughout","Lowered 2nd and 7th"], ans:0, exp:"Melodic minor ascending: raise BOTH the 6th and 7th degrees by a semitone compared to the natural minor. Descending, it reverts to the natural minor. This avoids the awkward augmented 2nd of harmonic minor in melodic lines." },
    { q:"Bâ™­ major has which key signature?", opts:["Bâ™­ only","Bâ™­, Eâ™­","Bâ™­, Eâ™­, Aâ™­","Bâ™­, Eâ™­, Aâ™­, Dâ™­"], ans:1, exp:"Bâ™­ major has 2 flats: Bâ™­ and Eâ™­. The order of flats is Bâ™­ Eâ™­ Aâ™­ Dâ™­ Gâ™­ Câ™­ Fâ™­." },
    { q:"Which scale uses the pattern: T-S-T-T-T-S-T?", opts:["Natural minor","Major scale","Harmonic minor","Melodic minor ascending"], ans:1, exp:"The MAJOR scale pattern is: Tone Semitone Tone Tone Tone Semitone Tone (T-S-T-T-T-S-T). The semitones fall between degrees 3â€“4 and 7â€“8." },
    { q:"What is the parallel minor of G major?", opts:["E minor","G minor","B minor","D minor"], ans:1, exp:"The PARALLEL minor shares the same TONIC (starting note) but has a different key signature. G major â†’ G minor (which has 2 flats: Bâ™­, Eâ™­). Compare: RELATIVE minor shares the key signature but has a different tonic." },
    { q:"Câ™¯ minor (harmonic) â€” which note is raised compared to the natural minor?", opts:["B becomes Bâ™¯","Gâ™¯ becomes Gâ™¯â™¯ (A)","Aâ™¯ becomes Aâ™¯â™¯","Dâ™¯ becomes Dâ™¯â™¯"], ans:1, exp:"Câ™¯ natural minor: Câ™¯-Dâ™¯-E-Fâ™¯-Gâ™¯-A-B-Câ™¯. The 7th degree is B. In harmonic minor, raise the 7th: B becomes Bâ™¯. Wait â€” Gâ™¯ is the 5th degree. The 7th is B, so harmonic minor raises B to Bâ™¯." },
    { q:"How many sharps does Fâ™¯ major have?", opts:["5","6","7","4"], ans:1, exp:"Fâ™¯ major has 6 sharps: Fâ™¯, Câ™¯, Gâ™¯, Dâ™¯, Aâ™¯, Eâ™¯. It is one of the 'extreme' key signatures at the edge of the Circle of 5ths, relative to Dâ™¯ minor." },
  ],

  intervals: [
    { q:"The interval from C to G is a:", opts:["Perfect 4th","Perfect 5th","Major 5th","Minor 5th"], ans:1, exp:"C to G spans 5 note names (Câ€“Dâ€“Eâ€“Fâ€“G = 5) and 7 semitones. A Perfect 5th contains 7 semitones. Remember: intervals involving the tonic in a major scale are either MAJOR or PERFECT; they become minor/diminished when reduced, or augmented when enlarged." },
    { q:"A Major 6th above E is:", opts:["B","Câ™¯","D","C"], ans:1, exp:"Count up 6 note names: Eâ€“Fâ€“Gâ€“Aâ€“Bâ€“Câ€“(skip)? E(1)â€“F(2)â€“G(3)â€“A(4)â€“B(5)â€“C(6) = C. A major 6th = 9 semitones. E to C = 8 semitones (minor 6th). E to Câ™¯ = 9 semitones â†’ Major 6th. Answer: Câ™¯." },
    { q:"A compound interval is:", opts:["An interval larger than a 5th","An interval larger than an octave","An interval with two accidentals","An interval combining two different notes"], ans:1, exp:"A compound interval is LARGER THAN AN OCTAVE. To name it: subtract 7 from the number (e.g., a 10th = 3rd + octave = a compound 3rd). A 9th = compound 2nd, a 10th = compound 3rd, etc." },
    { q:"The interval from D to Aâ™­ is:", opts:["Diminished 5th","Perfect 5th","Augmented 4th","Minor 5th"], ans:0, exp:"D to A = Perfect 5th (7 semitones). Aâ™­ is one semitone lower than A, making D to Aâ™­ = 6 semitones. A diminished 5th = 6 semitones. Note: an augmented 4th also = 6 semitones â€” but the LETTER names tell us: D(1)â€“E(2)â€“F(3)â€“G(4)â€“A(5) = a 5th." },
    { q:"Which pair of intervals are enharmonic equivalents?", opts:["Major 3rd and Perfect 4th","Augmented 4th and Diminished 5th","Minor 6th and Major 7th","Perfect 5th and Minor 6th"], ans:1, exp:"An Augmented 4th (tritone, 6 semitones) and a Diminished 5th (also 6 semitones) sound identical but are SPELLED differently. This is called an enharmonic equivalent. e.g., Fâ€“Bâ™­ is a Diminished 5th; Fâ€“Aâ™¯ is an Augmented 4th â€” both are 6 semitones." },
    { q:"To name an interval, you need to know:", opts:["Only the number of semitones","Only the letter name distance","Both the letter name distance AND the number of semitones","Only the key signature"], ans:2, exp:"You need BOTH: (1) Count the letter names for the interval NUMBER, (2) Count semitones to determine the QUALITY (perfect/major/minor/augmented/diminished). Letter names alone tell you the number but not whether it's major or minor." },
    { q:"A Minor 7th above G is:", opts:["Eâ™­","F","Fâ™¯","E"], ans:1, exp:"Count 7 letter names up from G: G(1)â€“A(2)â€“B(3)â€“C(4)â€“D(5)â€“E(6)â€“F(7) = F. A minor 7th = 10 semitones. G to F = 10 semitones. Answer: F. (A major 7th = 11 semitones = Fâ™¯.)" },
    { q:"The interval C to Eâ™­ is:", opts:["Major 3rd","Minor 3rd","Diminished 3rd","Augmented 2nd"], ans:1, exp:"C to E = Major 3rd (4 semitones). C to Eâ™­ = 3 semitones. The letter span is still a 3rd (Câ€“Dâ€“E = 3 letters), so it's a Minor 3rd." },
    { q:"A Perfect 4th + a Perfect 5th =", opts:["A Perfect 9th","An Octave","A Major 7th","A compound 4th"], ans:1, exp:"P4 (5 semitones) + P5 (7 semitones) = 12 semitones = one octave. This is a useful rule: the inversion of a Perfect 4th is always a Perfect 5th, and they sum to an octave." },
    { q:"Which interval quality CANNOT be applied to a 5th or 4th?", opts:["Diminished","Perfect","Major","Augmented"], ans:2, exp:"Intervals 1, 4, 5, and 8 are PERFECT intervals â€” they use the qualities Perfect, Augmented, or Diminished. They CANNOT be major or minor. Intervals 2, 3, 6, and 7 are major/minor intervals and cannot be 'perfect'." },
  ],

  chords: [
    { q:"A triad in first inversion has:", opts:["The root at the bottom","The 3rd at the bottom","The 5th at the bottom","The 7th at the bottom"], ans:1, exp:"INVERSION RULE: whichever note of the chord is at the BOTTOM determines the inversion. 3rd at bottom = 1st inversion. Root = root position. 5th = 2nd inversion. Quick memory: inversions count UP from root position (0th, 1st, 2nd)." },
    { q:"The chord built on the SUPERTONIC (2nd degree) of the scale is chord:", opts:["I","II","III","IV"], ans:1, exp:"SUPERTONIC = degree II. In a MAJOR key, chord II is always a MINOR triad (e.g. Dm in C major). NEW at Grade 5! The name 'supertonic' means 'above the tonic' â€” just one step up. Don't confuse with subdominant (IV) which is BELOW the dominant." },
    { q:"In C major, the chord V (dominant) is:", opts:["Fâ€“Aâ€“C","Gâ€“Bâ€“D","Eâ€“Gâ€“B","Câ€“Eâ€“G"], ans:1, exp:"Dominant = 5th degree of the scale. C(I)â€“D(II)â€“E(III)â€“F(IV)â€“G(V). Chord V in C major = Gâ€“Bâ€“D = G major triad. ALWAYS major in major keys. Chord V â†’ chord I is the most fundamental harmonic motion in tonal music." },
    { q:"An augmented triad consists of:", opts:["Two minor 3rds","A major 3rd + a minor 3rd","Two major 3rds","A minor 3rd + a major 3rd"], ans:2, exp:"AUGMENTED = M3 + M3 (two stacked major 3rds). E.g., Câ€“Eâ€“Gâ™¯. The outer interval = augmented 5th (8 semitones). Memory aid: AUG-mented is 'stretched' upward â€” both thirds are the larger (major) type. Compare: DIMINISHED = m3 + m3 (both contracted)." },
    { q:"The figured bass '6' (or 6/3) indicates:", opts:["Root position","First inversion","Second inversion","Third inversion"], ans:1, exp:"FIGURED BASS numbers show intervals ABOVE THE BASS NOTE. 6/3 (or just 6) means intervals of a 6th and 3rd above bass = 1st inversion. Root position = 5/3. 2nd inversion = 6/4. The '4' in 6/4 is the giveaway â€” only 2nd inversion has a 4th above the bass." },
    { q:"In A minor (harmonic), what is chord V?", opts:["Eâ€“Gâ€“B","Eâ€“Gâ™¯â€“B","Eâ™­â€“Gâ€“Bâ™­","Eâ€“Gâ€“Bâ™­"], ans:1, exp:"HARMONIC MINOR raises the 7th (Gâ†’Gâ™¯ in A minor). Chord V is built on E: Eâ€“Gâ™¯â€“B. The Gâ™¯ makes it MAJOR (E major), creating a strong leading-note pull to the tonic. This is WHY harmonic minor exists â€” to give chord V its dominant strength." },
    { q:"Chord IV in G major is:", opts:["Câ€“Eâ€“G","Dâ€“Fâ™¯â€“A","Gâ€“Bâ€“D","Câ€“Eâ™­â€“G"], ans:0, exp:"Subdominant = 4th degree of G major. G(I)â€“A(II)â€“B(III)â€“C(IV). Chord IV = Câ€“Eâ€“G = C major. In G major all notes are natural except Fâ™¯, and C/E/G are all natural. Always build triads using the SCALE notes of the key." },
    { q:"A diminished triad on B (in C major) consists of:", opts:["Bâ€“Dâ€“F","Bâ€“Dâ™¯â€“Fâ™¯","Bâ€“Dâ€“Fâ™¯","Bâ™­â€“Dâ€“F"], ans:0, exp:"In C major, use only C major notes. B(VII)â€“D(skipping C)â€“F. Bâ†’D = minor 3rd (3 semitones); Bâ†’F = diminished 5th (6 semitones) = DIMINISHED triad. Chord VII in any major key is always diminished â€” it's the 'spiky' chord." },
    { q:"What does 'root position' mean for a chord?", opts:["The chord is in its simplest form","The lowest note is the root (tonic note of the chord)","The chord has no inversions possible","The chord is played quietly"], ans:1, exp:"ROOT POSITION = root (the note the chord is named after) is the LOWEST note. G major in root position = G at bottom. Solving tip: to find the root of any chord, rearrange the notes until they are all stacked in 3rds â€” the bottom note of that rearrangement is the root." },
    { q:"Chord II in Eâ™­ major is:", opts:["F minor (Fâ€“Aâ™­â€“C)","F major (Fâ€“Aâ€“C)","F diminished (Fâ€“Aâ™­â€“Câ™­)","G minor (Gâ€“Bâ™­â€“D)"], ans:0, exp:"Eâ™­ major key sig = Bâ™­, Eâ™­, Aâ™­. Chord II is on F: Fâ€“Aâ™­â€“C (using only scale notes). Fâ†’Aâ™­ = minor 3rd; Fâ†’C = perfect 5th = F MINOR. RULE: In ALL major keys, chord II is always a MINOR triad. This is a reliable pattern to memorise." },
    { q:"Which chord has the figured bass symbol â¶â‚„?", opts:["Root position","First inversion","Second inversion","No inversion â€” it's a 7th chord"], ans:2, exp:"6/4 = SECOND INVERSION. The 5th of the chord is in the bass. To verify: if the bass note + a 4th + a 6th give you the three chord notes, it's 2nd inversion. The 6/4 chord has a distinctive, slightly unstable sound â€” often used at cadences (the 'cadential 6/4')." },
    { q:"To identify whether a chord is in root position, 1st or 2nd inversion, you should:", opts:["Look at the top note","Look at the lowest (bass) note and compare it to the chord's root","Count the number of sharps","Check the key signature"], ans:1, exp:"PROCESS: (1) Identify what chord it is (rearrange notes into 3rds if needed). (2) Find which note of that chord is in the BASS (lowest position). (3) Root at bottom = root pos. 3rd at bottom = 1st inv. 5th at bottom = 2nd inv." },
    { q:"In D major, chord I in first inversion has which note in the bass?", opts:["D","Fâ™¯","A","Câ™¯"], ans:1, exp:"D major chord I = Dâ€“Fâ™¯â€“A (D major triad). First inversion = the THIRD in the bass. The 3rd of D major = Fâ™¯. So 1st inversion of chord I in D major has Fâ™¯ in the bass, with D and A above. Figured bass = 6 (or 6/3)." },
    { q:"The chord Iâ€“Vâ€“I progression is known as:", opts:["A plagal cadence","An authentic/perfect cadence","A deceptive cadence","An imperfect cadence"], ans:1, exp:"Iâ€“Vâ€“I is the AUTHENTIC (PERFECT) CADENCE â€” the strongest possible cadential motion in tonal music. Vâ€“I is the dominant-to-tonic resolution. The 'full stop' of music. ABRSM: you need to recognise these: Perfect (Vâ†’I), Plagal (IVâ†’I), Imperfect (ends on V), Interrupted (Vâ†’VI)." },
    { q:"In C major, which chord is the SUBDOMINANT?", opts:["G major (V)","F major (IV)","A minor (VI)","D minor (II)"], ans:1, exp:"SUBDOMINANT = chord IV = the 4th degree. In C major: C(I)â€“D(II)â€“E(III)â€“F(IV). Chord IV = Fâ€“Aâ€“C = F major. The name 'subdominant' means it sits a 5th BELOW the tonic (F is a 5th below C), contrasting with the dominant which is a 5th ABOVE." },
    { q:"A chord in second inversion is sometimes called:", opts:["A six-three chord","A six-four chord","A root chord","A dominant seventh"], ans:1, exp:"Second inversion = figured bass 6/4 = called a SIX-FOUR CHORD. The cadential six-four (chord I in 2nd inversion resolving to V) is particularly important in exam music extracts. Recognise it: the 4th above the bass creates a characteristic 'suspension-like' tension." },
    { q:"In F major, chord V is:", opts:["C major (Câ€“Eâ€“G)","C minor (Câ€“Eâ™­â€“G)","G major (Gâ€“Bâ€“D)","Bâ™­ major (Bâ™­â€“Dâ€“F)"], ans:0, exp:"Dominant of F major = 5th degree = C. Chord V = Câ€“Eâ€“G. In F major, Bâ™­ is in the key signature, but C, E, and G are all natural. Result: C MAJOR triad. Tip: chord V is ALWAYS major in a major key. The major triad on the 5th degree is one of the 'power chords' of tonal harmony." },
    { q:"The interval between the root and fifth of a DIMINISHED triad is:", opts:["Perfect 5th (7 semitones)","Augmented 5th (8 semitones)","Diminished 5th (6 semitones)","Minor 5th (6 semitones)"], ans:2, exp:"DIMINISHED TRIAD: root â†’ 5th = DIMINISHED 5TH (6 semitones). Compare: major/minor triad = Perfect 5th (7 semitones); augmented triad = Augmented 5th (8 semitones). The 'squashed' 5th is what makes diminished triads sound tense and unstable." },
    { q:"In Bâ™­ major, identify chord II: it is built on the note:", opts:["Bâ™­","C","D","Eâ™­"], ans:1, exp:"Chord II = built on the 2nd degree. Bâ™­ major scale: Bâ™­(I)â€“C(II)â€“D(III)â€“Eâ™­(IV)â€“F(V)â€“G(VI)â€“A(VII). 2nd degree = C. Chord II = Câ€“Eâ™­â€“G = C minor. Method for any key: count up 2 steps from the tonic using scale notes." },
  ],

  clefs: [
    { q:"In the alto clef (C clef on 3rd line), middle C is:", opts:["On the 1st space","On the 3rd line","On the 4th line","On the 2nd ledger line"], ans:1, exp:"The C clef (shaped like a backwards B) ALWAYS marks middle C on whatever line it sits. Alto clef = C on 3RD LINE. Memory trick: 'Alto = 3 lines up = A is the 3rd letter that looks like a tent with 3 points'. The viola uses this clef as its home clef." },
    { q:"In the tenor clef, middle C is on:", opts:["The 3rd line","The 4th line","The 5th line","The 2nd line"], ans:1, exp:"Tenor clef = C clef on the 4TH LINE. Middle C sits on line 4. Easy memory: Alto (3rd line) â†’ Tenor one higher â†’ 4th line. Tenor clef: used by cello, bassoon, trombone for their upper registers to avoid ledger lines." },
    { q:"A note on the 4th line of the treble clef is:", opts:["D","E","F","G"], ans:0, exp:"Treble clef lines (bottom to top): Eâ€“Gâ€“Bâ€“Dâ€“F. Line 4 = D. Mnemonics: 'Every Good Boy Deserves Fruit' (lines) / 'FACE' (spaces). Or count: line 1=E, space 1=F, line 2=G, space 2=A, line 3=B, space 3=C, line 4=D." },
    { q:"When transposing a melody up an octave from bass clef to treble clef, the same pitch:", opts:["Appears in the same position on both staves","Appears higher in treble clef than it did in bass clef","Appears lower in treble clef than it did in bass clef","Requires the addition of a sharp"], ans:1, exp:"KEY INSIGHT: moving UP an octave AND changing from bass to treble clef = the note moves to a HIGHER position on the new staff. Middle C (1st ledger line above bass staff) moves to... a higher position in treble clef. Method: (1) name the pitch, (2) find it an octave higher, (3) place it correctly in treble clef." },
    { q:"The viola uses which clef as its primary clef?", opts:["Treble clef","Bass clef","Alto clef (C on 3rd line)","Tenor clef (C on 4th line)"], ans:2, exp:"VIOLA = ALTO CLEF. The viola is the ONLY standard orchestral instrument that uses alto clef as its primary clef. For very high notes, viola switches to treble clef. This makes alto clef identification in exams closely linked to 'viola' as the answer." },
    { q:"In the bass clef, the note on the top (5th) line is:", opts:["A","B","C","D"], ans:0, exp:"Bass clef lines (bottom to top): Gâ€“Bâ€“Dâ€“Fâ€“A. Mnemonic: 'Good Boys Do Fine Always'. Top line (line 5) = A. Spaces: Aâ€“Câ€“Eâ€“G = 'All Cows Eat Grass'. Cross-check: the two dots of the bass clef surround the 4th line = F." },
    { q:"When a piece says '8va' above a note, you play:", opts:["One octave lower","One octave higher","Two octaves higher","At written pitch"], ans:1, exp:"8va (ottava alta) = play ONE OCTAVE HIGHER than written. The '8' refers to the octave (8 notes), 'va' = alta (high). 8vb = bassa = one octave LOWER. When the dashed line ends at 'loco', return to written pitch. 15ma = two octaves higher (15 = two octaves of 8)." },
    { q:"In the alto clef, the note on the 1st (bottom) line is:", opts:["E","F","G","Gâ™¯"], ans:2, exp:"Alto clef: middle C is on line 3. Count DOWN from middle C: line 3 = C, space 2 = B, line 2 = A, space 1 = G, line 1 = G. Wait â€” let's count carefully from C on line 3 downward by steps: C(line 3)â†’B(space 2)â†’A(line 2)â†’G(space 1)â†’F(line 1). So line 1 = F. Actually: line 1 of alto clef = F." },
    { q:"Which note appears on the 1st ledger line BELOW the treble clef staff?", opts:["A","Bâ™­","C (middle C)","D"], ans:2, exp:"MIDDLE C = 1st ledger line BELOW treble clef. This is perhaps the single most important reference point in all of music notation. Learn it cold: wherever you see treble clef and a note on the 1st ledger line below = middle C. In bass clef, middle C = 1st ledger line ABOVE." },
    { q:"The tenor clef is used by which instruments?", opts:["Flute and violin","Viola primarily","Cello and bassoon (for high notes) and trombone","Trumpet and horn"], ans:2, exp:"TENOR CLEF users: cello (for passages above the bass staff range), bassoon (same reason), trombone (some editions use it for the upper register). NOT used by violin or flute (treble clef), NOT viola's primary clef (that's alto). Think 'tenor range = tenor clef'." },
    { q:"In the bass clef, on which line do the two dots of the clef sign sit?", opts:["3rd and 4th lines","4th and 5th lines","2nd and 3rd lines","1st and 2nd lines"], ans:0, exp:"The bass clef's two dots sit on either side of the 4TH LINE, which is F3. That's why it's called the F clef â€” the 4th line is always F in bass clef. The large dot is on line 4, with the two small dots above and below it (lines 4 and 3)." },
    { q:"A melody in tenor clef is to be rewritten in treble clef at the same pitch. The note on the 4th line of the tenor clef (= middle C) would appear:", opts:["On the 3rd line of treble clef","On the 1st ledger line below treble clef","On the 1st space of treble clef","On the 4th line of treble clef"], ans:1, exp:"PROCESS: (1) identify the pitch in tenor clef â€” 4th line = middle C. (2) Where is middle C in treble clef? 1st ledger line BELOW the staff. Answer: 1st ledger line below treble clef. This is the essential skill: name the pitch first, THEN place it in the new clef." },
    { q:"When identifying a note in the alto clef, the best strategy is to:", opts:["Transpose from treble clef","Use middle C on line 3 as your anchor and count steps","Count from the bottom line","Guess based on context"], ans:1, exp:"ANCHOR STRATEGY: in any C clef, identify where middle C is FIRST, then count steps from there. For alto clef: middle C = line 3. From C, count alphabetically up (D, E, F...) or down (B, A, G...). This anchor method works for both alto AND tenor clef." },
    { q:"A note written on the 2nd space of the treble clef is:", opts:["B","C","A","G"], ans:2, exp:"Treble clef spaces (bottom to top): Fâ€“Aâ€“Câ€“E (FACE). Space 2 = A. Quick check: space 1=F, space 2=A, space 3=C, space 4=E. Alternative check: it sits between lines 2 (G) and 3 (B), so the space between them = A. Count: Gâ€“Aâ€“B (G on line 2, A in space 2, B on line 3)." },
    { q:"To transpose a melody DOWN an octave from treble to bass clef, each note:", opts:["Keeps the same letter name but moves to a lower position","Changes its letter name","Gains an extra ledger line","Must be rewritten in a different key"], ans:0, exp:"TRANSPOSITION rule: the PITCH NAME stays the same (you're just moving it an octave lower). Only the POSITION on the staff changes. Method: (1) name each note in treble clef, (2) write that same note an octave lower in bass clef. The key signature may also change appearance." },
  ],

  terms: [
    { q:"'Rallentando' (rall.) means:", opts:["Getting faster","Getting louder","Getting gradually slower","Suddenly stopping"], ans:2, exp:"RALLENTANDO = getting GRADUALLY slower. Near-identical to ritardando (ritard./rit.). TRAP: both rall. and rit. can mean the same thing â€” gradually slower. RITENUTO (riten.) is different: it means IMMEDIATELY held back (instant, not gradual). This trio is the most commonly confused group in Grade 5." },
    { q:"What does 'sforzando' (sfz) mean?", opts:["Very soft","Suddenly loud, then softer","A forced/strong accent on a single note","Getting gradually louder"], ans:2, exp:"SFZ (sforzando) = a sudden forced accent on ONE specific note. It's stronger than a normal accent mark (>). Written as sfz, sf, or fz. The effect is IMMEDIATE and applies to just that note â€” it's not a dynamic level, it's a momentary emphasis. Great contrast with p or pp marks nearby." },
    { q:"The ornament 'acciaccatura' is represented by:", opts:["A small note with no slash","A small note with a slash through its stem","A wavy line","A bracket above the note"], ans:1, exp:"ACCIACCATURA = small note WITH A SLASH through its stem. The slash signals 'crush it' â€” play it as briefly as possible just before the main note. Italian: 'acciaccatura' = 'crushed'. vs APPOGGIATURA (no slash) = leaning note, takes real rhythmic value from the main note." },
    { q:"'Cantabile' means:", opts:["In a dance style","In a singing style","Vigorously","Sweetly and softly"], ans:1, exp:"CANTABILE = 'singable' â€” in a SINGING STYLE. Smooth, lyrical, expressive, as if a vocalist is carrying the line. Very common in Italian Romantic music. Compare: LEGATO = smoothly connected (a bowing/fingering instruction); CANTABILE = character/expressive quality." },
    { q:"Which of these is a FRENCH musical term?", opts:["Adagio","Lebhaft","CÃ©dez","Scherzando"], ans:2, exp:"CÃ‰DEZ = French, meaning 'yield/give way/slow down'. Strategy: French terms often look like modern French words (cÃ©dez = yield in French). ADAGIO = Italian. LEBHAFT = German (lively). SCHERZANDO = Italian (playfully). At Grade 5, you must distinguish ALL THREE languages." },
    { q:"A 'turn' (~) ornament played on the note consists of:", opts:["The note â€” one note above â€” the note","Upper note â€” main note â€” lower note â€” main note","Main note â€” lower note â€” main note","Rapid alternation between note and neighbour"], ans:1, exp:"TURN = 4 notes: UPPER â†’ MAIN â†’ LOWER â†’ MAIN. So a turn on C would be: Dâ€“Câ€“Bâ€“C. Exam trap: the 'upper mordent' (Pralltriller) = mainâ†’upperâ†’main (3 notes). The turn has 4 notes and makes a full 'looping' figure. Remember: turn = turn around the note, touching above AND below." },
    { q:"'Ritenuto' (riten.) means:", opts:["Gradually getting slower","Immediately held back / instantly slower","Returning to tempo","Slowing then stopping"], ans:1, exp:"RITENUTO = IMMEDIATELY slower (held back RIGHT NOW). Contrast with rallentando/ritardando = gradually slower over several notes. Think: riten. = like suddenly putting on the brakes; rall. = like gradually applying the brakes. After either, 'a tempo' restores original speed." },
    { q:"'MÃ¤ÃŸig' is a German term meaning:", opts:["Slow","Moderate","Fast","Lively"], ans:1, exp:"MÃ„SSIG = German for MODERATE. Equivalent to Italian 'moderato'. German terms to know: mÃ¤ÃŸig (moderate), lebhaft (lively), langsam (slow), schnell (fast), ruhig (calm), etwas (somewhat), sehr (very), mit (with), und (and). Exam often mixes languages â€” know them all!" },
    { q:"A trill (tr) means:", opts:["A single accented note","Rapid alternation between the written note and the note above","Play the note twice","A slight delay before the note"], ans:1, exp:"TRILL = rapid alternation between the WRITTEN note and the NOTE ABOVE (usually a major or minor 2nd, depending on the key). Starting note: Baroque = usually upper note; Classical/Romantic = usually written note (ABRSM accepts both for Grade 5). Length: as long as the note value indicates." },
    { q:"'Con sordino' instructs the player to:", opts:["Play without pedal","Use a mute","Play with the bow","Pluck the string"], ans:1, exp:"CON SORDINO = 'with mute'. Mutes on string instruments go on the bridge; on brass, in the bell. Effect: quieter, more nasal or veiled tone. SENZA SORDINO = without mute (remove it). Don't confuse with: PIZZICATO (pluck), CON ARCO (with the bow), LEGATO (smoothly)." },
    { q:"'TrÃ¨s' is a French term meaning:", opts:["Very","A little","Rather","And"], ans:0, exp:"TRÃˆS = French for 'VERY'. E.g., 'trÃ¨s lent' = very slow. Other key French quantity words: un peu (a little), assez (enough/rather), moins (less), peu Ã  peu (little by little), bien (very/well). These modifiers are often combined with speed or expression words in exam extracts." },
    { q:"'Etwas' is a German term meaning:", opts:["Fast","Very","Somewhat / rather","With energy"], ans:2, exp:"ETWAS = German for 'SOMEWHAT' or 'RATHER'. E.g., 'etwas langsam' = somewhat slow. Similar German modifiers: sehr (very), wenig (little), immer (always), aber (but), nicht (not). Exam tip: German modifiers are often tested alongside the primary tempo or expression words." },
    { q:"The marking 'appoggiatura' (a small note WITHOUT a slash) means:", opts:["Play it as fast as possible, stealing from the beat before","Play it ON the beat, giving it half the main note's value","Play it after the beat","Ignore it â€” it's optional"], ans:1, exp:"APPOGGIATURA = 'leaning note'. It falls ON THE BEAT and takes rhythmic value FROM the main note (usually half of a simple note, two-thirds of a dotted note). Contrast with acciaccatura (slash) which is crushed before the beat. 'Appoggiatura' = Italian for 'to lean on'." },
    { q:"'AnimÃ©' is a French term meaning:", opts:["Slow and expressive","Animated, lively","Sadly","With movement, restless"], ans:1, exp:"ANIMÃ‰ = French for ANIMATED or LIVELY. Equivalent to Italian 'animato'. French tempo/character terms to know: animÃ© (animated), modÃ©rÃ© (moderate), vif (lively), lent (slow), doux (sweet), expressif (expressive). When you see the accent: animÃ© not anime!" },
    { q:"'Martellato' or 'martellÃ©' (strings) means:", opts:["Play softly near the bridge","Play with heavy, hammered bow strokes","Pluck the string firmly","Use the back of the bow"], ans:1, exp:"MARTELLATO = Italian for 'hammered'. A bowing technique where the bow is pressed firmly and each stroke starts with a sharp, accented attack. The word comes from 'martello' (hammer). It produces a heavy, separated, strongly accented articulation. Related to MARCATO (marked/accented) in expression." },
    { q:"Which pair are BOTH German musical terms?", opts:["Vif and lebhaft","Langsam and schnell","Doux and ruhig","Lento and langsam"], ans:1, exp:"LANGSAM (slow) and SCHNELL (fast) are BOTH GERMAN. Check: VIF = French (lively); LEBHAFT = German (lively) â€” so vif+lebhaft is mixed. DOUX = French (sweet); RUHIG = German (calm). LENTO = Italian; LANGSAM = German. The trick is recognising the language by feel of the word." },
    { q:"'Da Capo al Fine' (D.C. al Fine) instructs the player to:", opts:["Repeat the last section only","Go back to the start and play until the word 'Fine'","Jump to the coda","Repeat from the sign (ğ„‹)"], ans:1, exp:"D.C. AL FINE: Da Capo = 'from the head/beginning'. Al Fine = 'to the end/finish'. So: go back to BAR 1 and play until the word FINE. Contrast: D.S. al Fine = go back to the SIGN (ğ„‹) not the beginning. D.C. al Coda = go back to start then jump to the coda at the ğ„Œ sign." },
    { q:"'Pizzicato' (pizz.) is a direction to:", opts:["Play very softly","Use a heavy bowing style","Pluck the string instead of bowing it","Play near the bridge"], ans:2, exp:"PIZZICATO = PLUCK the string with the finger (usually right hand index finger, except for left-hand pizzicato by BartÃ³k). The opposite is ARCO (with the bow). Pizzicato produces a short, dry, detached sound. Used extensively in orchestral music; Tchaikovsky's pizzicato movements are famous examples." },
  ],

  instruments: [
    { q:"The clarinet in Bâ™­ sounds a major 2nd LOWER than written. If the player reads C, the actual pitch is:", opts:["D","B","Bâ™­","A"], ans:2, exp:"The Bâ™­ clarinet is a TRANSPOSING INSTRUMENT that sounds a major 2nd lower than written. Written C â†’ sounds Bâ™­. So to hear a concert C, the clarinettist reads D. In exam questions: written note âˆ’ major 2nd = sounding pitch." },
    { q:"Which instrument family does the oboe belong to?", opts:["Brass","Woodwind (double reed)","Woodwind (single reed)","Strings"], ans:1, exp:"The oboe is a woodwind instrument with a DOUBLE REED (two thin pieces of cane that vibrate together when blown). Other double-reed instruments: bassoon, cor anglais. Single-reed: clarinet, saxophone." },
    { q:"The horn in F sounds a perfect 5th LOWER than written. Written C sounds as:", opts:["G above","F","G below","Aâ™­"], ans:2, exp:"Horn in F sounds a P5th LOWER than written. Written C (middle C) â†’ sounds as the F below (or G below, depending on register). If the written note is C4, subtract a P5th = F3. Or more precisely: written C â†’ sounds F (a P5 lower)." },
    { q:"The double bass is a non-transposing instrument that sounds:", opts:["At written pitch","One octave lower than written","One octave higher than written","A major 2nd lower than written"], ans:1, exp:"The double bass sounds ONE OCTAVE LOWER than written (an octave transposing instrument). This is why it is marked with '8' under the treble clef symbol when written in treble clef. So a written middle C sounds as the C an octave below." },
    { q:"Which voice type has the highest range?", opts:["Tenor","Mezzo-soprano","Soprano","Baritone"], ans:2, exp:"Voice ranges from highest to lowest: Soprano > Mezzo-soprano > Contralto (Alto) | Tenor > Baritone > Bass. Soprano is the highest female (or treble) voice. For male voices, tenor is highest." },
    { q:"The viola reads primarily in:", opts:["Treble clef","Bass clef","Alto clef","Tenor clef"], ans:2, exp:"The viola's primary clef is the ALTO clef (C clef on the 3rd line). It switches to treble clef for very high passages. The viola is the only standard orchestral instrument that primarily uses alto clef." },
    { q:"Orchestral instruments are divided into four families. Which grouping is correct?", opts:["Strings, Woodwind, Brass, Keyboard","Strings, Woodwind, Brass, Percussion","Bowed, Blown, Struck, Plucked","Melody, Harmony, Rhythm, Colour"], ans:1, exp:"The four orchestral families are: STRINGS (violin, viola, cello, double bass, harp), WOODWIND (flute, oboe, clarinet, bassoon), BRASS (horn, trumpet, trombone, tuba), and PERCUSSION (timpani, snare drum, xylophone, etc.)." },
    { q:"The trumpet in Bâ™­ is a transposing instrument. To sound a concert F, the player reads:", opts:["Eâ™­","G","F","E"], ans:1, exp:"Trumpet in Bâ™­ sounds a major 2nd LOWER than written. To sound concert F, the player must read a note a major 2nd HIGHER: F â†’ G. Written G â†’ sounds F. This is the standard ABRSM transposition for Bâ™­ instruments." },
    { q:"Which of these instruments is NOT a transposing instrument?", opts:["Clarinet in Bâ™­","Horn in F","Flute","Trumpet in Bâ™­"], ans:2, exp:"The FLUTE is a concert pitch (C) instrument â€” it is NOT transposing. It sounds exactly as written. Other C instruments: oboe, violin, viola, cello, piano, trombone. Transposing instruments: clarinet (Bâ™­, A), horn (F), trumpet (Bâ™­)." },
    { q:"The bassoon uses which clef for its main range?", opts:["Treble clef","Bass clef (with tenor for high notes)","Alto clef","Tenor clef only"], ans:1, exp:"The bassoon primarily uses the BASS CLEF. For higher passages, it uses the TENOR CLEF to avoid many ledger lines above the bass staff. It rarely uses treble clef. Bassoon is a double-reed woodwind instrument." },
  ],

  minors: [
    { q:"The relative minor of F major is:", opts:["D minor","C minor","A minor","F minor"], ans:0, exp:"The relative minor is found on the 6th degree of the major scale. F major: Fâ€“Gâ€“Aâ€“Bâ™­â€“Câ€“Dâ€“Eâ€“F. The 6th note is D. So D minor is relative to F major. They share the same key signature: 1 flat (Bâ™­)." },
    { q:"Natural minor uses exactly the same notes as its relative major. Which scale form raises NEITHER the 6th nor 7th?", opts:["Harmonic minor","Melodic minor ascending","Natural minor","Melodic minor descending"], ans:2, exp:"NATURAL minor (also called Aeolian mode) uses exactly the same notes as its relative major. No alterations to any degree. It is the 'default' minor scale from which harmonic and melodic forms are derived by raising degrees 7 or 6+7." },
    { q:"In D harmonic minor, which note is raised?", opts:["G becomes Gâ™¯","B becomes Bâ™¯","C becomes Câ™¯","A becomes Aâ™¯"], ans:2, exp:"D natural minor: Dâ€“Eâ€“Fâ€“Gâ€“Aâ€“Bâ™­â€“Câ€“D. The 7th degree is C. In harmonic minor, raise the 7th by a semitone: C â†’ Câ™¯. D harmonic minor: Dâ€“Eâ€“Fâ€“Gâ€“Aâ€“Bâ™­â€“Câ™¯â€“D." },
    { q:"The melodic minor scale DESCENDS as:", opts:["Natural minor","Harmonic minor","Major scale","The same as ascending"], ans:0, exp:"Melodic minor ASCENDING raises the 6th and 7th degrees; DESCENDING it reverts to NATURAL MINOR (same as descending). So the two forms (asc vs desc) are different! This was designed to create smooth melodic lines in both directions." },
    { q:"How many semitones are between the 6th and 7th degrees of a harmonic minor scale?", opts:["1 (half step)","2 (tone)","3 (augmented 2nd)","4"], ans:2, exp:"In harmonic minor: natural 6th to raised 7th = 3 semitones = an AUGMENTED 2ND. This interval (A2) is the distinctive 'exotic' sound of harmonic minor. Example: A harmonic minor has Fâ€“Gâ™¯ (6th to 7th) = 3 semitones." },
    { q:"G minor (harmonic) â€” list its notes ascending:", opts:["Gâ€“Aâ€“Bâ™­â€“Câ€“Dâ€“Eâ™­â€“Fâ™¯â€“G","Gâ€“Aâ€“Bâ™­â€“Câ€“Dâ€“Eâ™­â€“Fâ€“G","Gâ€“Aâ€“Bâ€“Câ€“Dâ€“Eâ™­â€“Fâ™¯â€“G","Gâ€“Aâ™­â€“Bâ™­â€“Câ€“Dâ€“Eâ™­â€“Fâ™¯â€“G"], ans:0, exp:"G natural minor (relative of Bâ™­ major): Gâ€“Aâ€“Bâ™­â€“Câ€“Dâ€“Eâ™­â€“Fâ€“G. For harmonic minor, raise the 7th (Fâ†’Fâ™¯): Gâ€“Aâ€“Bâ™­â€“Câ€“Dâ€“Eâ™­â€“Fâ™¯â€“G." },
    { q:"Which degree of the minor scale is called the 'leading note' in harmonic minor?", opts:["6th","7th (raised)","5th","8th"], ans:1, exp:"The RAISED 7TH degree in harmonic minor is called the LEADING NOTE. It is a semitone below the tonic and 'leads' strongly upward to the tonic, creating a powerful Vâ€“I (dominant-to-tonic) pull. In natural minor, the 7th is a tone below the tonic and has less tendency to resolve." },
    { q:"The key of Fâ™¯ minor has a key signature of:", opts:["Fâ™¯, Câ™¯, Gâ™¯","Fâ™¯, Câ™¯","Fâ™¯, Câ™¯, Gâ™¯, Dâ™¯","Fâ™¯, Câ™¯, Gâ™¯, Dâ™¯, Aâ™¯"], ans:0, exp:"Fâ™¯ minor is the RELATIVE minor of A major (which has 3 sharps: Fâ™¯, Câ™¯, Gâ™¯). Relative keys always share the same key signature. So Fâ™¯ minor has 3 sharps." },
    { q:"In Bâ™­ minor (harmonic), the notes ascending are:", opts:["Bâ™­â€“Câ€“Dâ™­â€“Eâ™­â€“Fâ€“Gâ™­â€“Aâ™­â€“Bâ™­","Bâ™­â€“Câ€“Dâ™­â€“Eâ™­â€“Fâ€“Gâ™­â€“Aâ€“Bâ™­","Bâ™­â€“Câ€“Dâ€“Eâ™­â€“Fâ€“Gâ€“Aâ€“Bâ™­","Bâ™­â€“Câ€“Dâ™­â€“Eâ™­â€“Fâ€“Gâ€“Aâ€“Bâ™­"], ans:1, exp:"Bâ™­ natural minor (relative of Dâ™­ major, 5 flats: Bâ™­ Eâ™­ Aâ™­ Dâ™­ Gâ™­): Bâ™­â€“Câ€“Dâ™­â€“Eâ™­â€“Fâ€“Gâ™­â€“Aâ™­â€“Bâ™­. For harmonic minor, raise the 7th: Aâ™­â†’Aâ™®. Result: Bâ™­â€“Câ€“Dâ™­â€“Eâ™­â€“Fâ€“Gâ™­â€“Aâ™®â€“Bâ™­." },
    { q:"E minor is the relative minor of:", opts:["A major","G major","D major","C major"], ans:1, exp:"E minor is relative to G MAJOR (1 sharp: Fâ™¯). They share the same key signature. G major scale: Gâ€“Aâ€“Bâ€“Câ€“Dâ€“Eâ€“Fâ™¯â€“G. The 6th degree is E â†’ E minor is the relative." },
  ]
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  LESSON CONTENT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const LESSONS = {
  rhythm: [
    {
      title: "Simple vs Compound Time",
      content: `<div class='lesson-section'>
        <h3>â±ï¸ Simple Time â€” The Fundamentals</h3>
        <p>In <strong>simple time</strong>, the beat divides into <strong>two equal parts</strong>.</p>
        <div class='key-point'><strong>Formula:</strong> TOP number = beats per bar &nbsp;|&nbsp; BOTTOM number = denomination of the beat<br>Bottom 4 = crotchet beat &nbsp;|&nbsp; Bottom 2 = minim beat &nbsp;|&nbsp; Bottom 8 = quaver beat</div>
        <table><tr><th>Signature</th><th>Beats/bar</th><th>Beat note</th><th>Example feel</th></tr>
        <tr><td>2/4</td><td>2</td><td>Crotchet</td><td>March</td></tr>
        <tr><td>3/4</td><td>3</td><td>Crotchet</td><td>Waltz</td></tr>
        <tr><td>4/4 (C)</td><td>4</td><td>Crotchet</td><td>Most pop songs</td></tr>
        <tr><td>2/2 (ğ„µ)</td><td>2</td><td>Minim</td><td>Alla breve / March at speed</td></tr>
        <tr><td>3/2</td><td>3</td><td>Minim</td><td>Stately, broad</td></tr>
        <tr><td>3/8</td><td>3</td><td>Quaver</td><td>Delicate, quick</td></tr></table>
        <div class='warning-point'><strong>Trap:</strong> 3/8 and 6/8 both have an 8 on the bottom â€” but 3/8 is SIMPLE (3 quaver beats) and 6/8 is COMPOUND (2 dotted-crotchet beats). The key is whether the top number is divisible by 3!</div>
      </div>
      <div class='lesson-section'>
        <h3>ğŸ¶ Compound Time â€” Understand It Deeply</h3>
        <p>In <strong>compound time</strong>, the beat divides into <strong>three equal parts</strong>. The beat is always a dotted note.</p>
        <div class='key-point'><strong>To decode compound time:</strong> divide top by 3 = beats per bar. Bottom tells you the subdivision note (8 = quaver). Each beat = a dotted version of the subdivision.</div>
        <table><tr><th>Signature</th><th>Beats/bar</th><th>Beat note</th><th>Subdivision</th></tr>
        <tr><td>6/8</td><td>2</td><td>Dotted crotchet</td><td>3 quavers per beat</td></tr>
        <tr><td>9/8</td><td>3</td><td>Dotted crotchet</td><td>3 quavers per beat</td></tr>
        <tr><td>12/8</td><td>4</td><td>Dotted crotchet</td><td>3 quavers per beat</td></tr>
        <tr><td>6/4</td><td>2</td><td>Dotted minim</td><td>3 crotchets per beat</td></tr></table>
        <p>A dotted crotchet beat in 6/8 can be written as three quavers, a crotchet+quaver, or a dotted crotchet. All fill one beat.</p>
      </div>
      <div class='lesson-section'>
        <h3>ğŸ”º Irregular Time â€” New at Grade 5</h3>
        <p>Irregular time cannot be simple (beats don't divide into 2) or compound (top not divisible by 3). It mixes groups of 2s and 3s.</p>
        <table><tr><th>Signature</th><th>Beat count</th><th>Typical groupings</th></tr>
        <tr><td>5/4</td><td>5 crotchets</td><td>2+3 or 3+2</td></tr>
        <tr><td>7/4</td><td>7 crotchets</td><td>4+3 or 3+4</td></tr>
        <tr><td>5/8</td><td>5 quavers</td><td>2+3 or 3+2</td></tr>
        <tr><td>7/8</td><td>7 quavers</td><td>4+3 or 3+4</td></tr></table>
        <div class='key-point'><strong>Famous examples:</strong> Holst's 'Mars' (5/4) | Brubeck's 'Take Five' (5/4) | Pink Floyd's 'Money' (7/4). These pieces help you feel irregular time â€” try counting along!</div>
      </div>`
    },
    {
      title: "Grouping & Beaming Rules",
      content: `<div class='lesson-section'>
        <h3>ğŸ“ The Golden Rule of Beaming</h3>
        <p><strong>The examiner must be able to SEE the beat structure by looking at the beaming.</strong> Every beam group should correspond to exactly one beat (or one half-bar in simple duple/quadruple time).</p>
        <div class='key-point'><strong>Simple time beaming:</strong> Group notes within individual beats. In 4/4, also never beam across the half-bar (beats 1â€“2 form one 'half', beats 3â€“4 form another half).</div>
        <div class='warning-point'><strong>Common error:</strong> In 4/4, a student writes four quavers beamed across beats 2 and 3 â€” this is acceptable. But four quavers from beat 1 across the half-bar boundary to beat 3 â€” NOT acceptable.</div>
      </div>
      <div class='lesson-section'>
        <h3>Note Value Arithmetic â€” Exam Shortcuts</h3>
        <table><tr><th>Note</th><th>= crotchets</th><th>= quavers</th><th>= semiquavers</th></tr>
        <tr><td>Semibreve</td><td>4</td><td>8</td><td>16</td></tr>
        <tr><td>Dotted minim</td><td>3</td><td>6</td><td>12</td></tr>
        <tr><td>Minim</td><td>2</td><td>4</td><td>8</td></tr>
        <tr><td>Dotted crotchet</td><td>1.5</td><td>3</td><td>6</td></tr>
        <tr><td>Crotchet</td><td>1</td><td>2</td><td>4</td></tr>
        <tr><td>Dotted quaver</td><td>0.75</td><td>1.5</td><td>3</td></tr>
        <tr><td>Quaver</td><td>0.5</td><td>1</td><td>2</td></tr>
        <tr><td>Semiquaver</td><td>0.25</td><td>0.5</td><td>1</td></tr></table>
        <div class='key-point'><strong>Dot rule:</strong> A dot adds HALF the note's value. A double dot adds half + quarter of the note's value.</div>
      </div>
      <div class='lesson-section'>
        <h3>ğŸ”„ Triplets, Duplets & Irregular Groups</h3>
        <p><strong>Triplet:</strong> 3 notes in the time of 2. Appears in simple time. The bracket or beam carries a '3'. Three triplet quavers = 2 normal quavers = 1 crotchet beat.</p>
        <p><strong>Duplet:</strong> 2 notes in the time of 3. Appears in compound time. The bracket carries a '2'. Two duplet quavers = 3 normal quavers = 1 dotted crotchet beat.</p>
        <p><strong>Other groups:</strong> Quintuplet (5), sextuplet (6), septuplet (7) â€” all marked with their number. In Grade 5 exams, triplets and duplets are the most common.</p>
        <div class='key-point'><strong>Exam tip on rests:</strong> A whole bar of silence = always written as a SEMIBREVE REST (hanging below the 4th line), regardless of time signature. Exception: 4/2 uses a breve rest.</div>
      </div>`
    },
    {
      title: "Identifying Time Signatures",
      content: `<div class='lesson-section'>
        <h3>ğŸ” Exam Question Type: What's the Time Signature?</h3>
        <p>You may be shown a bar of music and asked to identify the time signature. Use this systematic approach:</p>
        <div class='key-point'><strong>Step 1:</strong> Count the total value of notes in the bar (express as crotchets).<br><strong>Step 2:</strong> Look at HOW they're grouped/beamed â€” this reveals the beat structure.<br><strong>Step 3:</strong> If beamed in 3s â†’ probably compound. If in 2s â†’ probably simple.<br><strong>Step 4:</strong> Choose the time signature: TOP = beats Ã— subdivision size, BOTTOM = denomination.</div>
      </div>
      <div class='lesson-section'>
        <h3>Simple vs Compound â€” The Test</h3>
        <table><tr><th>Clue</th><th>Suggests simple</th><th>Suggests compound</th></tr>
        <tr><td>Quavers beamed in groups of</td><td>2 (or 4)</td><td>3</td></tr>
        <tr><td>Beat note</td><td>Undotted</td><td>Dotted</td></tr>
        <tr><td>Top number divisible by 3?</td><td>No</td><td>Yes</td></tr>
        <tr><td>Triplets?</td><td>YES (borrowing from compound)</td><td>No (normal subdivision)</td></tr>
        <tr><td>Duplets?</td><td>No</td><td>YES (borrowing from simple)</td></tr></table>
        <div class='warning-point'><strong>3/4 vs 6/8:</strong> These have the same number of quavers per bar but FEEL different. 3/4 has THREE crotchet beats; 6/8 has TWO dotted-crotchet beats. A bar of 6 quavers: if grouped 2+2+2 â†’ 3/4; if grouped 3+3 â†’ 6/8.</div>
      </div>
      <div class='lesson-section'>
        <h3>Completing Bars â€” Exam Technique</h3>
        <p>You'll be asked to complete a bar by adding rests or notes. Follow this method:</p>
        <ol style="padding-left:20px;line-height:2">
          <li>Calculate total beats needed for the time signature</li>
          <li>Calculate what's already written</li>
          <li>Find the difference = what you need to add</li>
          <li>Fill beat-by-beat, using one rest per beat where possible</li>
          <li>Check: does each beat show clearly in the final version?</li>
        </ol>
        <div class='key-point'><strong>Rest placement rules:</strong> In 4/4, a half-bar silence is written as a MINIM rest, not two crotchet rests. A crotchet rest sits in any beat position. Quaver rests are grouped like beamed notes â€” within single beats.</div>
      </div>`
    },
    {
      title: "Solving Exam Questions Fast",
      content: `<div class='lesson-section'>
        <h3>ğŸš€ Quick-Fire Decision Trees</h3>
        <p><strong>Q: Is this time simple or compound?</strong></p>
        <ol style="padding-left:20px;line-height:2">
          <li>Is the top number divisible by 3? â†’ If YES and it's 6, 9, or 12 â†’ COMPOUND</li>
          <li>Are beats dotted notes? â†’ COMPOUND</li>
          <li>Otherwise â†’ SIMPLE</li>
          <li>Top = 5 or 7? â†’ IRREGULAR (neither simple nor compound)</li>
        </ol>
      </div>
      <div class='lesson-section'>
        <h3>Note Value Quick-Calc</h3>
        <p><strong>Q: How many [small notes] fit in [larger note]?</strong></p>
        <p>Divide the larger note's value by the smaller note's value:</p>
        <ul style="padding-left:20px;line-height:2">
          <li>How many quavers in a dotted minim? â†’ dotted minim = 6 quavers (3 crotchets Ã— 2)</li>
          <li>How many semiquavers in a dotted crotchet? â†’ dotted crotchet = 3 quavers Ã— 2 = 6 semiquavers</li>
          <li>How many quavers in a semibreve? â†’ 4 crotchets Ã— 2 = 8 quavers</li>
        </ul>
        <div class='key-point'><strong>Dot trick:</strong> A dotted note = 1.5 Ã— the undotted value. So dotted crotchet = 1.5 crotchets = 3 quavers = 6 semiquavers.</div>
      </div>
      <div class='lesson-section'>
        <h3>ğŸ¯ Most-Tested Rhythm Traps in ABRSM Grade 5</h3>
        <table><tr><th>Trap</th><th>The Answer</th></tr>
        <tr><td>3/8 vs 6/8 â€” same quavers, different feel?</td><td>3/8 = 3 beats; 6/8 = 2 dotted-crotchet beats</td></tr>
        <tr><td>Whole bar rest regardless of time sig?</td><td>Always semibreve rest (hanging under 4th line)</td></tr>
        <tr><td>Triplet in compound time?</td><td>That's actually normal â€” it's a DUPLET if 2 in the time of 3</td></tr>
        <tr><td>ğ„µ = how many beats?</td><td>2 minim beats (not 4 crotchets)</td></tr>
        <tr><td>Quaver rest vs crotchet rest position?</td><td>Quaver rest: sits in middle of staff. Crotchet rest: hangs on 3rd line.</td></tr>
        <tr><td>Can you beam across a half-bar in 4/4?</td><td>NO â€” the half-bar boundary (beat 3) must always be visible</td></tr></table>
      </div>`
    }
  ],
  scales: [
    {
      title: "Major Scales & Key Signatures",
      content: `<div class='lesson-section'>
        <h3>ğŸ”‘ The Major Scale Pattern</h3>
        <p>Every major scale follows: <strong>Tâ€“Tâ€“Sâ€“Tâ€“Tâ€“Tâ€“S</strong> (Toneâ€“Toneâ€“Semitoneâ€“Toneâ€“Toneâ€“Toneâ€“Semitone).</p>
        <p>Semitones fall between degrees <strong>3â€“4</strong> and <strong>7â€“8</strong>.</p>
        <div class='key-point'>Order of SHARPS: <strong>F C G D A E B</strong> (Father Charles Goes Down And Ends Battle)<br>Order of FLATS: <strong>B E A D G C F</strong> (Battle Ends And Down Goes Charles's Father) â€” the reverse!</div>
      </div>
      <div class='lesson-section'>
        <h3>Circle of Fifths</h3>
        <p>Moving clockwise = add 1 sharp each time. Moving anticlockwise = add 1 flat each time.</p>
        <table><tr><th>Sharps</th><th>Major Key</th><th>Relative Minor</th></tr>
        <tr><td>0</td><td>C</td><td>A minor</td></tr>
        <tr><td>1 (Fâ™¯)</td><td>G</td><td>E minor</td></tr>
        <tr><td>2 (Fâ™¯Câ™¯)</td><td>D</td><td>B minor</td></tr>
        <tr><td>3 (Fâ™¯Câ™¯Gâ™¯)</td><td>A</td><td>Fâ™¯ minor</td></tr>
        <tr><td>4 (Fâ™¯Câ™¯Gâ™¯Dâ™¯)</td><td>E</td><td>Câ™¯ minor</td></tr>
        <tr><td>5 (Fâ™¯Câ™¯Gâ™¯Dâ™¯Aâ™¯)</td><td>B</td><td>Gâ™¯ minor</td></tr>
        <tr><td>6 (Fâ™¯Câ™¯Gâ™¯Dâ™¯Aâ™¯Eâ™¯)</td><td>Fâ™¯</td><td>Dâ™¯ minor</td></tr></table>
        <table style="margin-top:12px"><tr><th>Flats</th><th>Major Key</th><th>Relative Minor</th></tr>
        <tr><td>1 (Bâ™­)</td><td>F</td><td>D minor</td></tr>
        <tr><td>2 (Bâ™­Eâ™­)</td><td>Bâ™­</td><td>G minor</td></tr>
        <tr><td>3 (Bâ™­Eâ™­Aâ™­)</td><td>Eâ™­</td><td>C minor</td></tr>
        <tr><td>4 (Bâ™­Eâ™­Aâ™­Dâ™­)</td><td>Aâ™­</td><td>F minor</td></tr>
        <tr><td>5 (Bâ™­Eâ™­Aâ™­Dâ™­Gâ™­)</td><td>Dâ™­</td><td>Bâ™­ minor</td></tr>
        <tr><td>6 (Bâ™­Eâ™­Aâ™­Dâ™­Gâ™­Câ™­)</td><td>Gâ™­</td><td>Eâ™­ minor</td></tr></table>
      </div>`
    },
    {
      title: "Relative & Parallel Keys",
      content: `<div class='lesson-section'>
        <h3>Relative Keys</h3>
        <p><strong>Relative keys</strong> share the same key signature but have different tonics.</p>
        <ul>
          <li>Find the relative minor: go to the <strong>6th degree</strong> of the major scale (or count DOWN 3 semitones from the major tonic)</li>
          <li>Find the relative major: go UP 3 semitones from the minor tonic</li>
        </ul>
        <div class='key-point'>E.g., C major â†” A minor (both have 0 sharps/flats). G major â†” E minor (both have Fâ™¯).</div>
      </div>
      <div class='lesson-section'>
        <h3>Parallel Keys</h3>
        <p><strong>Parallel keys</strong> share the same TONIC but have different key signatures.</p>
        <p>E.g., C major and C minor (C major = 0 accidentals; C minor = 3 flats).</p>
        <div class='warning-point'>Don't confuse relative (same key sig, different tonic) with parallel (same tonic, different key sig)!</div>
      </div>`
    }
  ],
  intervals: [
    {
      title: "Naming Intervals",
      content: `<div class='lesson-section'>
        <h3>ğŸ“ Two-Step Method</h3>
        <p><strong>Step 1:</strong> Count letter names (inclusively) for the INTERVAL NUMBER.</p>
        <p><strong>Step 2:</strong> Count semitones to determine the QUALITY.</p>
        <div class='key-point'>C to E: letters C(1)â€“D(2)â€“E(3) = a 3rd. Semitones Câ†’E = 4 = Major 3rd.</div>
        <table><tr><th>Semitones</th><th>Quality of 2nd,3rd,6th,7th</th><th>Quality of 1st,4th,5th,8th</th></tr>
        <tr><td>0</td><td>Diminished 2nd</td><td>Perfect Unison</td></tr>
        <tr><td>1</td><td>Minor 2nd</td><td>Augmented Unison / dim 2nd</td></tr>
        <tr><td>2</td><td>Major 2nd</td><td>â€”</td></tr>
        <tr><td>3</td><td>Minor 3rd (Aug 2nd)</td><td>â€”</td></tr>
        <tr><td>4</td><td>Major 3rd</td><td>â€”</td></tr>
        <tr><td>5</td><td>Dim 4th / Aug 3rd</td><td>Perfect 4th</td></tr>
        <tr><td>6</td><td>â€”</td><td>Aug 4th / Dim 5th (tritone)</td></tr>
        <tr><td>7</td><td>â€”</td><td>Perfect 5th</td></tr>
        <tr><td>8</td><td>Minor 6th (Aug 5th)</td><td>â€”</td></tr>
        <tr><td>9</td><td>Major 6th</td><td>â€”</td></tr>
        <tr><td>10</td><td>Minor 7th (Aug 6th)</td><td>â€”</td></tr>
        <tr><td>11</td><td>Major 7th</td><td>â€”</td></tr>
        <tr><td>12</td><td>â€”</td><td>Perfect Octave</td></tr></table>
      </div>`
    },
    {
      title: "Augmented, Diminished & Compound",
      content: `<div class='lesson-section'>
        <h3>Modifying Intervals</h3>
        <ul>
          <li>Major â†’ raise 1 semitone â†’ Augmented</li>
          <li>Major â†’ lower 1 semitone â†’ Minor</li>
          <li>Minor â†’ lower 1 semitone â†’ Diminished</li>
          <li>Perfect â†’ raise 1 semitone â†’ Augmented</li>
          <li>Perfect â†’ lower 1 semitone â†’ Diminished</li>
        </ul>
      </div>
      <div class='lesson-section'>
        <h3>Compound Intervals</h3>
        <p>Any interval larger than an octave is called <strong>compound</strong>.</p>
        <p>Name = simple equivalent + 7. E.g., a 9th = compound 2nd; a 10th = compound 3rd; a 14th = compound 7th.</p>
        <div class='key-point'>In ABRSM Grade 5, you may need to identify compound intervals by name (e.g., compound minor 3rd = minor 10th).</div>
      </div>`
    }
  ],
  chords: [
    {
      title: "Building Triads",
      content: `<div class='lesson-section'>
        <h3>ğŸµ What is a Triad?</h3>
        <p>A triad = THREE notes stacked in intervals of a 3rd: root â†’ 3rd â†’ 5th. The four types differ by the quality of those 3rds.</p>
        <table><tr><th>Type</th><th>Lower 3rd</th><th>Upper 3rd</th><th>Outer interval</th><th>Example</th></tr>
        <tr><td><strong>Major</strong></td><td>Major 3rd (4 st)</td><td>Minor 3rd (3 st)</td><td>Perfect 5th</td><td>Câ€“Eâ€“G</td></tr>
        <tr><td><strong>Minor</strong></td><td>Minor 3rd (3 st)</td><td>Major 3rd (4 st)</td><td>Perfect 5th</td><td>Aâ€“Câ€“E</td></tr>
        <tr><td><strong>Augmented</strong></td><td>Major 3rd (4 st)</td><td>Major 3rd (4 st)</td><td>Aug 5th (8 st)</td><td>Câ€“Eâ€“Gâ™¯</td></tr>
        <tr><td><strong>Diminished</strong></td><td>Minor 3rd (3 st)</td><td>Minor 3rd (3 st)</td><td>Dim 5th (6 st)</td><td>Bâ€“Dâ€“F</td></tr></table>
        <div class='key-point'><strong>Memory trick:</strong> Major = Big-Small. Minor = Small-Big. Augmented = Big-Big. Diminished = Small-Small. ('Big' = major 3rd, 'Small' = minor 3rd)</div>
      </div>
      <div class='lesson-section'>
        <h3>Diatonic Chords in a Major Key</h3>
        <p>Build triads on every degree using only notes from the scale. In any major key:</p>
        <table><tr><th>Degree</th><th>Chord</th><th>Quality</th><th>Example in C major</th></tr>
        <tr><td>I â€” Tonic</td><td>Chord I</td><td>Major</td><td>Câ€“Eâ€“G</td></tr>
        <tr><td>II â€” Supertonic</td><td>Chord II â­NEW</td><td>Minor</td><td>Dâ€“Fâ€“A</td></tr>
        <tr><td>III â€” Mediant</td><td>Chord III</td><td>Minor</td><td>Eâ€“Gâ€“B</td></tr>
        <tr><td>IV â€” Subdominant</td><td>Chord IV</td><td>Major</td><td>Fâ€“Aâ€“C</td></tr>
        <tr><td>V â€” Dominant</td><td>Chord V</td><td>Major</td><td>Gâ€“Bâ€“D</td></tr>
        <tr><td>VI â€” Submediant</td><td>Chord VI</td><td>Minor</td><td>Aâ€“Câ€“E</td></tr>
        <tr><td>VII â€” Leading note</td><td>Chord VII</td><td>Diminished</td><td>Bâ€“Dâ€“F</td></tr></table>
        <div class='key-point'><strong>Pattern to memorise:</strong> Major-Minor-Minor-Major-Major-Minor-Diminished (Iâ€“IIâ€“IIIâ€“IVâ€“Vâ€“VIâ€“VII)</div>
      </div>`
    },
    {
      title: "Inversions & Figured Bass",
      content: `<div class='lesson-section'>
        <h3>ğŸ”„ Understanding Inversions</h3>
        <p>Any note of the triad can be the lowest (bass) note. The inversion name tells you WHICH chord note is in the bass.</p>
        <table><tr><th>Position</th><th>Bass note</th><th>Figured bass</th><th>Stability</th></tr>
        <tr><td><strong>Root position</strong></td><td>Root (1st)</td><td>âµâ‚ƒ or nothing</td><td>Most stable</td></tr>
        <tr><td><strong>1st inversion</strong></td><td>3rd</td><td>â¶â‚ƒ or just â¶</td><td>Lighter, mobile</td></tr>
        <tr><td><strong>2nd inversion</strong></td><td>5th</td><td>â¶â‚„</td><td>Unstable, needs resolution</td></tr></table>
        <div class='key-point'><strong>Figured bass logic:</strong> The numbers show intervals counted ABOVE the bass note. In 1st inversion (e.g. Eâ€“Câ€“G with E at bottom): Eâ†’G = a 3rd, Eâ†’C = a 6th â†’ â¶â‚ƒ. In 2nd inversion (G at bottom): Gâ†’C = 4th, Gâ†’E = 6th â†’ â¶â‚„.</div>
        <div class='warning-point'><strong>The 6/4 trap:</strong> The cadential six-four places chord I in 2nd inversion before a cadence (e.g. C major in 2nd inversion = G in bass, then resolves to G major chord V). It SOUNDS like a V chord at first!</div>
      </div>
      <div class='lesson-section'>
        <h3>Exam Process: Identifying Inversions</h3>
        <p>When given a chord and asked for its inversion:</p>
        <ol style="padding-left:20px;line-height:2.2">
          <li><strong>Identify the chord</strong> â€” rearrange notes into stacked 3rds if needed. The BOTTOM of the rearranged stack = the root.</li>
          <li><strong>Find the bass note</strong> (lowest note as written)</li>
          <li><strong>Compare bass note to root:</strong> Bass = root â†’ Root position. Bass = 3rd â†’ 1st inv. Bass = 5th â†’ 2nd inv.</li>
        </ol>
        <div class='key-point'><strong>Example:</strong> Chord written as Eâ€“Câ€“G (E at bottom). Rearrange into 3rds: Câ€“Eâ€“G = C major. Root = C. Bass note = E = the 3rd of C major. Therefore: 1st inversion. Figured bass = 6.</div>
      </div>`
    },
    {
      title: "Chords I, II, IV, V in Context",
      content: `<div class='lesson-section'>
        <h3>The Big Four Chords â€” Grade 5 Focus</h3>
        <p>ABRSM Grade 5 requires you to identify and work with chords I, II, IV, and V in any key. Chord II is the main new addition at this grade.</p>
        <table><tr><th>Chord</th><th>Degree name</th><th>Quality in major</th><th>Quality in minor (harmonic)</th></tr>
        <tr><td>I</td><td>Tonic</td><td>Major</td><td>Minor</td></tr>
        <tr><td>II</td><td>Supertonic</td><td>Minor</td><td>Diminished</td></tr>
        <tr><td>IV</td><td>Subdominant</td><td>Major</td><td>Minor</td></tr>
        <tr><td>V</td><td>Dominant</td><td>Major</td><td>Major (raised 7th)</td></tr></table>
        <div class='key-point'><strong>In minor keys:</strong> Chord V is MAJOR because harmonic minor raises the 7th â€” this is what creates the strong leading note. Without this, the dominant chord would be minor and would not resolve convincingly to the tonic.</div>
      </div>
      <div class='lesson-section'>
        <h3>Cadences â€” Chord Progressions at Phrase Ends</h3>
        <table><tr><th>Cadence</th><th>Chords</th><th>Effect</th></tr>
        <tr><td><strong>Perfect (Authentic)</strong></td><td>V â†’ I</td><td>Strong full stop. Both chords major (in major key)</td></tr>
        <tr><td><strong>Plagal</strong></td><td>IV â†’ I</td><td>Soft, 'Amen' cadence. Often at hymn endings</td></tr>
        <tr><td><strong>Imperfect</strong></td><td>I/II/IV â†’ V</td><td>Half stop â€” ends on the dominant, expecting more</td></tr>
        <tr><td><strong>Interrupted (Deceptive)</strong></td><td>V â†’ VI</td><td>Surprise! Avoids expected tonic, goes to submediant</td></tr></table>
        <div class='warning-point'><strong>Common exam question:</strong> "Name the cadence at bar X." Always check: what are the last TWO chords of the phrase, and which degrees are they built on? Vâ†’I is always perfect regardless of key.</div>
      </div>
      <div class='lesson-section'>
        <h3>Quick Chord Builder for Any Key</h3>
        <p><strong>Method to build chord II in any major key:</strong></p>
        <ol style="padding-left:20px;line-height:2">
          <li>Find the tonic (note I) of the key</li>
          <li>Count UP two scale steps = the root of chord II</li>
          <li>Build a minor triad on that root using only scale notes</li>
        </ol>
        <div class='key-point'><strong>Shortcut for chord V:</strong> The dominant is ALWAYS a perfect 5th above the tonic. V in C = G. V in G = D. V in D = A. V in F = C. V in Bâ™­ = F. It's always a major triad.</div>
      </div>`
    },
    {
      title: "Solving Chord Questions Fast",
      content: `<div class='lesson-section'>
        <h3>ğŸš€ Systematic Approach to Any Chord Question</h3>
        <div class='key-point'><strong>Step-by-step process:</strong><br>
        1. KEY â€” what key are we in? Read the key signature.<br>
        2. ROOT â€” what is the chord? Rearrange notes into 3rds to find the root.<br>
        3. DEGREE â€” what scale degree is the root? Count up the scale.<br>
        4. INVERSION â€” what's in the bass? Compare to root.<br>
        5. QUALITY â€” is the triad major, minor, diminished, or augmented?</div>
      </div>
      <div class='lesson-section'>
        <h3>Chord Quality Shortcut â€” Semitone Counting</h3>
        <p>When you're unsure of a triad's quality, count semitones from the root:</p>
        <table><tr><th>Root â†’ 3rd</th><th>Root â†’ 5th</th><th>= Quality</th></tr>
        <tr><td>4 semitones (M3)</td><td>7 semitones (P5)</td><td>MAJOR</td></tr>
        <tr><td>3 semitones (m3)</td><td>7 semitones (P5)</td><td>MINOR</td></tr>
        <tr><td>4 semitones (M3)</td><td>8 semitones (A5)</td><td>AUGMENTED</td></tr>
        <tr><td>3 semitones (m3)</td><td>6 semitones (d5)</td><td>DIMINISHED</td></tr></table>
      </div>
      <div class='lesson-section'>
        <h3>ğŸ¯ Common Exam Traps â€” Chords</h3>
        <table><tr><th>Trap</th><th>Remember</th></tr>
        <tr><td>Chord II in major key</td><td>Always MINOR (not major)</td></tr>
        <tr><td>Chord V in minor key</td><td>Always MAJOR (raised 7th from harmonic minor)</td></tr>
        <tr><td>6/4 chord = what inversion?</td><td>2nd inversion (5th in bass)</td></tr>
        <tr><td>Is chord VII major or diminished?</td><td>DIMINISHED in major keys</td></tr>
        <tr><td>Figured bass '6' alone = which position?</td><td>1st inversion (shorthand for 6/3)</td></tr>
        <tr><td>Root of Eâ€“Gâ€“C (E at bottom)?</td><td>Rearrange: Câ€“Eâ€“G = C major. Root = C. 1st inversion.</td></tr>
        <tr><td>Is an augmented chord ever diatonic in major?</td><td>No â€” chord III+ doesn't occur naturally in major keys</td></tr></table>
        <div class='key-point'><strong>Golden rule for inversions:</strong> When in doubt, stack the notes in 3rds â€” the bottom note of that rearrangement is ALWAYS the root, regardless of what's in the bass of the original chord.</div>
      </div>`
    }
  ],
  clefs: [
    {
      title: "The Four Clefs",
      content: `<div class='lesson-section'>
        <h3>ğ„ Treble Clef (G Clef) â€” Know It Cold</h3>
        <p>The curl wraps around the <strong>2nd line = G4</strong>. All note positions follow from there.</p>
        <table><tr><th>Position</th><th>Note</th><th>Memory</th></tr>
        <tr><td>Line 1</td><td>E</td><td rowspan="5"><strong>Lines:</strong> Eâ€“Gâ€“Bâ€“Dâ€“F<br>"Every Good Boy Deserves Fruit"</td></tr>
        <tr><td>Line 2</td><td>G</td></tr>
        <tr><td>Line 3</td><td>B</td></tr>
        <tr><td>Line 4</td><td>D</td></tr>
        <tr><td>Line 5</td><td>F</td></tr>
        <tr><td>Space 1</td><td>F</td><td rowspan="4"><strong>Spaces:</strong> Fâ€“Aâ€“Câ€“E = "FACE"</td></tr>
        <tr><td>Space 2</td><td>A</td></tr>
        <tr><td>Space 3</td><td>C</td></tr>
        <tr><td>Space 4</td><td>E</td></tr>
        <tr><td>1st ledger line below</td><td><strong>Middle C</strong></td><td>Most important reference point!</td></tr></table>
      </div>
      <div class='lesson-section'>
        <h3>ğ„¢ Bass Clef (F Clef) â€” Know It Cold</h3>
        <p>The two dots surround the <strong>4th line = F3</strong>.</p>
        <table><tr><th>Position</th><th>Note</th><th>Memory</th></tr>
        <tr><td>Line 1</td><td>G</td><td rowspan="5"><strong>Lines:</strong> Gâ€“Bâ€“Dâ€“Fâ€“A<br>"Good Boys Do Fine Always"</td></tr>
        <tr><td>Line 2</td><td>B</td></tr>
        <tr><td>Line 3</td><td>D</td></tr>
        <tr><td>Line 4</td><td>F</td></tr>
        <tr><td>Line 5</td><td>A</td></tr>
        <tr><td>Space 1</td><td>A</td><td rowspan="4"><strong>Spaces:</strong> Aâ€“Câ€“Eâ€“G = "All Cows Eat Grass"</td></tr>
        <tr><td>Space 2</td><td>C</td></tr>
        <tr><td>Space 3</td><td>E</td></tr>
        <tr><td>Space 4</td><td>G</td></tr>
        <tr><td>1st ledger line above</td><td><strong>Middle C</strong></td><td>C4 = same pitch as treble clef ledger line below</td></tr></table>
      </div>
      <div class='lesson-section'>
        <h3>C Clefs â€” Alto & Tenor</h3>
        <p>The C clef (B-shaped symbol) ALWAYS marks <strong>middle C</strong> on whichever line it rests.</p>
        <table><tr><th>Clef</th><th>C position</th><th>Used by</th><th>Memory</th></tr>
        <tr><td><strong>Alto</strong></td><td>3rd line = middle C</td><td>Viola (primarily)</td><td>A-L-T-O = 3 vowels â†’ 3rd line</td></tr>
        <tr><td><strong>Tenor</strong></td><td>4th line = middle C</td><td>Cello/bassoon (high), trombone</td><td>Tenor is 'higher' voice â†’ 4th line (one higher)</td></tr></table>
        <div class='key-point'><strong>C clef reading strategy:</strong> Find middle C first (it's marked by the clef itself). Then count up or down alphabetically: Câ†’Dâ†’Eâ†’Fâ†’Gâ†’Aâ†’Bâ†’C. Middle C in alto = line 3; the space above = D; line 4 = E; space 4 = F; line 5 = G.</div>
      </div>`
    },
    {
      title: "Note Reading in Each Clef",
      content: `<div class='lesson-section'>
        <h3>ğŸ¯ Alto Clef â€” Full Breakdown</h3>
        <p>Middle C on line 3. From there, read up and down:</p>
        <table><tr><th>Position</th><th>Note</th></tr>
        <tr><td>Line 1</td><td>F (a major 3rd below middle C)</td></tr>
        <tr><td>Space 1</td><td>G</td></tr>
        <tr><td>Line 2</td><td>A</td></tr>
        <tr><td>Space 2</td><td>B</td></tr>
        <tr><td><strong>Line 3</strong></td><td><strong>C (Middle C)</strong></td></tr>
        <tr><td>Space 3</td><td>D</td></tr>
        <tr><td>Line 4</td><td>E</td></tr>
        <tr><td>Space 4</td><td>F</td></tr>
        <tr><td>Line 5</td><td>G</td></tr></table>
        <div class='key-point'><strong>Alto clef vs treble clef relationship:</strong> Notes in alto clef appear approximately TWO lines/spaces HIGHER than the same pitch in treble clef (for the overlapping range). This is useful as a cross-check.</div>
      </div>
      <div class='lesson-section'>
        <h3>Tenor Clef â€” Full Breakdown</h3>
        <p>Middle C on line 4. All positions shift DOWN by one line/space compared to alto clef:</p>
        <table><tr><th>Position</th><th>Note</th></tr>
        <tr><td>Line 1</td><td>D</td></tr>
        <tr><td>Space 1</td><td>E</td></tr>
        <tr><td>Line 2</td><td>F</td></tr>
        <tr><td>Space 2</td><td>G</td></tr>
        <tr><td>Line 3</td><td>A</td></tr>
        <tr><td>Space 3</td><td>B</td></tr>
        <tr><td><strong>Line 4</strong></td><td><strong>C (Middle C)</strong></td></tr>
        <tr><td>Space 4</td><td>D</td></tr>
        <tr><td>Line 5</td><td>E</td></tr></table>
      </div>
      <div class='lesson-section'>
        <h3>The Anchor Method â€” Works for Any Clef</h3>
        <div class='key-point'><strong>Always start from middle C</strong> â€” it's your anchor. Since every C clef marks it explicitly, you never have to guess. Once you have middle C, count letter names up or down the staff: Câ€“Dâ€“Eâ€“Fâ€“Gâ€“Aâ€“Bâ€“C. Each step up moves you up a line or space; each step down moves you down.</div>
        <p><strong>Practice drill:</strong> For any note in alto or tenor clef â€” find middle C (the clef tells you where it is), count steps to your note, name it. After 20 reps this becomes automatic.</p>
      </div>`
    },
    {
      title: "Transposition Between Clefs",
      content: `<div class='lesson-section'>
        <h3>The Core Concept</h3>
        <p>Transposing between clefs = <strong>same pitch, different notation</strong>. The note keeps its letter name and octave; only its position on the staff changes.</p>
        <div class='key-point'><strong>The Two-Step Process:</strong><br>Step 1: NAME the pitch in the original clef (e.g. "this is D4").<br>Step 2: PLACE that same pitch in the new clef (where is D4 in the new clef?).</div>
        <div class='warning-point'><strong>Never</strong> copy the staff position directly between clefs â€” the same position means a completely different pitch in different clefs!</div>
      </div>
      <div class='lesson-section'>
        <h3>Middle C as the Bridge</h3>
        <p>Middle C is the most important note to know in ALL clefs:</p>
        <table><tr><th>Clef</th><th>Position of Middle C</th></tr>
        <tr><td>Treble</td><td>1st ledger line BELOW staff</td></tr>
        <tr><td>Bass</td><td>1st ledger line ABOVE staff</td></tr>
        <tr><td>Alto</td><td>3rd line</td></tr>
        <tr><td>Tenor</td><td>4th line</td></tr></table>
        <p>Use middle C as your bridge when transposing: find how many steps the melody note is from middle C in clef A, then count the same number of steps from middle C in clef B.</p>
      </div>
      <div class='lesson-section'>
        <h3>Octave Transposition + Clef Change</h3>
        <p>ABRSM Grade 5 often asks: "Transpose this melody DOWN an octave, rewriting it in bass clef" (or similar combinations).</p>
        <div class='key-point'><strong>Strategy for octave + clef change:</strong><br>1. Name each note in the original.<br>2. Mentally move it up/down an octave (same letter name, different octave number).<br>3. Place the new octave pitch in the target clef.</div>
        <p><strong>Example:</strong> Treble clef has G4 (2nd line of treble). Transpose DOWN octave to bass clef. G4 â†’ G3. Where is G3 in bass clef? 2nd line of bass clef = B, so G3 is... line 1 of bass clef. âœ“</p>
      </div>
      <div class='lesson-section'>
        <h3>Worked Examples â€” Key Pitch Positions</h3>
        <table><tr><th>Pitch</th><th>Treble clef position</th><th>Bass clef position</th><th>Alto clef position</th></tr>
        <tr><td>Middle C (C4)</td><td>1st ledger line below</td><td>1st ledger line above</td><td>3rd line</td></tr>
        <tr><td>D4</td><td>Below staff, 1 step up from middle C</td><td>1st space above staff</td><td>3rd space</td></tr>
        <tr><td>G4</td><td>2nd line</td><td>2nd ledger line above</td><td>5th line</td></tr>
        <tr><td>A3</td><td>2nd ledger line below</td><td>2nd space</td><td>1st ledger line below</td></tr>
        <tr><td>F3</td><td>4th ledger line below (rare)</td><td>4th line</td><td>1st line</td></tr></table>
      </div>`
    },
    {
      title: "Solving Clef Questions Fast",
      content: `<div class='lesson-section'>
        <h3>ğŸš€ Decision Trees for Clef Questions</h3>
        <p><strong>Q: What note is this in the alto clef?</strong></p>
        <ol style="padding-left:20px;line-height:2">
          <li>Locate line 3 â€” that's your Middle C anchor</li>
          <li>Count steps up or down from line 3 to your note</li>
          <li>Apply those steps to the Câ€“Dâ€“Eâ€“Fâ€“Gâ€“Aâ€“B sequence</li>
          <li>Apply any key signature accidentals</li>
        </ol>
        <p><strong>Q: Rewrite this bass clef melody in alto clef at the same pitch.</strong></p>
        <ol style="padding-left:20px;line-height:2">
          <li>Name each bass clef note (e.g. D3, F3, G3...)</li>
          <li>Find each pitch in the alto clef using middle C as anchor</li>
          <li>Write it. Double-check one note at a time.</li>
        </ol>
      </div>
      <div class='lesson-section'>
        <h3>ğŸ¯ Clef Exam Traps</h3>
        <table><tr><th>Trap</th><th>Remember</th></tr>
        <tr><td>Alto clef â€” which line is middle C?</td><td>3rd line (the MIDDLE line of a 5-line staff)</td></tr>
        <tr><td>Tenor clef â€” which line is middle C?</td><td>4th line</td></tr>
        <tr><td>Copying positions directly between clefs</td><td>NEVER do this â€” always name the pitch first</td></tr>
        <tr><td>8va over a treble clef passage â€” do I change clef?</td><td>No â€” you play an octave higher in the SAME clef</td></tr>
        <tr><td>What does loco mean after 8va?</td><td>Return to written (normal) pitch</td></tr>
        <tr><td>Bass clef 4th line = ?</td><td>F (the F clef marks it with its two dots)</td></tr>
        <tr><td>Who uses alto clef?</td><td>Viola ONLY as primary clef</td></tr>
        <tr><td>Who uses tenor clef?</td><td>Cello, bassoon, trombone (for high passages)</td></tr></table>
      </div>
      <div class='lesson-section'>
        <h3>Relationships Between Clefs</h3>
        <div class='key-point'><strong>Treble â†’ Bass (same pitch):</strong> A note on the treble clef staff generally appears two ledger lines higher in bass clef. Middle C is on ledger line 1 below treble; same C is on ledger line 1 above bass. The staves are like two halves of the grand staff.</div>
        <div class='key-point'><strong>Treble â†’ Alto (same pitch):</strong> Alto clef notes sit approximately one 3rd higher on the staff (e.g., middle C is on ledger line 1 below treble, but on line 3 of the alto staff). This shift is useful as a rough check.</div>
      </div>`
    }
  ],
  terms: [
    {
      title: "Tempo Terms",
      content: `<div class='lesson-section'>
        <h3>ğŸ­ Complete Tempo Order (Slowest â†’ Fastest)</h3>
        <p>Learn these in sequence â€” exam questions often test comparative tempos ("which is faster?").</p>
        <table><tr><th>Term</th><th>Meaning</th><th>Character clue</th></tr>
        <tr><td>Grave</td><td>Very slow, solemn</td><td>Funeral gravity</td></tr>
        <tr><td>Largo</td><td>Very slow, broad</td><td>Large, spacious</td></tr>
        <tr><td>Larghetto</td><td>Slightly less slow than largo</td><td>-etto = diminutive (a bit)</td></tr>
        <tr><td>Lento</td><td>Slow</td><td>Lento = slow (lenient/lingering)</td></tr>
        <tr><td>Adagio</td><td>Slow, stately</td><td>'At ease' â€” unhurried</td></tr>
        <tr><td>Andante</td><td>Walking pace</td><td>'Andare' = to walk</td></tr>
        <tr><td>Andantino</td><td>Slightly faster than andante</td><td>-ino = smaller â†’ smaller/quicker steps</td></tr>
        <tr><td>Moderato</td><td>Moderate speed</td><td>Modern, middle ground</td></tr>
        <tr><td>Allegretto</td><td>Moderately fast</td><td>Less allegro (not fully fast yet)</td></tr>
        <tr><td>Allegro</td><td>Fast, lively</td><td>'Allegro' = joyful, nimble</td></tr>
        <tr><td>Vivace</td><td>Lively, vivacious</td><td>'Vivere' = to live</td></tr>
        <tr><td>Presto</td><td>Very fast</td><td>'Presto' = quickly! (magic word)</td></tr>
        <tr><td>Prestissimo</td><td>As fast as possible</td><td>-issimo = superlative (MOST)</td></tr></table>
      </div>
      <div class='lesson-section'>
        <h3>The Critical Three: Rall. / Rit. / Riten.</h3>
        <div class='warning-point'><strong>Most common confusion in the exam!</strong></div>
        <table><tr><th>Term</th><th>Abbreviation</th><th>Meaning</th><th>How it works</th></tr>
        <tr><td>Rallentando</td><td>rall.</td><td>Getting gradually slower</td><td>Over several notes/bars</td></tr>
        <tr><td>Ritardando</td><td>rit. / ritard.</td><td>Getting gradually slower</td><td>Over several notes/bars</td></tr>
        <tr><td>Ritenuto</td><td>rit. / riten.</td><td>Immediately held back</td><td>Instant effect on that note</td></tr></table>
        <div class='key-point'><strong>Rule:</strong> rall. and ritard. = GRADUAL. Ritenuto = IMMEDIATE. After any of these, 'a tempo' restores original speed. Note: both rit. and riten. can abbreviate to 'rit.' â€” context helps distinguish them!</div>
      </div>`
    },
    {
      title: "Expression & Character",
      content: `<div class='lesson-section'>
        <h3>ğŸ¨ Dynamics â€” Complete List</h3>
        <table><tr><th>Symbol</th><th>Full name</th><th>Meaning</th></tr>
        <tr><td>ppp</td><td>pianississimo</td><td>Very very soft</td></tr>
        <tr><td>pp</td><td>pianissimo</td><td>Very soft</td></tr>
        <tr><td>p</td><td>piano</td><td>Soft</td></tr>
        <tr><td>mp</td><td>mezzo-piano</td><td>Moderately soft</td></tr>
        <tr><td>mf</td><td>mezzo-forte</td><td>Moderately loud</td></tr>
        <tr><td>f</td><td>forte</td><td>Loud</td></tr>
        <tr><td>ff</td><td>fortissimo</td><td>Very loud</td></tr>
        <tr><td>fff</td><td>fortississimo</td><td>Very very loud</td></tr>
        <tr><td>sfz / sf</td><td>sforzando</td><td>Forced accent (single note)</td></tr>
        <tr><td>fz</td><td>forzando</td><td>Forced (single note)</td></tr>
        <tr><td>fp</td><td>forte-piano</td><td>Loud then immediately soft</td></tr></table>
      </div>
      <div class='lesson-section'>
        <h3>Key Italian Expression Terms</h3>
        <table><tr><th>Term</th><th>Meaning</th><th>Tip</th></tr>
        <tr><td>cantabile</td><td>In a singing style</td><td>'Cantare' = to sing</td></tr>
        <tr><td>dolce</td><td>Sweetly</td><td>'Dolce' = sweet (dolce vita)</td></tr>
        <tr><td>espressivo</td><td>Expressively</td><td>Like 'expressive'</td></tr>
        <tr><td>grazioso</td><td>Gracefully</td><td>'Grazia' = grace</td></tr>
        <tr><td>leggiero / leggero</td><td>Lightly</td><td>'Leggero' = light</td></tr>
        <tr><td>maestoso</td><td>Majestically</td><td>'Maestro' = master â†’ grand</td></tr>
        <tr><td>scherzando</td><td>Playfully, jokingly</td><td>'Scherzo' = joke/jest</td></tr>
        <tr><td>tranquillo</td><td>Calmly, quietly</td><td>'Tranquil'</td></tr>
        <tr><td>con brio</td><td>With vigour</td><td>'Brio' = dash/energy</td></tr>
        <tr><td>con fuoco</td><td>With fire</td><td>'Fuoco' = fire</td></tr>
        <tr><td>con moto</td><td>With movement</td><td>'Moto' = motion</td></tr>
        <tr><td>appassionato</td><td>Passionately</td><td>Like 'passionate'</td></tr>
        <tr><td>giocoso</td><td>Playfully, humorously</td><td>'Gioco' = game/play</td></tr>
        <tr><td>sostenuto</td><td>Sustained</td><td>'Sostenere' = to sustain</td></tr>
        <tr><td>agitato</td><td>Agitated</td><td>Like 'agitate'</td></tr>
        <tr><td>brillante</td><td>Brilliantly</td><td>Like 'brilliant'</td></tr>
        <tr><td>furioso</td><td>Furiously</td><td>Like 'furious'</td></tr>
        <tr><td>marziale</td><td>In a military style</td><td>'Mars' = war god</td></tr>
        <tr><td>pastorale</td><td>Peaceful, rural</td><td>Like 'pastoral'</td></tr>
        <tr><td>risoluto</td><td>Boldly, resolutely</td><td>Like 'resolute'</td></tr>
        <tr><td>nobilmente</td><td>Nobly</td><td>Like 'noble'</td></tr></table>
      </div>`
    },
    {
      title: "French & German Terms",
      content: `<div class='lesson-section'>
        <h3>ğŸ‡«ğŸ‡· French Terms â€” Master List</h3>
        <p><em>Strategy: French words often look like modern French or English cognates. Spot the similarity!</em></p>
        <table><tr><th>Term</th><th>Meaning</th><th>Language clue</th></tr>
        <tr><td>animÃ©</td><td>Animated, lively</td><td>Like 'animated'</td></tr>
        <tr><td>assez</td><td>Enough, rather</td><td>French: assez = enough</td></tr>
        <tr><td>avec</td><td>With</td><td>French: avec = with</td></tr>
        <tr><td>cÃ©dez</td><td>Yield, slow down</td><td>French: cÃ©der = to yield</td></tr>
        <tr><td>doux / douce</td><td>Sweet, gentle</td><td>French: doux = sweet</td></tr>
        <tr><td>en dehors</td><td>Prominent, standing out</td><td>French: dehors = outside</td></tr>
        <tr><td>et</td><td>And</td><td>French: et = and</td></tr>
        <tr><td>expressif</td><td>Expressive</td><td>Like 'expressive'</td></tr>
        <tr><td>lÃ©gÃ¨rement</td><td>Lightly</td><td>French: lÃ©ger = light</td></tr>
        <tr><td>lent</td><td>Slow</td><td>French: lent = slow</td></tr>
        <tr><td>moins</td><td>Less</td><td>French: moins = less</td></tr>
        <tr><td>modÃ©rÃ©</td><td>Moderate</td><td>Like 'moderate'</td></tr>
        <tr><td>non</td><td>Not</td><td>French: non = no/not</td></tr>
        <tr><td>peu Ã  peu</td><td>Little by little</td><td>French: peu = little</td></tr>
        <tr><td>presser</td><td>To hurry / pressing</td><td>French: presser = to press/rush</td></tr>
        <tr><td>ralentir</td><td>To slow down</td><td>French: ralentir = slow down</td></tr>
        <tr><td>retenu</td><td>Held back</td><td>French: retenir = to hold back</td></tr>
        <tr><td>sans</td><td>Without</td><td>French: sans = without</td></tr>
        <tr><td>trÃ¨s</td><td>Very</td><td>French: trÃ¨s = very</td></tr>
        <tr><td>un peu</td><td>A little</td><td>French: un peu = a little</td></tr>
        <tr><td>vif / vite</td><td>Lively / quickly</td><td>French: vif = lively</td></tr></table>
      </div>
      <div class='lesson-section'>
        <h3>ğŸ‡©ğŸ‡ª German Terms â€” Master List</h3>
        <p><em>Strategy: German musical terms look distinctly Germanic. Watch for compound words and umlauts (Ã¤, Ã¶, Ã¼).</em></p>
        <table><tr><th>Term</th><th>Meaning</th><th>Language clue</th></tr>
        <tr><td>aber</td><td>But</td><td>German: aber = but</td></tr>
        <tr><td>ausdrucksvoll</td><td>Expressive, with expression</td><td>German: Ausdruck = expression</td></tr>
        <tr><td>bewegt</td><td>With movement, agitated</td><td>German: Bewegung = movement</td></tr>
        <tr><td>breit</td><td>Broad</td><td>German: breit = broad/wide</td></tr>
        <tr><td>einfach</td><td>Simple</td><td>German: einfach = simple</td></tr>
        <tr><td>etwas</td><td>Somewhat, rather</td><td>German: etwas = somewhat</td></tr>
        <tr><td>frÃ¶hlich</td><td>Happy, merry</td><td>German: frÃ¶hlich = cheerful</td></tr>
        <tr><td>gedÃ¤mpft</td><td>Muted, damped</td><td>German: dÃ¤mpfen = to mute</td></tr>
        <tr><td>immer</td><td>Always</td><td>German: immer = always</td></tr>
        <tr><td>krÃ¤ftig</td><td>Strong, vigorous</td><td>German: Kraft = strength</td></tr>
        <tr><td>langsam</td><td>Slow</td><td>German: langsam = slow</td></tr>
        <tr><td>lebhaft</td><td>Lively</td><td>German: leben = to live</td></tr>
        <tr><td>leise</td><td>Soft, gentle</td><td>German: leise = quietly</td></tr>
        <tr><td>mÃ¤ÃŸig</td><td>Moderate</td><td>German: maÃŸ = measure</td></tr>
        <tr><td>mit</td><td>With</td><td>German: mit = with</td></tr>
        <tr><td>nicht</td><td>Not</td><td>German: nicht = not</td></tr>
        <tr><td>ruhig</td><td>Calm, peaceful</td><td>German: Ruhe = peace/rest</td></tr>
        <tr><td>schnell</td><td>Fast</td><td>German: schnell = fast</td></tr>
        <tr><td>sehr</td><td>Very</td><td>German: sehr = very</td></tr>
        <tr><td>und</td><td>And</td><td>German: und = and</td></tr>
        <tr><td>zart</td><td>Tender, delicate</td><td>German: zart = tender</td></tr></table>
      </div>`
    },
    {
      title: "Ornaments & Solving Exam Questions",
      content: `<div class='lesson-section'>
        <h3>ğŸŒ€ Ornaments â€” Deep Dive</h3>
        <table><tr><th>Ornament</th><th>Symbol</th><th>Notes played</th><th>Timing</th></tr>
        <tr><td><strong>Trill</strong></td><td>tr or ~~~</td><td>Main â†” upper note, rapid alternation</td><td>Duration of written note</td></tr>
        <tr><td><strong>Upper mordent (Pralltriller)</strong></td><td>Short wavy line âŒ‡</td><td>Main â†’ upper â†’ main (3 notes)</td><td>Very quick, on the beat</td></tr>
        <tr><td><strong>Lower mordent</strong></td><td>Wavy line with vertical slash âŒ‡|</td><td>Main â†’ lower â†’ main (3 notes)</td><td>Very quick, on the beat</td></tr>
        <tr><td><strong>Turn</strong></td><td>S-curve âˆ¿ or âˆ¾</td><td>Upper â†’ main â†’ lower â†’ main (4 notes)</td><td>Spread over the note's duration</td></tr>
        <tr><td><strong>Acciaccatura</strong></td><td>Small note WITH slash /</td><td>Crushed â†’ main note</td><td>Before the beat (brief)</td></tr>
        <tr><td><strong>Appoggiatura</strong></td><td>Small note, NO slash</td><td>Leaning note â†’ main note</td><td>On the beat; takes Â½ (or â…” if dotted) of main note's value</td></tr></table>
        <div class='key-point'><strong>Acciaccatura vs Appoggiatura:</strong> The SLASH is the key. Slash = acciaccatura (crushed, before beat, brief). No slash = appoggiatura (leaning, on beat, takes real time). This distinction is tested directly in ABRSM Grade 5.</div>
      </div>
      <div class='lesson-section'>
        <h3>Performance Directions to Know</h3>
        <table><tr><th>Direction</th><th>Meaning</th><th>Applies to</th></tr>
        <tr><td>pizzicato (pizz.)</td><td>Pluck the string</td><td>Strings</td></tr>
        <tr><td>arco</td><td>With the bow (after pizz.)</td><td>Strings</td></tr>
        <tr><td>col legno</td><td>With the wood of the bow</td><td>Strings</td></tr>
        <tr><td>sul ponticello</td><td>Bow near the bridge (nasal sound)</td><td>Strings</td></tr>
        <tr><td>sul tasto</td><td>Bow over the fingerboard (soft)</td><td>Strings</td></tr>
        <tr><td>con sordino</td><td>With mute</td><td>Strings/brass</td></tr>
        <tr><td>senza sordino</td><td>Without mute</td><td>Strings/brass</td></tr>
        <tr><td>tremolo</td><td>Rapid repeated bowing of one note</td><td>Strings</td></tr>
        <tr><td>vibrato</td><td>Slight pitch oscillation</td><td>Strings/voice</td></tr>
        <tr><td>glissando (gliss.)</td><td>Slide between two pitches</td><td>Various</td></tr>
        <tr><td>8va</td><td>Play one octave higher</td><td>Any</td></tr>
        <tr><td>8vb</td><td>Play one octave lower</td><td>Any</td></tr>
        <tr><td>loco</td><td>At normal pitch (after 8va)</td><td>Any</td></tr>
        <tr><td>Da Capo (D.C.)</td><td>Return to the beginning</td><td>Any</td></tr>
        <tr><td>Dal Segno (D.S.)</td><td>Return to the sign ğ„‹</td><td>Any</td></tr>
        <tr><td>al Fine</td><td>Continue to the word 'Fine'</td><td>Any</td></tr></table>
      </div>
      <div class='lesson-section'>
        <h3>ğŸ¯ Exam Strategy: Identifying Unknown Terms</h3>
        <div class='key-point'><strong>Language identification first:</strong> Is it Italian (usually ends -o, -e, -ando, -oso)? French (accent marks like Ã©, Ã¨, subtle spellings)? German (compound words, umlauts Ã¤/Ã¶/Ã¼, capitalisation)? Once you identify the language, you can often deduce the meaning from root words.</div>
        <p><strong>Common roots to recognise:</strong></p>
        <ul style="padding-left:20px;line-height:1.9">
          <li><strong>-issimo</strong> = superlative (MOST) â†’ pianissimo = very soft</li>
          <li><strong>-etto / -ino</strong> = diminutive (a bit less) â†’ larghetto, andantino</li>
          <li><strong>-ando / -endo</strong> = ongoing action â†’ crescendo (growing), diminuendo (diminishing)</li>
          <li><strong>con-</strong> = with â†’ con brio, con fuoco, con sordino</li>
          <li><strong>senza-</strong> = without â†’ senza sordino</li>
          <li><strong>sehr / trÃ¨s / molto</strong> = very (German / French / Italian)</li>
          <li><strong>mit / avec / con</strong> = with (German / French / Italian)</li>
          <li><strong>nicht / sans / senza</strong> = without (German / French / Italian)</li>
        </ul>
      </div>`
    }
  ],
  instruments: [
    {
      title: "Orchestral Families & Clefs",
      content: `<div class='lesson-section'>
        <h3>ğŸ» String Family</h3>
        <table><tr><th>Instrument</th><th>Clef</th><th>Range notes</th></tr>
        <tr><td>Violin</td><td>Treble</td><td>G3 to E7</td></tr>
        <tr><td>Viola</td><td>Alto (main), Treble (high)</td><td>C3 to E6</td></tr>
        <tr><td>Cello</td><td>Bass, Tenor (high)</td><td>C2 to C6</td></tr>
        <tr><td>Double Bass</td><td>Bass (sounds 8va lower)</td><td>E1â€“G4 (sounds 8va lower)</td></tr></table>
      </div>
      <div class='lesson-section'>
        <h3>ğŸ· Woodwind Family</h3>
        <table><tr><th>Instrument</th><th>Clef</th><th>Transposing?</th></tr>
        <tr><td>Flute</td><td>Treble</td><td>No (Concert C)</td></tr>
        <tr><td>Oboe</td><td>Treble</td><td>No (Concert C)</td></tr>
        <tr><td>Clarinet in Bâ™­</td><td>Treble</td><td>Yes â€” sounds M2nd lower</td></tr>
        <tr><td>Clarinet in A</td><td>Treble</td><td>Yes â€” sounds m3rd lower</td></tr>
        <tr><td>Bassoon</td><td>Bass, Tenor</td><td>No (Concert C)</td></tr></table>
      </div>
      <div class='lesson-section'>
        <h3>ğŸº Brass Family</h3>
        <table><tr><th>Instrument</th><th>Clef</th><th>Transposing?</th></tr>
        <tr><td>Horn in F</td><td>Treble</td><td>Yes â€” sounds P5th lower</td></tr>
        <tr><td>Trumpet in Bâ™­</td><td>Treble</td><td>Yes â€” sounds M2nd lower</td></tr>
        <tr><td>Trombone</td><td>Bass, Tenor</td><td>No (Concert C)</td></tr>
        <tr><td>Tuba</td><td>Bass</td><td>No (Concert C in ABRSM)</td></tr></table>
      </div>`
    },
    {
      title: "Transposing Instruments",
      content: `<div class='lesson-section'>
        <h3>Transposing â€” The Key Concept</h3>
        <p>A transposing instrument's <strong>written pitch â‰  sounding (concert) pitch</strong>.</p>
        <div class='key-point'>Clarinet in Bâ™­: sounds a Major 2nd LOWER than written.<br>To find CONCERT pitch from written: go DOWN a major 2nd.<br>To find WRITTEN pitch from concert: go UP a major 2nd.</div>
        <div class='key-point'>Horn in F: sounds a Perfect 5th LOWER than written.<br>To find concert: go DOWN a P5th.<br>To find written: go UP a P5th.</div>
        <div class='warning-point'>Double bass and tenor voice sound ONE OCTAVE LOWER than written â€” they are called "octave transposing".</div>
        <table><tr><th>Instrument</th><th>Transposition (writtenâ†’sounding)</th></tr>
        <tr><td>Clarinet in Bâ™­</td><td>M2nd lower</td></tr>
        <tr><td>Clarinet in A</td><td>m3rd lower</td></tr>
        <tr><td>Horn in F</td><td>P5th lower</td></tr>
        <tr><td>Trumpet in Bâ™­</td><td>M2nd lower</td></tr>
        <tr><td>Double bass</td><td>Octave lower</td></tr>
        <tr><td>Piccolo</td><td>Octave higher</td></tr></table>
      </div>`
    }
  ],
  minors: [
    {
      title: "Three Forms of Minor Scale",
      content: `<div class='lesson-section'>
        <h3>ğŸŒ‘ Natural Minor</h3>
        <p>Same notes as the relative major â€” no alterations. Also called the <strong>Aeolian mode</strong>.</p>
        <p>A natural minor: Aâ€“Bâ€“Câ€“Dâ€“Eâ€“Fâ€“Gâ€“A</p>
        <p>Pattern: Tâ€“Sâ€“Tâ€“Tâ€“Sâ€“Tâ€“T</p>
      </div>
      <div class='lesson-section'>
        <h3>Harmonic Minor</h3>
        <p>Raise the <strong>7th degree</strong> by one semitone (ascending AND descending). This creates a leading note and makes chord V major.</p>
        <p>A harmonic minor: Aâ€“Bâ€“Câ€“Dâ€“Eâ€“Fâ€“<strong>Gâ™¯</strong>â€“A</p>
        <div class='warning-point'>The raised 7th creates an augmented 2nd (3 semitones) between degrees 6 and 7 â€” that characteristic "exotic" sound.</div>
      </div>
      <div class='lesson-section'>
        <h3>Melodic Minor</h3>
        <p>Ascending: raise <strong>both</strong> the 6th AND 7th degrees. Descending: revert to NATURAL minor.</p>
        <p>A melodic minor ascending: Aâ€“Bâ€“Câ€“Dâ€“Eâ€“<strong>Fâ™¯â€“Gâ™¯</strong>â€“A</p>
        <p>A melodic minor descending: Aâ€“Gâ€“Fâ€“Eâ€“Dâ€“Câ€“Bâ€“A (= A natural minor descending)</p>
        <div class='key-point'>Melodic minor avoids the awkward augmented 2nd of harmonic minor when writing singable melodies. Ascending raises 6+7; descending uses the natural form.</div>
      </div>`
    },
    {
      title: "Relative & Parallel Minors",
      content: `<div class='lesson-section'>
        <h3>Finding Relative Minor</h3>
        <p>Relative minor = same key signature as major, tonic is on the <strong>6th degree</strong> (or 3 semitones below the major tonic).</p>
        <table><tr><th>Major</th><th>Relative Minor</th><th>Key Sig</th></tr>
        <tr><td>C</td><td>A</td><td>0</td></tr>
        <tr><td>G</td><td>E</td><td>1â™¯</td></tr>
        <tr><td>D</td><td>B</td><td>2â™¯</td></tr>
        <tr><td>A</td><td>Fâ™¯</td><td>3â™¯</td></tr>
        <tr><td>E</td><td>Câ™¯</td><td>4â™¯</td></tr>
        <tr><td>F</td><td>D</td><td>1â™­</td></tr>
        <tr><td>Bâ™­</td><td>G</td><td>2â™­</td></tr>
        <tr><td>Eâ™­</td><td>C</td><td>3â™­</td></tr>
        <tr><td>Aâ™­</td><td>F</td><td>4â™­</td></tr>
        <tr><td>Dâ™­</td><td>Bâ™­</td><td>5â™­</td></tr></table>
      </div>`
    }
  ]
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  STATE MANAGEMENT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const SAVE_KEY = 'maestro_grade5_v4';
let STATE = {
  xp: 0, level: 1, bestStreak: 0,
  totalCorrect: 0, totalAnswered: 0,
  topicScores: {}, // {topicId: {correct, total, mastery(0-4)}}
  diagDone: false, diagResults: null,
  achievements: [],
};

function saveState() {
  try { localStorage.setItem(SAVE_KEY, JSON.stringify(STATE)); } catch(e) {}
}
function loadState() {
  try {
    const s = localStorage.getItem(SAVE_KEY);
    if (s) STATE = { ...STATE, ...JSON.parse(s) };
  } catch(e) {}
}

const LEVELS = [
  { name:'Novice', minXP:0, maxXP:100 },
  { name:'Apprentice', minXP:100, maxXP:300 },
  { name:'Scholar', minXP:300, maxXP:700 },
  { name:'Musician', minXP:700, maxXP:1200 },
  { name:'Theorist', minXP:1200, maxXP:2000 },
  { name:'Maestro', minXP:2000, maxXP:9999 },
];
function getLevelInfo() {
  let l = LEVELS.find((lv,i) => STATE.xp < lv.maxXP) || LEVELS[LEVELS.length-1];
  let idx = LEVELS.indexOf(l);
  if (STATE.xp >= l.maxXP) { l = LEVELS[LEVELS.length-1]; idx = LEVELS.length-1; }
  const pct = ((STATE.xp - l.minXP) / (l.maxXP - l.minXP)) * 100;
  return { name: l.name, idx, pct: Math.min(pct, 100) };
}
function addXP(amt) {
  const before = getLevelInfo().idx;
  STATE.xp += amt;
  const after = getLevelInfo().idx;
  if (after > before) showAchievement(`Level Up!`, `You're now a ${getLevelInfo().name}! ğŸ“`, 'ğŸ‰');
  saveState(); updateHeader();
}

function updateHeader() {
  const li = getLevelInfo();
  document.getElementById('hdr-level').textContent = `${li.name}`;
  document.getElementById('hdr-xpbar').style.width = `${li.pct}%`;
  document.getElementById('hdr-xp').textContent = `${STATE.xp} XP`;
  document.getElementById('hdr-streak').textContent = STATE.bestStreak;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  DASHBOARD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderDashboard() {
  // Stats
  document.getElementById('stat-xp').textContent = STATE.xp;
  document.getElementById('stat-streak').textContent = `${STATE.bestStreak} ğŸ”¥`;
  const acc = STATE.totalAnswered > 0
    ? Math.round((STATE.totalCorrect/STATE.totalAnswered)*100) : 0;
  document.getElementById('stat-correct').textContent = `${acc}%`;

  const mastered = TOPICS.filter(t => (STATE.topicScores[t.id]?.mastery||0) >= 3).length;
  document.getElementById('stat-topics').textContent = `${mastered}/8`;

  // Topic grid
  const grid = document.getElementById('topic-grid');
  grid.innerHTML = '';
  TOPICS.forEach(t => {
    const ts = STATE.topicScores[t.id] || {correct:0,total:0,mastery:0};
    const pct = ts.total > 0 ? Math.round(ts.correct/ts.total*100) : 0;
    const stars = 'â˜…'.repeat(ts.mastery||0) + 'â˜†'.repeat(4-(ts.mastery||0));
    const card = document.createElement('div');
    card.className = 'topic-card';
    card.style.setProperty('--accent', t.color);
    card.innerHTML = `
      <div class="topic-icon">${t.icon}</div>
      <div class="topic-name">${t.name}</div>
      <div class="topic-sub">${t.sub}</div>
      <div class="topic-stars">${stars}</div>
      <div class="topic-prog-bar"><div class="topic-prog-fill" style="width:${pct}%"></div></div>
      <div style="display:flex;justify-content:space-between;margin-top:8px;font-size:0.8rem;color:var(--muted)">
        <span>${ts.total > 0 ? pct+'% acc' : 'Not started'}</span>
        <span>${ts.total} Qs</span>
      </div>
    `;
    card.addEventListener('click', () => openTopic(t.id));
    grid.appendChild(card);
  });

  // Priority areas
  const priority = document.getElementById('priority-areas');
  if (!STATE.diagDone) {
    priority.innerHTML = `<div style="padding:16px;color:var(--muted);font-style:italic">Complete the Diagnostic Test to see your weak areas here. <button class="btn btn-primary btn-sm" onclick="startDiagnostic()" style="margin-left:12px">Start Now</button></div>`;
  } else {
    const sorted = TOPICS.slice().sort((a,b) => {
      const sa = STATE.topicScores[a.id]?.mastery||0;
      const sb = STATE.topicScores[b.id]?.mastery||0;
      return sa - sb;
    });
    priority.innerHTML = sorted.slice(0,3).map(t => {
      const ts = STATE.topicScores[t.id] || {mastery:0,correct:0,total:0};
      const chip = ts.mastery <= 1 ? 'chip-red' : ts.mastery <= 2 ? 'chip-yellow' : 'chip-green';
      const label = ts.mastery <= 1 ? 'Needs Work' : ts.mastery <= 2 ? 'Improving' : 'Good';
      return `<div style="display:flex;align-items:center;gap:12px;padding:12px;border-bottom:1px solid var(--border)">
        <span style="font-size:1.5rem">${t.icon}</span>
        <div style="flex:1"><div style="font-family:'Playfair Display';font-weight:700">${t.name}</div><div style="color:var(--muted);font-size:0.85rem">${t.sub}</div></div>
        <span class="chip ${chip}">${label}</span>
        <button class="btn btn-secondary btn-sm" onclick="openTopic('${t.id}')">Study â†’</button>
      </div>`;
    }).join('');
  }
}

function openTopic(topicId) {
  const t = TOPICS.find(x => x.id === topicId);
  const lessons = LESSONS[topicId] || [];
  currentTopicId = topicId;
  currentLessonIdx = 0;

  document.getElementById('lesson-icon').textContent = t.icon;
  document.getElementById('lesson-title').textContent = t.name;
  document.getElementById('lesson-subtitle').textContent = t.sub;

  const nav = document.getElementById('lesson-nav');
  nav.innerHTML = lessons.map((l,i) =>
    `<button class="lesson-nav-btn ${i===0?'active':''}" onclick="showLesson(${i})">${l.title}</button>`
  ).join('');

  showLesson(0);
  goScreen('screen-lesson');
}

let currentTopicId = null;
let currentLessonIdx = 0;

function showLesson(idx) {
  const lessons = LESSONS[currentTopicId] || [];
  currentLessonIdx = idx;
  document.querySelectorAll('.lesson-nav-btn').forEach((b,i) => {
    b.classList.toggle('active', i === idx);
  });
  document.getElementById('lesson-content').innerHTML = lessons[idx]?.content || '<p>Content coming soon.</p>';
}

function startTopicPractice() {
  const qs = QB[currentTopicId] || [];
  const shuffled = shuffleArr([...qs]).slice(0, Math.min(10, qs.length));
  beginQuiz(shuffled, `${TOPICS.find(t=>t.id===currentTopicId)?.name} Practice`, currentTopicId);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  DIAGNOSTIC
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function startDiagnostic() {
  goScreen('screen-diag-intro');
  setActiveNav('nav-diag');
}

function beginDiagnostic() {
  // 3 questions per topic
  let diagQs = [];
  TOPICS.forEach(t => {
    const pool = QB[t.id] || [];
    const picked = shuffleArr([...pool]).slice(0, 3);
    picked.forEach(q => diagQs.push({ ...q, topicId: t.id, topicName: t.name }));
  });
  diagQs = shuffleArr(diagQs);
  beginQuiz(diagQs, 'Diagnostic Assessment', 'diagnostic');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  QUIZ ENGINE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let quizState = {
  questions: [], current: 0, correct: 0, mode: '',
  topicId: '', answers: [], streak: 0,
  topicCorrect: {}, topicTotal: {}
};

function beginQuiz(qs, title, mode) {
  quizState = {
    questions: qs, current: 0, correct: 0, mode,
    topicId: mode !== 'diagnostic' ? mode : '',
    answers: [], streak: 0,
    topicCorrect: {}, topicTotal: {}
  };
  goScreen('screen-quiz');
  renderQuestion();
}

function renderQuestion() {
  const q = quizState.questions[quizState.current];
  const total = quizState.questions.length;
  const idx = quizState.current;

  document.getElementById('quiz-q-num').textContent = `Q ${idx+1}/${total}`;
  document.getElementById('quiz-progress-fill').style.width = `${(idx/total)*100}%`;

  const topicObj = TOPICS.find(t => t.id === (q.topicId || quizState.topicId));
  document.getElementById('q-topic-badge').textContent = topicObj?.name || 'Theory';
  document.getElementById('q-topic-badge').style.background = `${topicObj?.color||'#e6b84a'}20`;
  document.getElementById('q-topic-badge').style.borderColor = `${topicObj?.color||'#e6b84a'}50`;
  document.getElementById('q-topic-badge').style.color = topicObj?.color || '#e6b84a';

  document.getElementById('q-text').textContent = q.q;
  document.getElementById('q-hint').textContent = q.hint || '';

  // Options
  const optGrid = document.getElementById('q-options');
  optGrid.innerHTML = '';
  const letters = ['A','B','C','D'];
  q.opts.forEach((opt, i) => {
    const btn = document.createElement('button');
    btn.className = 'option-btn';
    btn.innerHTML = `<span class="option-letter">${letters[i]}</span><span>${opt}</span>`;
    btn.addEventListener('click', () => selectAnswer(i, q));
    optGrid.appendChild(btn);
  });

  document.getElementById('q-feedback').style.display = 'none';
  document.getElementById('quiz-next-btn').style.display = 'none';
}

function selectAnswer(chosen, q) {
  const optBtns = document.querySelectorAll('.option-btn');
  optBtns.forEach(b => b.disabled = true);

  const isCorrect = chosen === q.ans;
  const tid = q.topicId || quizState.topicId;

  optBtns.forEach((b, i) => {
    if (i === q.ans) b.classList.add('correct');
    else if (i === chosen && !isCorrect) b.classList.add('wrong');
    else if (i !== q.ans) b.style.opacity = '0.5';
  });

  // Update stats
  if (!quizState.topicCorrect[tid]) { quizState.topicCorrect[tid] = 0; quizState.topicTotal[tid] = 0; }
  quizState.topicTotal[tid]++;
  STATE.totalAnswered++;

  if (isCorrect) {
    quizState.correct++;
    quizState.streak++;
    quizState.topicCorrect[tid]++;
    STATE.totalCorrect++;
    if (quizState.streak > STATE.bestStreak) STATE.bestStreak = quizState.streak;
    addXP(10 + (quizState.streak > 2 ? 5 : 0));
    showXPPop(isCorrect ? '+10 XP âœ“' : '');
    checkStreakAchievement(quizState.streak);
  } else {
    quizState.streak = 0;
  }

  quizState.answers.push({ correct: isCorrect, topicId: tid });

  // Feedback
  const fb = document.getElementById('q-feedback');
  fb.className = `feedback-banner ${isCorrect ? 'correct' : 'wrong'}`;
  fb.style.display = 'block';
  document.getElementById('fb-title').textContent = isCorrect ? 'âœ“ Correct!' : 'âœ— Not quite...';
  document.getElementById('fb-body').textContent = q.exp || '';

  document.getElementById('quiz-next-btn').style.display = 'inline-flex';
  saveState();
}

function nextQuestion() {
  quizState.current++;
  if (quizState.current >= quizState.questions.length) {
    finishQuiz();
  } else {
    renderQuestion();
  }
}

function finishQuiz() {
  // Update topic scores
  TOPICS.forEach(t => {
    const c = quizState.topicCorrect[t.id] || 0;
    const total = quizState.topicTotal[t.id] || 0;
    if (total > 0) {
      if (!STATE.topicScores[t.id]) STATE.topicScores[t.id] = {correct:0,total:0,mastery:0};
      STATE.topicScores[t.id].correct += c;
      STATE.topicScores[t.id].total += total;
      // Mastery: 0-4 based on running accuracy
      const ts = STATE.topicScores[t.id];
      const acc = ts.correct / ts.total;
      ts.mastery = acc >= 0.9 ? 4 : acc >= 0.75 ? 3 : acc >= 0.5 ? 2 : acc >= 0.25 ? 1 : 0;
    }
  });

  if (quizState.mode === 'diagnostic') STATE.diagDone = true;
  saveState();
  showResults();
}

function showResults() {
  const total = quizState.questions.length;
  const correct = quizState.correct;
  const pct = Math.round(correct/total*100);

  document.getElementById('results-score').textContent = `${correct}/${total}`;
  document.getElementById('results-emoji').textContent = pct >= 80 ? 'ğŸ†' : pct >= 60 ? 'ğŸµ' : pct >= 40 ? 'ğŸ“' : 'ğŸ’ª';
  document.getElementById('results-label').textContent =
    pct >= 80 ? 'Outstanding! You\'re ready!' :
    pct >= 60 ? 'Good work â€” nearly there!' :
    pct >= 40 ? 'Solid start â€” keep reviewing!' :
    'Let\'s focus those weak spots!';

  const rank = pct >= 80 ? 'ğŸ¥‡ Distinction Territory' : pct >= 65 ? 'ğŸ¥ˆ Merit Territory' : 'ğŸ¥‰ Pass Territory';
  document.getElementById('results-rank-badge').innerHTML = `<div class="level-badge">${rank}</div>`;

  // Breakdown by topic
  const breakdown = document.getElementById('results-breakdown');
  let html = `<div style="font-family:'Playfair Display';font-weight:700;margin-bottom:12px;color:var(--gold2)">Topic Breakdown</div>`;
  const topics = [...new Set(quizState.answers.map(a => a.topicId))];
  topics.forEach(tid => {
    const t = TOPICS.find(x => x.id === tid);
    if (!t) return;
    const tAnw = quizState.answers.filter(a => a.topicId === tid);
    const tc = tAnw.filter(a => a.correct).length;
    const tt = tAnw.length;
    const tpct = Math.round(tc/tt*100);
    const scoreClass = tpct >= 80 ? 'score-high' : tpct >= 50 ? 'score-mid' : 'score-low';
    html += `<div class="breakdown-row">
      <div class="breakdown-topic"><span>${t.icon}</span><span>${t.name}</span></div>
      <div class="breakdown-score-badge ${scoreClass}">${tc}/${tt} (${tpct}%)</div>
    </div>`;
  });
  breakdown.innerHTML = html;

  const advice = pct >= 80 ? 'Focus on any remaining red areas and review the Quick Reference tonight.' :
    pct >= 60 ? 'Study the topics marked in red and orange. Run a topic practice session on each.' :
    'Start with the lesson for each weak topic, then do a focused practice session.';
  document.getElementById('results-advice').textContent = advice;

  goScreen('screen-results');
}

function practiceWeak() {
  // Find worst topics
  const worst = TOPICS.slice().sort((a,b) => {
    const sa = STATE.topicScores[a.id]?.mastery || 0;
    const sb = STATE.topicScores[b.id]?.mastery || 0;
    return sa - sb;
  }).slice(0,3);
  let qs = [];
  worst.forEach(t => {
    const pool = QB[t.id] || [];
    const picked = shuffleArr([...pool]).slice(0, 4);
    picked.forEach(q => qs.push({...q, topicId:t.id}));
  });
  beginQuiz(shuffleArr(qs), 'Targeted Practice', 'mixed');
}

function exitQuiz() {
  if (quizState.current > 0) {
    finishQuiz();
  } else {
    goScreen('screen-dashboard');
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  UTILS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function goScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  window.scrollTo(0,0);
  if (id === 'screen-dashboard') { renderDashboard(); setActiveNav('nav-dash'); }
  if (id === 'screen-reference') setActiveNav('nav-ref');
}

function setActiveNav(id) {
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById(id)?.classList.add('active');
}

function shuffleArr(arr) {
  for (let i = arr.length-1; i > 0; i--) {
    const j = Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]] = [arr[j],arr[i]];
  }
  return arr;
}

function showXPPop(text) {
  const el = document.createElement('div');
  el.className = 'xp-pop';
  el.textContent = text;
  el.style.left = `${Math.random()*200+100}px`;
  el.style.top = `${window.scrollY + 200}px`;
  document.body.appendChild(el);
  setTimeout(() => el.remove(), 1300);
}

function showAchievement(title, desc, icon='ğŸ†') {
  const t = document.getElementById('ach-toast');
  document.getElementById('ach-icon').textContent = icon;
  document.getElementById('ach-title').textContent = title;
  document.getElementById('ach-desc').textContent = desc;
  t.style.display = 'block';
  setTimeout(() => t.style.display = 'none', 3500);
  spawnConfetti();
}

function checkStreakAchievement(streak) {
  const milestones = {5: ['Hot Streak!', '5 in a row! ğŸ”¥', 'ğŸ”¥'], 10: ['On Fire!', '10 correct in a row! You\'re unstoppable!', 'ğŸ”¥'], 15: ['Unstoppable!', '15 streak! Maestro level!', 'âš¡']};
  if (milestones[streak]) {
    const [t, d, i] = milestones[streak];
    showAchievement(t, d, i);
  }
}

function spawnConfetti() {
  const colors = ['#e6b84a','#56d364','#79c0ff','#ff7fc6','#ffa657','#bc8cff'];
  for (let i = 0; i < 30; i++) {
    const el = document.createElement('div');
    el.className = 'confetti-particle';
    el.style.left = `${Math.random()*100}vw`;
    el.style.background = colors[Math.floor(Math.random()*colors.length)];
    el.style.setProperty('--dur', `${0.8 + Math.random()*1.4}s`);
    el.style.animationDelay = `${Math.random()*0.5}s`;
    document.body.appendChild(el);
    setTimeout(() => el.remove(), 2500);
  }
}

function confirmReset() {
  document.getElementById('modal-title').textContent = 'Reset All Progress?';
  document.getElementById('modal-body').textContent = 'This will erase all XP, scores, and achievement data. This cannot be undone.';
  document.getElementById('modal-confirm').onclick = () => {
    STATE = { xp:0,level:1,bestStreak:0,totalCorrect:0,totalAnswered:0,topicScores:{},diagDone:false,diagResults:null,achievements:[] };
    saveState(); closeModal(); renderDashboard(); updateHeader();
  };
  document.getElementById('modal').classList.add('open');
}

function closeModal() {
  document.getElementById('modal').classList.remove('open');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
loadState();
updateHeader();
renderDashboard();

// Welcome message
window.addEventListener('load', () => {
  if (STATE.xp > 0) {
    const li = getLevelInfo();
    document.getElementById('dash-greeting').textContent = `Welcome back, ${li.name}!`;
    document.getElementById('dash-sub').textContent = `Your exam is almost here. ${STATE.diagDone ? 'Keep working on your weak topics.' : 'Start with the Diagnostic to know where to focus.'}`;
  }
});
</script>
</body>
</html>
